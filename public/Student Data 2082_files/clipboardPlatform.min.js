var clipboardPlatform;!function(){var e={8805:function(e){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,r){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,r)}function r(e,a,i){return r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,r,a){var i=[null];i.push.apply(i,r);var o=new(Function.bind.apply(e,i));return a&&t(o,a.prototype),o},r.apply(null,arguments)}function a(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var o=Object.hasOwnProperty,n=Object.setPrototypeOf,s=Object.isFrozen,l=Object.getPrototypeOf,c=Object.getOwnPropertyDescriptor,d=Object.freeze,p=Object.seal,m=Object.create,u="undefined"!=typeof Reflect&&Reflect,g=u.apply,h=u.construct;g||(g=function(e,t,r){return e.apply(t,r)}),d||(d=function(e){return e}),p||(p=function(e){return e}),h||(h=function(e,t){return r(e,a(t))});var f,S=P(Array.prototype.forEach),b=P(Array.prototype.pop),y=P(Array.prototype.push),C=P(String.prototype.toLowerCase),E=P(String.prototype.toString),w=P(String.prototype.match),_=P(String.prototype.replace),v=P(String.prototype.indexOf),T=P(String.prototype.trim),I=P(RegExp.prototype.test),A=(f=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return h(f,t)});function P(e){return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return g(e,t,a)}}function L(e,t,r){var a;r=null!==(a=r)&&void 0!==a?a:C,n&&n(e,null);for(var i=t.length;i--;){var o=t[i];if("string"==typeof o){var l=r(o);l!==o&&(s(t)||(t[i]=l),o=l)}e[o]=!0}return e}function x(e){var t,r=m(null);for(t in e)!0===g(o,e,[t])&&(r[t]=e[t]);return r}function D(e,t){for(;null!==e;){var r=c(e,t);if(r){if(r.get)return P(r.get);if("function"==typeof r.value)return P(r.value)}e=l(e)}return function(e){return console.warn("fallback value for",e),null}}var M=d(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),k=d(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$=d(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),W=d(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),R=d(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),O=d(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),U=d(["#text"]),F=d(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),N=d(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),j=d(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),J=d(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),z=p(/\{\{[\w\W]*|[\w\W]*\}\}/gm),H=p(/<%[\w\W]*|[\w\W]*%>/gm),V=p(/\${[\w\W]*}/gm),B=p(/^data-[\-\w.\u00B7-\uFFFF]/),G=p(/^aria-[\-\w]+$/),K=p(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Z=p(/^(?:\w+script|data):/i),q=p(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Y=p(/^html$/i),X=p(/^[a-z][.\w]*(-[.\w]+)+$/i);return function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,i=function(e){return t(e)};if(i.version="2.5.7",i.removed=[],!r||!r.document||9!==r.document.nodeType)return i.isSupported=!1,i;var o=r.document,n=r.document,s=r.DocumentFragment,l=r.HTMLTemplateElement,c=r.Node,p=r.Element,m=r.NodeFilter,u=r.NamedNodeMap,g=void 0===u?r.NamedNodeMap||r.MozNamedAttrMap:u,h=r.HTMLFormElement,f=r.DOMParser,P=r.trustedTypes,Q=p.prototype,ee=D(Q,"cloneNode"),te=D(Q,"nextSibling"),re=D(Q,"childNodes"),ae=D(Q,"parentNode");if("function"==typeof l){var ie=n.createElement("template");ie.content&&ie.content.ownerDocument&&(n=ie.content.ownerDocument)}var oe=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var a=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(a=r.currentScript.getAttribute(i));var o="dompurify"+(a?"#"+a:"");try{return t.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}}(P,o),ne=oe?oe.createHTML(""):"",se=n,le=se.implementation,ce=se.createNodeIterator,de=se.createDocumentFragment,pe=se.getElementsByTagName,me=o.importNode,ue={};try{ue=x(n).documentMode?n.documentMode:{}}catch(e){}var ge={};i.isSupported="function"==typeof ae&&le&&void 0!==le.createHTMLDocument&&9!==ue;var he,fe,Se=z,be=H,ye=V,Ce=B,Ee=G,we=Z,_e=q,ve=X,Te=K,Ie=null,Ae=L({},[].concat(a(M),a(k),a($),a(R),a(U))),Pe=null,Le=L({},[].concat(a(F),a(N),a(j),a(J))),xe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),De=null,Me=null,ke=!0,$e=!0,We=!1,Re=!0,Oe=!1,Ue=!0,Fe=!1,Ne=!1,je=!1,Je=!1,ze=!1,He=!1,Ve=!0,Be=!1,Ge=!0,Ke=!1,Ze={},qe=null,Ye=L({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Xe=null,Qe=L({},["audio","video","img","source","image","track"]),et=null,tt=L({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),rt="http://www.w3.org/1998/Math/MathML",at="http://www.w3.org/2000/svg",it="http://www.w3.org/1999/xhtml",ot=it,nt=!1,st=null,lt=L({},[rt,at,it],E),ct=["application/xhtml+xml","text/html"],dt=null,pt=n.createElement("form"),mt=function(e){return e instanceof RegExp||e instanceof Function},ut=function(t){dt&&dt===t||(t&&"object"===e(t)||(t={}),t=x(t),he=he=-1===ct.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,fe="application/xhtml+xml"===he?E:C,Ie="ALLOWED_TAGS"in t?L({},t.ALLOWED_TAGS,fe):Ae,Pe="ALLOWED_ATTR"in t?L({},t.ALLOWED_ATTR,fe):Le,st="ALLOWED_NAMESPACES"in t?L({},t.ALLOWED_NAMESPACES,E):lt,et="ADD_URI_SAFE_ATTR"in t?L(x(tt),t.ADD_URI_SAFE_ATTR,fe):tt,Xe="ADD_DATA_URI_TAGS"in t?L(x(Qe),t.ADD_DATA_URI_TAGS,fe):Qe,qe="FORBID_CONTENTS"in t?L({},t.FORBID_CONTENTS,fe):Ye,De="FORBID_TAGS"in t?L({},t.FORBID_TAGS,fe):{},Me="FORBID_ATTR"in t?L({},t.FORBID_ATTR,fe):{},Ze="USE_PROFILES"in t&&t.USE_PROFILES,ke=!1!==t.ALLOW_ARIA_ATTR,$e=!1!==t.ALLOW_DATA_ATTR,We=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Re=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Oe=t.SAFE_FOR_TEMPLATES||!1,Ue=!1!==t.SAFE_FOR_XML,Fe=t.WHOLE_DOCUMENT||!1,Je=t.RETURN_DOM||!1,ze=t.RETURN_DOM_FRAGMENT||!1,He=t.RETURN_TRUSTED_TYPE||!1,je=t.FORCE_BODY||!1,Ve=!1!==t.SANITIZE_DOM,Be=t.SANITIZE_NAMED_PROPS||!1,Ge=!1!==t.KEEP_CONTENT,Ke=t.IN_PLACE||!1,Te=t.ALLOWED_URI_REGEXP||Te,ot=t.NAMESPACE||it,xe=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&mt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(xe.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&mt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(xe.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(xe.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Oe&&($e=!1),ze&&(Je=!0),Ze&&(Ie=L({},a(U)),Pe=[],!0===Ze.html&&(L(Ie,M),L(Pe,F)),!0===Ze.svg&&(L(Ie,k),L(Pe,N),L(Pe,J)),!0===Ze.svgFilters&&(L(Ie,$),L(Pe,N),L(Pe,J)),!0===Ze.mathMl&&(L(Ie,R),L(Pe,j),L(Pe,J))),t.ADD_TAGS&&(Ie===Ae&&(Ie=x(Ie)),L(Ie,t.ADD_TAGS,fe)),t.ADD_ATTR&&(Pe===Le&&(Pe=x(Pe)),L(Pe,t.ADD_ATTR,fe)),t.ADD_URI_SAFE_ATTR&&L(et,t.ADD_URI_SAFE_ATTR,fe),t.FORBID_CONTENTS&&(qe===Ye&&(qe=x(qe)),L(qe,t.FORBID_CONTENTS,fe)),Ge&&(Ie["#text"]=!0),Fe&&L(Ie,["html","head","body"]),Ie.table&&(L(Ie,["tbody"]),delete De.tbody),d&&d(t),dt=t)},gt=L({},["mi","mo","mn","ms","mtext"]),ht=L({},["annotation-xml"]),ft=L({},["title","style","font","a","script"]),St=L({},k);L(St,$),L(St,W);var bt=L({},R);L(bt,O);var yt=function(e){y(i.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ne}catch(t){e.remove()}}},Ct=function(e,t){try{y(i.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){y(i.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Pe[e])if(Je||ze)try{yt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Et=function(e){var t,r;if(je)e="<remove></remove>"+e;else{var a=w(e,/^[\r\n\t ]+/);r=a&&a[0]}"application/xhtml+xml"===he&&ot===it&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=oe?oe.createHTML(e):e;if(ot===it)try{t=(new f).parseFromString(i,he)}catch(e){}if(!t||!t.documentElement){t=le.createDocument(ot,"template",null);try{t.documentElement.innerHTML=nt?ne:i}catch(e){}}var o=t.body||t.documentElement;return e&&r&&o.insertBefore(n.createTextNode(r),o.childNodes[0]||null),ot===it?pe.call(t,Fe?"html":"body")[0]:Fe?t.documentElement:o},wt=function(e){return ce.call(e.ownerDocument||e,e,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null,!1)},_t=function(e){return e instanceof h&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof g)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},vt=function(t){return"object"===e(c)?t instanceof c:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Tt=function(e,t,r){ge[e]&&S(ge[e],(function(e){e.call(i,t,r,dt)}))},It=function(e){var t;if(Tt("beforeSanitizeElements",e,null),_t(e))return yt(e),!0;if(I(/[\u0080-\uFFFF]/,e.nodeName))return yt(e),!0;var r=fe(e.nodeName);if(Tt("uponSanitizeElement",e,{tagName:r,allowedTags:Ie}),e.hasChildNodes()&&!vt(e.firstElementChild)&&(!vt(e.content)||!vt(e.content.firstElementChild))&&I(/<[/\w]/g,e.innerHTML)&&I(/<[/\w]/g,e.textContent))return yt(e),!0;if("select"===r&&I(/<template/i,e.innerHTML))return yt(e),!0;if(7===e.nodeType)return yt(e),!0;if(Ue&&8===e.nodeType&&I(/<[/\w]/g,e.data))return yt(e),!0;if(!Ie[r]||De[r]){if(!De[r]&&Pt(r)){if(xe.tagNameCheck instanceof RegExp&&I(xe.tagNameCheck,r))return!1;if(xe.tagNameCheck instanceof Function&&xe.tagNameCheck(r))return!1}if(Ge&&!qe[r]){var a=ae(e)||e.parentNode,o=re(e)||e.childNodes;if(o&&a)for(var n=o.length-1;n>=0;--n){var s=ee(o[n],!0);s.__removalCount=(e.__removalCount||0)+1,a.insertBefore(s,te(e))}}return yt(e),!0}return e instanceof p&&!function(e){var t=ae(e);t&&t.tagName||(t={namespaceURI:ot,tagName:"template"});var r=C(e.tagName),a=C(t.tagName);return!!st[e.namespaceURI]&&(e.namespaceURI===at?t.namespaceURI===it?"svg"===r:t.namespaceURI===rt?"svg"===r&&("annotation-xml"===a||gt[a]):Boolean(St[r]):e.namespaceURI===rt?t.namespaceURI===it?"math"===r:t.namespaceURI===at?"math"===r&&ht[a]:Boolean(bt[r]):e.namespaceURI===it?!(t.namespaceURI===at&&!ht[a])&&!(t.namespaceURI===rt&&!gt[a])&&!bt[r]&&(ft[r]||!St[r]):!("application/xhtml+xml"!==he||!st[e.namespaceURI]))}(e)?(yt(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!I(/<\/no(script|embed|frames)/i,e.innerHTML)?(Oe&&3===e.nodeType&&(t=e.textContent,t=_(t,Se," "),t=_(t,be," "),t=_(t,ye," "),e.textContent!==t&&(y(i.removed,{element:e.cloneNode()}),e.textContent=t)),Tt("afterSanitizeElements",e,null),!1):(yt(e),!0)},At=function(e,t,r){if(Ve&&("id"===t||"name"===t)&&(r in n||r in pt))return!1;if($e&&!Me[t]&&I(Ce,t));else if(ke&&I(Ee,t));else if(!Pe[t]||Me[t]){if(!(Pt(e)&&(xe.tagNameCheck instanceof RegExp&&I(xe.tagNameCheck,e)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(e))&&(xe.attributeNameCheck instanceof RegExp&&I(xe.attributeNameCheck,t)||xe.attributeNameCheck instanceof Function&&xe.attributeNameCheck(t))||"is"===t&&xe.allowCustomizedBuiltInElements&&(xe.tagNameCheck instanceof RegExp&&I(xe.tagNameCheck,r)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(r))))return!1}else if(et[t]);else if(I(Te,_(r,_e,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==v(r,"data:")||!Xe[e])if(We&&!I(we,_(r,_e,"")));else if(r)return!1;return!0},Pt=function(e){return"annotation-xml"!==e&&w(e,ve)},Lt=function(t){var r,a,o,n;Tt("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Pe};for(n=s.length;n--;){var c=r=s[n],d=c.name,p=c.namespaceURI;if(a="value"===d?r.value:T(r.value),o=fe(d),l.attrName=o,l.attrValue=a,l.keepAttr=!0,l.forceKeepAttr=void 0,Tt("uponSanitizeAttribute",t,l),a=l.attrValue,!l.forceKeepAttr&&(Ct(d,t),l.keepAttr))if(Re||!I(/\/>/i,a)){Oe&&(a=_(a,Se," "),a=_(a,be," "),a=_(a,ye," "));var m=fe(t.nodeName);if(At(m,o,a))if(!Be||"id"!==o&&"name"!==o||(Ct(d,t),a="user-content-"+a),Ue&&I(/((--!?|])>)|<\/(style|title)/i,a))Ct(d,t);else{if(oe&&"object"===e(P)&&"function"==typeof P.getAttributeType)if(p);else switch(P.getAttributeType(m,o)){case"TrustedHTML":a=oe.createHTML(a);break;case"TrustedScriptURL":a=oe.createScriptURL(a)}try{p?t.setAttributeNS(p,d,a):t.setAttribute(d,a),_t(t)?yt(t):b(i.removed)}catch(e){}}}else Ct(d,t)}Tt("afterSanitizeAttributes",t,null)}},xt=function e(t){var r,a=wt(t);for(Tt("beforeSanitizeShadowDOM",t,null);r=a.nextNode();)Tt("uponSanitizeShadowNode",r,null),It(r)||(r.content instanceof s&&e(r.content),Lt(r));Tt("afterSanitizeShadowDOM",t,null)};return i.sanitize=function(t){var a,n,l,d,p,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((nt=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!vt(t)){if("function"!=typeof t.toString)throw A("toString is not a function");if("string"!=typeof(t=t.toString()))throw A("dirty is not a string, aborting")}if(!i.isSupported){if("object"===e(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(vt(t))return r.toStaticHTML(t.outerHTML)}return t}if(Ne||ut(m),i.removed=[],"string"==typeof t&&(Ke=!1),Ke){if(t.nodeName){var u=fe(t.nodeName);if(!Ie[u]||De[u])throw A("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof c)1===(n=(a=Et("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===n.nodeName||"HTML"===n.nodeName?a=n:a.appendChild(n);else{if(!Je&&!Oe&&!Fe&&-1===t.indexOf("<"))return oe&&He?oe.createHTML(t):t;if(!(a=Et(t)))return Je?null:He?ne:""}a&&je&&yt(a.firstChild);for(var g=wt(Ke?t:a);l=g.nextNode();)3===l.nodeType&&l===d||It(l)||(l.content instanceof s&&xt(l.content),Lt(l),d=l);if(d=null,Ke)return t;if(Je){if(ze)for(p=de.call(a.ownerDocument);a.firstChild;)p.appendChild(a.firstChild);else p=a;return(Pe.shadowroot||Pe.shadowrootmod)&&(p=me.call(o,p,!0)),p}var h=Fe?a.outerHTML:a.innerHTML;return Fe&&Ie["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&I(Y,a.ownerDocument.doctype.name)&&(h="<!DOCTYPE "+a.ownerDocument.doctype.name+">\n"+h),Oe&&(h=_(h,Se," "),h=_(h,be," "),h=_(h,ye," ")),oe&&He?oe.createHTML(h):h},i.setConfig=function(e){ut(e),Ne=!0},i.clearConfig=function(){dt=null,Ne=!1},i.isValidAttribute=function(e,t,r){dt||ut({});var a=fe(e),i=fe(t);return At(a,i,r)},i.addHook=function(e,t){"function"==typeof t&&(ge[e]=ge[e]||[],y(ge[e],t))},i.removeHook=function(e){if(ge[e])return b(ge[e])},i.removeHooks=function(e){ge[e]&&(ge[e]=[])},i.removeAllHooks=function(){ge={}},i}()}()},6971:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=function(){return void 0===r[a]&&(r[a]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[a]};const r={},a="promises"},4033:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push(`crypto: ${JSON.stringify(e)}`)}}let a=!1;const i="undefined"!=typeof performance?performance:void 0;try{i&&i.now&&i.now()!==1/0&&(a=!0)}catch(e){t.exceptions.push(`perfNow: ${JSON.stringify(e)}`)}for(let r=0;r<e.length;r+=1){try{if(a){t.perfNow=!0;let e=Math.floor(100*i.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push(`Math.random: ${JSON.stringify(e)}`)}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const a=15&e[r];return r+=1,("x"===t?a:3&a|8).toString(16)})),t]}},1819:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},8234:function(e,t,r){"use strict";t.TZ=t.nh=t.kp=t.Hv=t.Wp=t.kA=void 0;const a=r(8107);t.Wp=a;const i=r(8960);Object.defineProperty(t,"Hv",{enumerable:!0,get:function(){return i.ULS}}),Object.defineProperty(t,"kp",{enumerable:!0,get:function(){return i.TraceLevel}}),Object.defineProperty(t,"nh",{enumerable:!0,get:function(){return i.LogCategory}}),r(6971);const o=r(1180);t.TZ=o;r(765),r(4726);var n=r(4033);Object.defineProperty(t,"kA",{enumerable:!0,get:function(){return n.getNewGuid}});r(9792),r(1819)},8960:function(e,t){"use strict";var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(a||(t.LogCategory=a={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,a)=>t.traceTag(0,e,r,a),traceTag:(e,r,a,i)=>t.traceTag(e,r,a,i),debugTrace:(e,r,a)=>t.debugTraceTag(0,e,r,a),debugTraceTag:(e,r,a,i)=>t.debugTraceTag(e,r,a,i),assert:(e,r,a)=>t.assertTag(0,e,r,a),assertTag:(e,r,a,i)=>t.assertTag(e,r,a,i),shipAssert:(e,r,a)=>t.shipAssertTag(0,e,r,a),shipAssertTag:(e,r,a,i)=>t.shipAssertTag(e,r,a,i),dnmTrace:(e,r,a)=>t.dnmTraceTag(0,e,r,a),dnmTraceTag:(e,r,a,i)=>t.dnmTraceTag(e,r,a,i)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,a){console.assert(r,"shipAssertTag:",e,t,a)}assertTag(e,t,r,a){console.assert(r,"assertTag",e,t,a)}traceTag(e,t,r,a){console.log("traceTag",e,a,t,r)}dnmTraceTag(e,t,r,a){console.log("dnmTraceTag",e,a,t,r)}debugTraceTag(e,t,r,a){console.log("debugTraceTag",e,a,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},1180:function(e,t){"use strict";function r(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function a(e,t,a){e[t]=r()-a}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){const t=r(),i=e,o=t,n={},s=(e,t,r)=>function(e,t,r,i,o,n){a(e,"end",r);const s={sessionName:t,result:i?"success":"failure",message:n,marks:e};o(JSON.stringify(s))}(n,i,o,e,t,r);return n.start=0,{mark:e=>(e=>a(n,e,o))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},9792:function(e,t){"use strict";var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(a||(t.TextAreaInputMode=a={}))},765:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=()=>self.performance.now()),function(a){let i=r(),o=a;return{reset(e){null!=e&&(o=e),i=r()},stop(a){const n=r()-i,s=JSON.stringify({Target:o,Duration:n.toFixed(t),StopInfo:a});e(s)}}}};let r=()=>Date.now()},4726:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},8107:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultToJSONResultWhenStringifyFails=void 0,t.forEachPromise=function(e,t,r){return e.reduce(((e,a)=>e.then((()=>r&&r.stop?Promise.resolve(void 0):t(a,r)))),Promise.resolve(void 0))},t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(a(e))}catch{return t.defaultToJSONResultWhenStringifyFails}},t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(o,i).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===i&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===i&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error(`utils.retry: attempts expected to be greater than 0 but got ${t}`));let r=Promise.reject();for(let a=1;a<=t;a+=1)r=r.catch((t=>e(a,t)));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let a=1;a<e.length;a+=1){const i=e[a];r=r.catch((()=>t(i)))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const a=e.length;for(let i=0;i<a&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==a-1);i+=2)r=4294967295&((r<<5)+r^e.charCodeAt(i+1));let i=t+35685*r+(23896*r<<16)&4294967295;return i<0&&(i+=4294967296),i},t.defaultToJSONResultWhenStringifyFails="...";const r=5;function a(e,t=0){if(t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;const i={};Object.getOwnPropertyNames(e).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(i[t]=e[t])}));const o=Object.getPrototypeOf(e);o&&"object"==typeof o&&Object.keys(o).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(i[t]=e[t])}));const n={};return Object.keys(i).forEach((e=>{n[e]=a(i[e],t+1)})),n}const i="_",o=new RegExp("\\W+","g")},8621:function(e,t){"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},6662:function(e,t){"use strict";function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const a=r(e),i=r(t);let o=[];for(let e=0;e<=i.length;++e)o[e]=e;for(let e=1;e<=a.length;++e){const t=[e];for(let r=1;r<=i.length;++r)t[r]=a[e-1]===i[r-1]?o[r-1]:1+Math.min(o[r],o[r-1],t[r-1]);o=t}return o[i.length]}},6227:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=o,t.getStringFeatureGate=n,t.getBooleanFeatureGate=function(e,t){const r=n(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=n(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const a=parseFloat(r);return isNaN(a)?t:a},t.getIntFeatureGate=function(e,t){const r=n(e)?.trim();if(void 0===r)return t;const a=parseInt(r,10);return isNaN(a)?t:a},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const a=r(6662),i={};function o(){return void 0===globalThis.__get_feature_gate_dictionary_variable?i:globalThis.__get_feature_gate_dictionary_variable()}function n(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return o()[e]??t;const r=o();if(Object.hasOwn(r,e))return r[e]??t;const i=globalThis.__office_online_feature_gates_verbose_log_callback;i(`Failed lookup for FeatureGate ${e}...`);const n=[],s=e.toLowerCase();for(const e of Object.keys(r))(0,a.editDistance)(e.toLowerCase(),s)<=4&&n.push(e);return n.length>0&&i(`Potential candidates found (edit distance <= 4, case-insensitive): [${n.join(", ")}]`),i(`FeatureGate override not found, returning default: ${t}`),t}},4645:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(6533);a.__exportStar(r(6227),t),a.__exportStar(r(4342),t),a.__exportStar(r(8621),t),a.__exportStar(r(3915),t),a.__exportStar(r(3237),t),a.__exportStar(r(2027),t)},4342:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,a.getBooleanFeatureGate)(t,r);case"number":return(0,a.getNumberFeatureGate)(t,r);case"string":return(0,a.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const a=r(6227)},3915:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,a.isChangeGateEnabled)(e)};const a=r(8621)},3237:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)};const a=r(8621);function i(e){const t=(0,a.setChangeGateDictionaryGetter)(void 0);return(0,a.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},2027:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)};const a=r(6227);function i(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,a.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,a.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},8615:function(e,t,r){"use strict";t.domPurifyPolicyHtml=void 0;var a=r(5267);Object.defineProperty(t,"domPurifyPolicyHtml",{enumerable:!0,get:function(){return a.domPurifyPolicyHtml}});r(6401),r(9591),r(5653),r(3059),r(6052),r(3893)},561:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPolicy=void 0;const r={},a="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t};t.createPolicy=(e,t,i=a)=>{try{r[e]||(r[e]=i.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch{console.info(`Skipped duplicate policy creation: ${e}`)}return r[e]}},5653:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bypassPolicy=t.createBypassPolicy=void 0;const a=r(561);t.createBypassPolicy=(e,t)=>(0,a.createPolicy)(e,{createHTML:e=>e,createScript:e=>e},t),t.bypassPolicy=(0,t.createBypassPolicy)("bypassPolicy")},3059:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGraphicsEditorTrustedTypesDefaultPolicy=t.createTrustedTypesDefaultPolicy=t.createDefaultPolicyInternal=void 0;const a=r(4645),i=r(561),o=r(6052),n=r(9591);t.createDefaultPolicyInternal=e=>{(0,i.createPolicy)("default",{createHTML:(e,t,r)=>{try{if("Element innerHTML"===r&&ee($,f))return te.has(e)?e:(0,o.sanitizedHTMLAndValidate)(e);if("DOMParser parseFromString"===r&&ee(O,S)||"Element setAttribute"===r&&ee(K,w))return e}catch{}},createScript:(e,t,r)=>{try{if("eval"===r&&ee(F,y))return e;if("HTMLScriptElement text"===r&&ee(q,E)&&(e.startsWith("<math display")||e.startsWith("<math xmlns")))return e;if((0,a.isChangeGateEnabled)("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO:10684524_EnableFuncSinkDefaultTTPolicy")&&"Function"===r&&ee(void 0,_))return e}catch{}},createScriptURL:(e,t,r)=>{try{if("Worker constructor"===r&&ee(Y,b)||"HTMLScriptElement src"===r&&ee(G,C)){const{origin:t}=new URL(e,document.baseURI);if((0,n.isAnAllowedOrigin)(t))return e}}catch{}}},e)},t.createTrustedTypesDefaultPolicy=()=>(0,t.createDefaultPolicyInternal)(),t.createGraphicsEditorTrustedTypesDefaultPolicy=e=>{try{e.window.trustedTypes?.createPolicy("default",{createHTML:(e,t,r)=>{try{if("Element innerHTML"===r&&ee(P,f))return(0,o.sanitizedHTMLAndValidate)(e)}catch{}}})}catch{}};const s=/https?:\/\/[^\s/$.?#].[^\s]*/g,l=/\/officeonline\/versioned\/mathjax\-lowercase\-patched\/\d{1,10}\.\d{1,10}\.\d{1,10}\/mathjax\/\d{1,10}\.\d{1,10}\.\d{1,10}\/(config\/|jax\/output\/html\-css\/)?/,c=/\/(officeonline\/)?o\/s\/h?([0-9a-fA-F])+_app_scripts\/(wp5\/)?/,d=/\/(officeonline\/)?x\/s\/h?([0-9a-fA-F])+__layouts\/app_scripts\/((wp5|ac|es6)\/)?/,p=/\/1js\/(build|pr)\/[0-9a-fA-F]+/,m=/\/wd1js\/(ship|debug)\/(we|wv|x)\/(_layouts\/)?app_scripts\/((wp5|ac|es6)\/)?/,u=/\/wo\/webpack\/((wp5|ac)\/)?/,g=/\/officeonline\/pods\/s\/(h[0-9a-fA-F]+|\d+)_(app_scripts|pptscripts)\/?/,h=new RegExp(`(${/\/officeonline\/hashed\/[0-9a-fA-F]+\//.source}|${c.source}|${d.source}|${p.source}(${m.source}|${u.source}|/lib-es5/)|${g.source})`),f=/(wordviewerds|meboot|mathjax|jax|mml_htmlormml|common|common50|commonux([0-9a-fA-F\-]){0,10}|jquery(\.signalr\.merge\.\d+\.\d+\.min)?|compatparentelementfix|sharedcommentslazy|richtexteditor|copilotcommonux|copilotcomprehensionux|gc2host|appchrome|pptedit(ds)?(\.debug)?\.(core\.common|core1|core2|core3|precore)|(\@1js\/oscui\-compact\-quill\@\d{1,10}\.\d{1,10}\.\d{1,10}\/[A-Za-z0-9-]+\/v\d{1,10}\/bundled\/dist\/quill\.custom))\.(min\.)?js/,S=/(microsoftajaxds|common|mml_htmlormml|pptedit(ds)?(\.debug)?\.(core1|core2|core3|precore|ext-lazy)|officeextensionmerge)(\.min)?\.js(\:|$)/,b=/(wordeditords(eagercompile|separatedialog|\.debug)?\.(copilotcommon|common([0-9-])*)|recorder|ewats)(\.min)?\.js/,y=/(wordeditords|mathdesigner|microsoftajaxds|pptedit(ds)?(\.debug)?\.core3)\.(min\.)?js/,C=/(dime|wacboot|officewebsurfaces\.core|lpplazy|midgardbootstrapper|mathjax|livepersonacard_with-react_[0-9a-fA-F]{1,30}|pptedit(ds)?(\.debug)?\.(core1|core2|core3|precore))(\.min)?\.js/,E=/(mathjax|wacboot|wordeditords(eagercompile|separatedialog)?(\.box4\.dll1)?)(\.min)?\.js/,w=/(common|copilotcommonux)\.(min\.)?js/,_=/(officebrowserfeedback_floodgate)\.(min\.)?js/,v=new RegExp(`(${h.source})(common|common50|commonux([0-9a-fA-F]|\\-){0,10}|jquery(\\.signalr\\.merge\\.\\d+\\.\\d+\\.min)?|compatparentelementfix|sharedcommentslazy|richtexteditor|appchrome|copilotcommonux|copilotcomprehensionux)\\.(min\\.)?js`),T=new RegExp(`${l.source}(mathjax|jax|mml_htmlormml)\\.js`),I=new RegExp(`${c.source}mathjax/(mathjax)\\.js`),A=new RegExp("/scripts/me/mecontrol/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}/[a-zA-Z]{1,10}-[a-zA-Z]{1,10}/meboot.min.js"),P=new RegExp(`(/officeonline/versioned/host-word/\\d{1,4}\\.\\d{1,2}\\.\\d{1,2}/|${g.source}|${p.source}(${m.source}|${u.source}|/lib-es5/))(gc2|gc2host)\\.(min\\.)?js`),L=new RegExp(`(${d.source}|${p.source}(${m.source}|${u.source}|/lib-es5/))(gc2host)\\.(min\\.)?js`),x=new RegExp(`(${g.source})(pptedit(ds)?\\.precore)\\.(min\\.)?js`),D=new RegExp(`(${g.source})(pptedit(ds)?\\.core\\.common)\\.(min\\.)?js`),M=new RegExp(`(${g.source})(immersivereader)\\.(min\\.)?js`),k=new RegExp(`(${g.source})(pptedit(ds)?\\.(core1|core2|core3))\\.(min\\.)?js`),$=new RegExp(`(${v.source})|(${T.source})|(${I.source})|(${A.source})|(${P.source})|(${L.source})|(${x.source})|(${D.source})|(${M.source})|(${k.source})`),W=new RegExp(`(${h.source})(microsoftajaxds|common|pptedit(ds)?(.debug)?.(core1|core2|core3|precore|ext-lazy)|officeextensionmerge)\\.(min\\.)?js(\\:|$)`),R=new RegExp(`${l.source}mml_htmlormml.js`),O=new RegExp(`(${W.source})|(${R.source})`),U=new RegExp(`(${d.source}|${p.source}(${m.source}|${u.source}))feedback/officebrowserfeedback_floodgate\\.(min\\.)?js`),F=new RegExp(`((${h.source})(mathdesigner|microsoftajaxds|pptedit(ds)?(.debug)?.core3)\\.(min\\.)?js)|(${U.source})`),N=new RegExp("/office-growth/resources/programmablesurfaces/(int|prod)/officewebsurfaces\\.core\\.(min\\.)?js"),j=new RegExp(`(${h.source}(lpplazy|midgardbootstrapper)|(${l.source}mathjax))\\.(min\\.)?js`),J=new RegExp("/midgard/versionless/livepersonacard_with-react_[0-9a-fA-F]{1,30}\\.(min\\.)?js"),z=new RegExp("/dime/v1/dime\\.js"),H=new RegExp(`(${h.source}(mathjax/mathjax\\.js))`),V=new RegExp(`(${h.source}(pptedit(?:ds)?\\.(precore|core1|core2|core3)\\.js))`),B=new RegExp("/officeonline/p/s/h?[0-9a-fA-F]+_pptscripts/bootviewds\\.js"),G=new RegExp(`${N.source}|${j.source}|${J.source}|${z.source}|${H.source}|${V.source}|${B.source}`),K=new RegExp(`(${h.source})(common|copilotcommonux)\\.(min\\.)?js`),Z=new RegExp(`${l.source}mathjax.js`),q=new RegExp(`((${h.source})wordeditords(eagercompile|separatedialog)?(\\.box4\\.dll1)?\\.js)|(${Z.source})`),Y=new RegExp(`(${h.source})(wordeditords(eagercompile|separatedialog|\\.debug)?\\.(copilotcommon|common([0-9-])*)|recorder|ewats)\\.(min\\.)?js`),X=e=>"https://amcdn.msftauth.net"===e||(0,n.isAnAllowedOrigin)(e),Q=e=>n.localhostRegex.test(e),ee=(e,t)=>{try{throw new Error}catch(r){if(!r.stack)return!1;const a=r.stack.match(s);if(!a?.length)return!1;for(const r of a)try{const{origin:a,pathname:i}=new URL(r);if(!X(a))continue;const o=i.toLowerCase(),n=Q(a)&&t?.test(o),s=e?.test(o);if(s||n)return!0}catch{}return!1}},te=new Set(["","<input/>","<a href='#'></a>","<option></option>","<textarea>x</textarea>","<form></form><form></form>","<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>","Add-ins","Bold (Ctrl+B)","Border Options","Bullets","Bullets (Ctrl+.)","Catch up","Checklist (Ctrl+,)","Click to see page load statistics","Clipboard","Clear Formatting","Comments","Copy (Ctrl+C)","Copilot","Cut (Ctrl+X)","Decrease Indent (Ctrl+Shift+M)","Designer","Dictate","Dictate (Alt+`)","Editor","Emphasis","Find","Find (Ctrl+F)","Font Color","Font Name","Font Size","Format Painter (Ctrl+Alt+C, Ctrl+Alt+V) <br /> To apply the formatting in multiple places, double-click Format Painter.","Grow Font Size (Ctrl+Shift+>)","Heading 1","Heading 2","Headings and Other Styles","Help Improve Office","Highlight","Increase Indent (Ctrl+M)","Italic (Ctrl+I)","Mode Menu: Editing","More Collaboration Options","More Options","Normal","Numbering","Numbering (Ctrl+/)","Line Spacing","Paragraph Options","Paragraph Shading","Paste","RibbonOptionsTooltip","Saved <br /> Click the cloud icon to view file location","Sensitivity","Separate Pages","Set Proofing Language","Share","Share: this file is shared","Show Developer Tools Menu","Shrink Font Size (Ctrl+Shift+<)","Strikethrough (Ctrl+Shift+X)","Subscript (Ctrl+Shift+-)","Subtitle","Superscript (Ctrl+Shift++)","Switch to light background","Text Alignment","The current page number in the document. Click or tap to open the Navigation Pane.","The number of words in the selection or document. Click or tap to open the word count dialog box.","Title","Underline (Ctrl+U)","Undo","Undo (Ctrl+Z)","Zoom","Zoom In","Zoom Level","Zoom Out","Zoom to fit page width"])},5371:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testContent=t.htmlBlockListAttributes=t.htmlBlockList=t.defaultConfig=void 0,t.defaultConfig={ADD_TAGS:["#comment"],RETURN_TRUSTED_TYPE:!1},t.htmlBlockList=["applet","base","basefont","command","embed","frame","frameset","keygen","link","meta","noframes","noscript","object","param","script","title"],t.htmlBlockListAttributes=["contenteditable","contextmenu","controls","data","decoding","defer","dirname","draggable","dropzone","form","formaction","http-equiv","icon","importance","itemprop","keytype","kind","language","lazyload","manifest","minlength","muted","ping","sandbox","scoped","slot","spellcheck","srcdoc","srclang","start","target","translate","wrap","onerror","onclick","onload","onmouseover","onfocus","onblur","src","href"],t.testContent={maliciousHTML:"<div onerror=\"alert('XSS')\"></div>",maliciousSVG:'<svg><circle cx="50" cy="50" r="40" onclick="alert(\'XSS\')"></circle></svg>',maliciousMathML:"<math><msup><mi>x</mi><mn>2</mn></msup><div onclick=\"alert('XSS')\"></div></math>",sanitizedHTML:"<div></div>",sanitizedSVG:'<svg><circle r="40" cy="50" cx="50"></circle></svg>',sanitizedMathML:"<math><msup><mi>x</mi><mn>2</mn></msup></math><div></div>",missingAttrHTML:['<div paraid="example"></div>','<div lang="en"></div>'],missingTagsHTML:['<div class="InsertMediaM365Dialog" id="insertmediadialog"> <div class="InsertMediaM365Panel" id="insertmediapanel"> <iframe id="insertmediaframe" class="InsertMediaFrame" name="InsertMediaFrame"></iframe></div></div>',"\x3c!-- This is a comment --\x3e<div>Content</div>"]}},5267:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domPurifyPolicyHtml=t.createDomPurifyPolicyHtml=void 0;const a=r(561),i=r(6052);t.createDomPurifyPolicyHtml=(e,t)=>(0,a.createPolicy)(e,{createHTML:(e,t,r)=>(0,i.sanitizedHTMLAndValidate)(e,t,r)},t),t.domPurifyPolicyHtml=(0,t.createDomPurifyPolicyHtml)("domPurifyHTML")},6052:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domPurifyIsValidAttribute=t.sanitizedHTMLAndValidate=void 0;const a=r(6533),i=r(8805),o=a.__importStar(r(5371));t.sanitizedHTMLAndValidate=(e,t,r)=>{let a=!1;const n=t?(e=>({...o.defaultConfig,ALLOW_ARIA_ATTR:!1!==e.ALLOW_ARIA_ATTR,ALLOW_DATA_ATTR:!1!==e.ALLOW_DATA_ATTR,FORCE_BODY:e.FORCE_BODY||!1,IN_PLACE:e.IN_PLACE||!1,SAFE_FOR_TEMPLATES:e.SAFE_FOR_TEMPLATES||!1,SANITIZE_DOM:!1!==e.SANITIZE_DOM,SANITIZE_NAMED_PROPS:e.SANITIZE_NAMED_PROPS||!1,USE_PROFILES:!!e.USE_PROFILES&&e.USE_PROFILES,WHOLE_DOCUMENT:e.WHOLE_DOCUMENT||!1,PARSER_MEDIA_TYPE:e.PARSER_MEDIA_TYPE?e.PARSER_MEDIA_TYPE:"text/html"}))(t):o.defaultConfig;r&&Object.entries(r).forEach((([e,t])=>{(0,i.addHook)(e,t)}));const s=(0,i.sanitize)(e,n);return r&&Object.entries(r).forEach((([e])=>{(0,i.removeHooks)(e)})),t?.USE_PROFILES?s:(a=(e=>{let t=!1,r=!1;const a=new Set,i=new Set;return e.length>0&&(e.forEach((e=>{e.attribute?(r=o.htmlBlockListAttributes.includes(e.attribute.localName)||r,a.add(e.attribute.localName)):e.element&&(r=o.htmlBlockList.includes(e.element.localName)||r,i.add(e.element.localName))})),(a.size>0||i.size>0)&&(r||(t=!0))),t})(i.removed),a?e:s)},t.domPurifyIsValidAttribute=i.isValidAttribute},6401:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyStringPolicyURL=t.createEmptyStringPolicyURL=t.emptyStringPolicyHTML=t.createEmptyStringPolicyHtml=void 0;const a=r(561);t.createEmptyStringPolicyHtml=(e,t)=>(0,a.createPolicy)(e,{createHTML:e=>""},t),t.emptyStringPolicyHTML=(0,t.createEmptyStringPolicyHtml)("emptyStringPolicyHTML"),t.createEmptyStringPolicyURL=(e,t)=>(0,a.createPolicy)(e,{createScriptURL:e=>""},t),t.emptyStringPolicyURL=(0,t.createEmptyStringPolicyURL)("emptyStringPolicyURL")},9591:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urlOriginPolicy=t.createUrlOriginPolicy=t.isAnAllowedOrigin=t.localhostRegex=t.setRuntimeAllowedOrigins=void 0;const a=r(561),i=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-v-sdf.cdn.office.net","https://res-v.cdn.office.net","https://uci.edog.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-h1.cdn.office.net","https://res-1-sdf.cdn.office.net","https://res-2-sdf.cdn.office.net","https://res-1-dev.cdn.officeppe.net","https://res-2-dev.cdn.officeppe.net","https://content.lifecycle.office.net","https://content.lifecycle.officeppe.net","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://res-1.public.onecdn.static.microsoft","https://wordwebclientbuilds.blob.core.windows.net","https://js.live.net","https://c5-onenote-15.cdn.office.net","https://s1-onenote-gcc-15.cdn.office.net","https://ffc-powerpoint.officeapps.live.com","https://ppc-powerpoint.officeapps.live.com","https://powerpoint.officeapps.live.com","https://eurppc-powerpoint.officeapps.live.com","https://ffc-powerpoint.officeapps.live.com","https://fil1-powerpoint.officeapps.live.com","https://fin1-powerpoint.officeapps.live.com","https://fus1-powerpoint.officeapps.live.com","https://gbc-powerpoint.officeapps.live.com","https://jpc-powerpoint.officeapps.live.com","https://usc-powerpoint.officeapps.live.com"].map((e=>e.trim()));let o=[];t.setRuntimeAllowedOrigins=e=>{o=o.concat(e)};const n=[/^https?:\/\/([0-9a-zA-Z]+-)?(onenote|word-edit|word-view|excel)\.officeapps\.live\.com$/],s=[/^https?:\/\/([\w-]+-)?(excel)(-[\w-]+)?\.cdn\.office\.net$/];t.localhostRegex=new RegExp("https?://((localhost|local\\.teams\\.(office|live)\\.com|cpc-[\\w-]+|[\\w-]+\\.[\\w-]+\\.corp\\.microsoft\\.com)(:\\d+)?)(:|/|$)"),t.isAnAllowedOrigin=e=>i.includes(e)||o.includes(e)||n.some((t=>t.test(e)))||s.some((t=>t.test(e)))||t.localhostRegex.test(e),t.createUrlOriginPolicy=(e,r)=>(0,a.createPolicy)(e,{createScriptURL:e=>{let r;try{r=new URL(e,document.baseURI)?.origin}catch(t){r=new URL(e)?.origin}if(r&&(0,t.isAnAllowedOrigin)(r))return e;throw new Error(`TrustedTypes policy does not allow loading URL: ${e} with origin: ${r}`)}},r),t.urlOriginPolicy=(0,t.createUrlOriginPolicy)("urlOriginPolicy")},3893:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidStringPolicyHTML=t.createUUIDStringPolicyHtml=void 0;const a=r(561);t.createUUIDStringPolicyHtml=(e,t)=>(0,a.createPolicy)(e,{createHTML:e=>{if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e))return e;throw new Error("TrustedTypes policy: The provided value is not a valid UUID and cannot be used to create TrustedHTML")}},t),t.uuidStringPolicyHTML=(0,t.createUUIDStringPolicyHtml)("uuidStringPolicyHTML")},6533:function(e,t,r){"use strict";r.r(t),r.d(t,{__addDisposableResource:function(){return $},__assign:function(){return o},__asyncDelegator:function(){return T},__asyncGenerator:function(){return v},__asyncValues:function(){return I},__await:function(){return _},__awaiter:function(){return g},__classPrivateFieldGet:function(){return D},__classPrivateFieldIn:function(){return k},__classPrivateFieldSet:function(){return M},__createBinding:function(){return f},__decorate:function(){return s},__disposeResources:function(){return R},__esDecorate:function(){return c},__exportStar:function(){return S},__extends:function(){return i},__generator:function(){return h},__importDefault:function(){return x},__importStar:function(){return L},__makeTemplateObject:function(){return A},__metadata:function(){return u},__param:function(){return l},__propKey:function(){return p},__read:function(){return y},__rest:function(){return n},__runInitializers:function(){return d},__setFunctionName:function(){return m},__spread:function(){return C},__spreadArray:function(){return w},__spreadArrays:function(){return E},__values:function(){return b},default:function(){return O}});var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},a(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function n(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(r[a[i]]=e[a[i]])}return r}function s(e,t,r,a){var i,o=arguments.length,n=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(n=(o<3?i(n):o>3?i(t,r,n):i(t,r))||n);return o>3&&n&&Object.defineProperty(t,r,n),n}function l(e,t){return function(r,a){t(r,a,e)}}function c(e,t,r,a,i,o){function n(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=a.kind,c="getter"===l?"get":"setter"===l?"set":"value",d=!t&&e?a.static?e:e.prototype:null,p=t||(d?Object.getOwnPropertyDescriptor(d,a.name):{}),m=!1,u=r.length-1;u>=0;u--){var g={};for(var h in a)g[h]="access"===h?{}:a[h];for(var h in a.access)g.access[h]=a.access[h];g.addInitializer=function(e){if(m)throw new TypeError("Cannot add initializers after decoration has completed");o.push(n(e||null))};var f=(0,r[u])("accessor"===l?{get:p.get,set:p.set}:p[c],g);if("accessor"===l){if(void 0===f)continue;if(null===f||"object"!=typeof f)throw new TypeError("Object expected");(s=n(f.get))&&(p.get=s),(s=n(f.set))&&(p.set=s),(s=n(f.init))&&i.unshift(s)}else(s=n(f))&&("field"===l?i.unshift(s):p[c]=s)}d&&Object.defineProperty(d,a.name,p),m=!0}function d(e,t,r){for(var a=arguments.length>2,i=0;i<t.length;i++)r=a?t[i].call(e,r):t[i].call(e);return a?r:void 0}function p(e){return"symbol"==typeof e?e:"".concat(e)}function m(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function g(e,t,r,a){return new(r||(r=Promise))((function(i,o){function n(e){try{l(a.next(e))}catch(e){o(e)}}function s(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,s)}l((a=a.apply(e,t||[])).next())}))}function h(e,t){var r,a,i,o,n={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(n=0)),n;)try{if(r=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,a=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(!((i=(i=n.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){n=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){n.label=s[1];break}if(6===s[0]&&n.label<i[1]){n.label=i[1],i=s;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(s);break}i[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(e){s=[6,e],a=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}var f=Object.create?function(e,t,r,a){void 0===a&&(a=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,i)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]};function S(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||f(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,i,o=r.call(e),n=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)n.push(a.value)}catch(e){i={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return n}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function E(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],n=0,s=o.length;n<s;n++,i++)a[i]=o[n];return a}function w(e,t,r){if(r||2===arguments.length)for(var a,i=0,o=t.length;i<o;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}function _(e){return this instanceof _?(this.v=e,this):new _(e)}function v(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,i=r.apply(e,t||[]),o=[];return a={},n("next"),n("throw"),n("return"),a[Symbol.asyncIterator]=function(){return this},a;function n(e){i[e]&&(a[e]=function(t){return new Promise((function(r,a){o.push([e,t,r,a])>1||s(e,t)}))})}function s(e,t){try{(r=i[e](t)).value instanceof _?Promise.resolve(r.value.v).then(l,c):d(o[0][2],r)}catch(e){d(o[0][3],e)}var r}function l(e){s("next",e)}function c(e){s("throw",e)}function d(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function T(e){var t,r;return t={},a("next"),a("throw",(function(e){throw e})),a("return"),t[Symbol.iterator]=function(){return this},t;function a(a,i){t[a]=e[a]?function(t){return(r=!r)?{value:_(e[a](t)),done:!1}:i?i(t):t}:i}}function I(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(r){t[r]=e[r]&&function(t){return new Promise((function(a,i){!function(e,t,r,a){Promise.resolve(a).then((function(t){e({value:t,done:r})}),t)}(a,i,(t=e[r](t)).done,t.value)}))}}}function A(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function L(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return P(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function D(e,t,r,a){if("a"===r&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)}function M(e,t,r,a,i){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?i.call(e,r):i?i.value=r:t.set(e,r),r}function k(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function $(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var a;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=t[Symbol.asyncDispose]}if(void 0===a){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=t[Symbol.dispose]}if("function"!=typeof a)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:a,async:r})}else r&&e.stack.push({async:!0});return t}var W="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var a=new Error(r);return a.name="SuppressedError",a.error=e,a.suppressed=t,a};function R(e){function t(t){e.error=e.hasError?new W(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var a=e.stack.pop();try{var i=a.dispose&&a.dispose.call(a.value);if(a.async)return Promise.resolve(i).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const O={__extends:i,__assign:o,__rest:n,__decorate:s,__param:l,__metadata:u,__awaiter:g,__generator:h,__createBinding:f,__exportStar:S,__values:b,__read:y,__spread:C,__spreadArrays:E,__spreadArray:w,__await:_,__asyncGenerator:v,__asyncDelegator:T,__asyncValues:I,__makeTemplateObject:A,__importStar:L,__importDefault:x,__classPrivateFieldGet:D,__classPrivateFieldSet:M,__classPrivateFieldIn:k,__addDisposableResource:$,__disposeResources:R}}},t={};function r(a){var i=t[a];if(void 0!==i)return i.exports;var o=t[a]={exports:{}};return e[a].call(o.exports,o,o.exports,r),o.exports}r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};!function(){"use strict";r.r(a),r.d(a,{createClipboardItems:function(){return ie},createDeferredPromise:function(){return Xe},getClipboardPlatformEnvironment:function(){return Va},setClipboardPlatformFeatureGateManager:function(){return Ba}});var e=r(8234);let t;function i(){return t}const o="",n=".";var s,l,c,d,p,m;function u(e,t){return g(e,[t])}function g(e,t){if(!function(e){if(!e||"object"!=typeof e||!("reason"in e))return!1;return!!function(e){if(!e&&0!==e)return!1;const t=Number(e);return!isNaN(t)&&t.toString()===e.toString()}(e.reason)}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;const r=e.reason;return t.indexOf(r)>=0}function h(e){if(e&&"object"==typeof e){if(f(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(f(JSON.parse(e.innerError).reason))return!0}catch{}}if("string"==typeof e)try{if(f(JSON.parse(e).reason))return!0}catch{}return!1}function f(e){return e===c.LocalStorageInitilizationInaccessible}(l=s||(s={}))[l.SystemClipboard=0]="SystemClipboard",l[l.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",l[l.InMemory=4]="InMemory",l[l.LocalStorage=5]="LocalStorage",l[l.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",l[l.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",l[l.AsyncSystemClipboard=8]="AsyncSystemClipboard",l[l.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage",l[l.AsyncSystemClipboardAndInMemory=10]="AsyncSystemClipboardAndInMemory",function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage",e[e.AsyncClipboardReadFailure=44]="AsyncClipboardReadFailure",e[e.AsyncClipboardWriteFailure=45]="AsyncClipboardWriteFailure"}(c||(c={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(d||(d={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext",e[e.FailedToReadFromAsyncClipboard=16]="FailedToReadFromAsyncClipboard"}(p||(p={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(m||(m={}));class S extends Error{static augmentParameterValue(e){return e&&"string"==typeof e?e.trim():o}constructor(t,r,a){const o=S.augmentParameterValue(t);if(super(o),this.name=S.augmentParameterValue(r),this.errorName=this.name,this.name?i().ULS.traceTag(596456211,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Error '${this.name}': ${o}`):i().ULS.traceTag(596456212,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Error message: ${o}`),a){this.innerError=a;let t=this.innerError.message;t||(t=this.innerError.name);const r=S.augmentParameterValue(t);r.length>0&&i().ULS.traceTag(596456213,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Inner error message: ${r}`)}this.stack||(this.stack=(new Error).stack)}}class b extends S{constructor(e,t){super(e,"NoValidKeyError",t)}}class y extends S{static getDefaultMessage(e){let t="Missing argument";return e.length>0&&(t=`Missing argument: '${e}'`),t}constructor(e,t,r){const a=S.augmentParameterValue(t),i=y.getDefaultMessage(a);let o=S.augmentParameterValue(e);0===o.length&&(o=i),super(o,"MissingArgumentError",r),this.name=a}}class C extends S{static getDefaultMessage(e,t){return e.length>0?`Invalid '${e}' argument: '${t}'`:"Invalid argument"}constructor(e,t,r,a){const i=S.augmentParameterValue(t);let n=r;n||(n=o);const s=C.getDefaultMessage(i,n);let l=S.augmentParameterValue(e);0===e.length&&(l=s),super(l,"InvalidArgumentError",a),this.name=i,this.value=n}}class E extends S{constructor(e,t){super(e,"InvalidOperationError",t)}}class w extends S{constructor(e,t,r,a,i){super(`${e}. Data version: ${t}, Infra version: ${r}, blockMismatchDataVersion: ${a}`,"MismatchVersionError",i)}}class _ extends S{constructor(e,t,r,a){super(`${e}. Duration in clipboard (ms) : ${t}, TTL (ms): ${r}`,"TTLClipboardDataError",a)}}class v extends S{constructor(e,t,r,a){super(`${e}. Data User Hash : ${t}, infra User Hash: ${r}`,"UserHashMismatchError",a)}}class T extends S{constructor(e,t){super(e,"UnexpectedError",t)}}function I(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:o}class A extends S{constructor(e,t,r,a,i){super(t||`reason=${e}`,r,a),this.reason=e,i&&(this.errorName=i)}}class P extends A{constructor(e,t,r){super(e,t,"PasteError",r,I(e,p))}}class L extends A{constructor(e,t,r){super(e,t,"ClipboardPlatformError",r,I(e,c))}}function x(t){if(!t||!Array.isArray(t)||0===t.length)return void i().ULS.traceTag(596456214,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,"rethrowAfterAllActions: no actions to execute");let r,a=0;if(t.forEach((t=>{if(a+=1,t)try{t()}catch(t){i().ULS.traceTag(596456216,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`rethrowAfterAllActions: callback action #${a} threw an exception: ${t.message}`),r||(r=new E(t.message,t))}else i().ULS.traceTag(596456215,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`rethrowAfterAllActions: callback action #${a} is empty`)})),r)throw r}function D(){return M}const M={userAgent:()=>window&&window.navigator?window.navigator.userAgent:o,appVersion:()=>window&&window.navigator?window.navigator.appVersion:o};let k={};const $=new RegExp("(\\bTrident/| MSIE )"),W=16.16299,R=17.17123,O=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function U(){if(void 0===k.isIEProperty){k.isIEProperty=!1;const e=D();if(e&&e.userAgent&&"function"==typeof e.userAgent){const t=e.userAgent();if(t){const e=t.match($);e&&2===e.length&&(k.isIEProperty=!0)}}}return k.isIEProperty}function F(){if(void 0===k.isEdgeProperty){k.isEdgeProperty=!1,k.isEdgeWithTextHtmlClipboardSupportProperty=!1,k.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;const e=D();if(e&&e.appVersion&&"function"==typeof e.appVersion){const t=e.appVersion();if(t){const e=t.match(O);if(e&&2===e.length){k.isEdgeProperty=!0;const t=Number(e[1]);isNaN(t)||(t>=W&&(k.isEdgeWithTextHtmlClipboardSupportProperty=!0),t>=R&&(k.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return k.isEdgeProperty}const N=(e,t,r,a)=>{e.postMessage(t,r,a)},j="copy",J="cut",z="paste",H="copy",V="paste",B=(e,t,r,a=!1)=>(e.addEventListener(t,r,a),()=>{e.removeEventListener(t,r,a)}),G="text/plain",K="Text",Z="text/html",q="image/png",Y="metadata/is-last-copy-was-external",X="metadata/ccp-infra-version",Q="copyId",ee=function(){const e={items:{}};return{getData:()=>e,getItem:e=>{},setItem:(e,t)=>{throw new E(`Cannot set an item with clipboard data format '${e}' in an immutable empty clipboard (content is ${t&&t.length>0?"not ":o}empty)`)},setDeferredItem:(e,t)=>{throw new E(`Cannot set a deferred item with clipboard data format '${e}' in an immutable empty clipboard`)},hasDeferredItem:e=>!1,getDeferredItem:e=>{},get:()=>de(void 0)}}();function te(){return ee}function re(e){return e&&e.items?Object.keys(e.items).length:0}function ae(e){return re(e&&e.getData())}function ie(e=void 0){let t=e;t||(t={items:{}});const r={getItem:e=>oe(t,e),setItem:(e,r)=>{ne(t,e,r)},setDeferredItem:(e,r)=>{ne(t,e,r)},hasDeferredItem:e=>{if(!t||!t.items)return!1;const r=t.items[e];return!!r&&r instanceof Promise},getDeferredItem:e=>function(e,t){if(!e)throw new y(o,"clipboardItemsData");if(!e.items)throw new C(o,"clipboardItemsData.items");const r=e.items[t];return!r||r instanceof Promise?r:Promise.resolve(new Blob([r],{type:G}))}(t,e),getData:()=>t,get:()=>de(t)};return r}function oe(e,t){if(!e)throw new y(o,"clipboardItemsData");if(!e.items)throw new C(o,"clipboardItemsData.items");const r=e.items[t];if(!(r&&r instanceof Promise))return r}function ne(e,t,r){if(!e)throw new y(o,"clipboardItemsData");if(!e.items)throw new C(o,"clipboardItemsData.items");e.items[t]=r}function se(e,t){if(!e||0===e.length||!t||!t.trim())return o;let r;return e.forEach((e=>{e.clipboardDataFormat!==t||e.deferred||(r=e.data)})),r||o}function le(e){return se(e,G)}function ce(e){let t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:G,data:o}),t}function de(e){const t=[];if(0===re(e))return t;for(const r in e.items){let a=e.items[r];a||(a=o);const i={clipboardDataFormat:r,data:a,deferred:a instanceof Promise};t.push(i)}return t}var pe,me,ue,ge;(me=pe||(pe={}))[me.SystemClipboard=0]="SystemClipboard",me[me.InMemory=2]="InMemory",me[me.LocalStorage=3]="LocalStorage",me[me.AsyncSystemClipboard=4]="AsyncSystemClipboard",function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.ColumnWidths=4096]="ColumnWidths",e[e.Copilot=8192]="Copilot",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell",e[e.PasteWithColumnWidths=4100]="PasteWithColumnWidths",e[e.PasteWithCopilot=8196]="PasteWithCopilot"}(ue||(ue={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(ge||(ge={}));const he="BulsEndpointUrl",fe="usid",Se="-",be=1,ye=3600,Ce=2;let Ee=ve(),we=!1;function _e(){if(!we)throw new E("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return Ee}function ve(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:o,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:be,sharedClipboardExpirationInMinutes:ye,clipboardPromiseTimeoutInMinutes:Ce,remoteLoggerPath:o}}function Te(){let t=o;return window&&window.location&&window.location.origin?(t=window.location.origin,t||(t=o)):(i().ULS.traceTag(595932950,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`windowLocation.getWindowLocation: is window exist: ${!!window}. is window.location exist: ${window&&!!window.location}. is window.location.origin exist ${window&&window.location&&!!window.location.origin}. is window.location.protocol exist ${window&&window.location&&!!window.location.protocol}. is window.location.hostname exist ${window&&window.location&&!!window.location.hostname}. is window.location.port exist ${window&&window.location&&!!window.location.port}`),window&&window.location&&window.location.protocol&&window.location.hostname&&(t=window.location.protocol+"//"+window.location.hostname,window.location.origin=t)),{origin:t}}const Ie="://",Ae="http",Pe="https",Le=".",xe="/",De=":",Me=new RegExp("^\\d+$");let ke,$e,We=!1;function Re(t){if(!t)throw new y(o,"origin");const r=t.trim().toLowerCase();let a=o,n=r.split(Ie,3);if(!n||0===n.length||!n[0]||n[0]!==Ae&&n[0]!==Pe)throw new C("Missing protocol","origin",t);if(1===n.length)throw new C("Missing domain","origin",t);if(n.length>2)throw new C(`'${Ie}' should appear once`,"origin",t);let s=n[1];if(!s)throw new C("Missing domain","origin",t);if(a=n[0]+Ie,s=s.trim(),n=s.trim().split(xe,3),!n||0===n.length||!n[0]||!n[0].trim())throw new C("Missing domain","origin",t);if(n.length>2)throw new C("The last part of the origin should be the domain","origin",t);if(2===n.length&&n[1])throw new C("The last part of the origin should be the domain","origin",t);if(n=s.split(De,3),!n||0===n.length||!n[0]||!n[0].trim())throw new C("Missing domain","origin",t);if(n.length>2||2===n.length&&(!n[1]||!n[1].trim()))throw new C("The last part of the origin should be the domain and an optional port number","origin",t);if(s=n[0].trim(),a+=s,2===n.length){const e=n[1].trim(),r=Me.exec(e);if(!r||1!==r.length)throw new C("Invalid port number","origin",t);const i=Number(e);if(isNaN(i))throw new C("Invalid port number","origin",t);a+=De+e}return i().ULS.traceTag(596452423,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`getValidatedOrigin: origin = '${t}'; validated origin = '${a}'`),a}function Oe(e){Ne();const t=e.split(Ie,2),r=t[0],a=Ue(t[1]),i={protocol:r};if(i.environment=Fe(e,a,$e),a.length<=i.environment.length+1)throw new C("Missing app component","origin",e);if(a.charAt(i.environment.length)!==Le)throw new C("Missing a domain separator after the environment component","origin",e);const o=a.substr(i.environment.length+Le.length);if(i.app=Fe(e,o,ke),i.app.length<o.length&&o.charAt(i.app.length)!==Se)throw new C(`When the Office Online app name is not the domain prefix, '${Se}' should precede it`,"origin",e);return i}function Ue(e){if(!e)throw new y(o,"stringToReverse");const t=e.length;let r=o;for(let a=t-1;a>=0;a-=1)r+=e.charAt(a);return r}function Fe(e,t,r){if(!t)throw new y(o,"reversedValidatedHostname");if(!r)throw new y(o,"reversedStringsToLengthMap");const a=t.length,i=Object.keys(r).filter((e=>{const i=r[e];return i<=a&&t.substr(0,i)===e}));if(i&&i.length>0)return Ue(i[0]);throw new C("Invalid origin","validatedOrigin",e)}function Ne(){if(We)return;const e=_e();e.whitelistOriginComponents&&(ke=je(e.sharedClipboardHostingApps),$e=je(e.sharedClipboardHostingEnvironments),We=!0)}function je(e){const t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((e=>{t[Ue(e)]=e.length})),t):t}function Je(){return(Math.random()+1).toString(36).substring(7)}function ze(e){if(!e)throw new y(o,"id");const t=e.trim().toLowerCase();if(0===t.length)throw new C(o,"id");return t}function He(e,t,r,a,i){const o={id:e,operationCode:t,destination:r,userHash:a,clipboardItemsData:i};return Be(o),o}class Ve{}Ve.localStorageData="localStorage/data",Ve.localStorageMetadata="localStorage/metadata",Ve.initIframe="initIframe";const Be=function(e){if(!e)throw new y(o,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new y(o,"id");if(!e.operationCode)throw new y(o,"operationCode");if(!e.destination)throw new y(o,"destination");if("get"!==(t=e.operationCode)&&"set"!==t&&"init"!==t)throw new C(o,"operationCode",e.operationCode);var t;if("set"!==e.operationCode&&e.clipboardItemsData)throw new C(`'${e.operationCode}' expects no clipboard items`,"clipboardItemsData")};function Ge(e,t,r,a,i){const o={id:e,operationCode:t,failed:r,error:a,clipboardItemsData:i};return Ke(o),o}const Ke=function(t){if(!t)throw new y(o,"clipboardOperationResultMessage");const r=["failed","error","clipboardItemsData","operationCode","id","userHash"];let a=!1;for(const e of r)if(t.hasOwnProperty(e)){a=!0;break}if(!a)throw new b("clipboardOperationResultMessage has no valid key");if(!t.id||0===t.id.trim().length)throw i().ULS.traceTag(553747865,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`Missing argument 'id'. keys: ${JSON.stringify(Object.keys(t))}, isConstructorObject: ${t.constructor===Object}, operationCode: ${t.operationCode}, id: ${t.id}, failed: ${t.failed}, error: ${t.error}.`),new y(o,"id");if(!t.operationCode)throw new y(o,"operationCode");if("getresult"!==t.operationCode&&"setresult"!==t.operationCode&&"initresult"!==t.operationCode&&"unknownresult"!==t.operationCode&&"getMetadata_longPollingresult"!==t.operationCode)throw new C(o,"operationCode",t.operationCode);if(t.failed){if(!t.error)throw new C(`A failed '${t.operationCode}' operation expects a non-empty error argument`,"error");if(t.clipboardItemsData)throw new C(`A failed '${t.operationCode}' operation does not expect a clipboardItemsData argument`,"clipboardItemsData")}else{if(t.error)throw new C(`'${t.operationCode}' expects an empty error argument`,"error");if("unknownresult"===t.operationCode)throw new C(`'${t.operationCode}' can only be used with a failure message`,"operationCode")}if("getresult"===t.operationCode||"getMetadata_longPollingresult"===t.operationCode){if(!t.failed&&!t.clipboardItemsData)throw new C(`'${t.operationCode}' expects a clipboardItems argument`,"clipboardItemsData")}else if(t.clipboardItemsData)throw new C(`'${t.operationCode}' expects no clipboardItemsData argument`,"clipboardItemsData")};function Ze(t){if(!t||0===t.trim().length)throw new C(o,"className",t);return(()=>{let r=!1;function a(e){return`${t}:${e}: already disposed`}return{dispose:function(){r=!0},logIfDisposed:function(t){return r&&i().ULS.traceTag(596456217,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,a(t)),r},throwIfDisposed:function(e){if(r)throw new E(a(e))}}})()}class qe{initialize(t){return t.then((t=>(this.clipboardStorage=t,i().ULS.traceTag(596453007,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Clipboard strategy type '${this.clipboardStrategyType}' was initialized.`),Promise.resolve(this))),(t=>(i().ULS.traceTag(596453008,e.nh.msoulscat_ES_EWAJS,h(t)?e.kp.Info:e.kp.Error,`Failed to initialize clipboard strategy type '${this.clipboardStrategyType}'. Error: ${e.Wp.getStringifiedError(t)}`),Promise.reject(t))))}set(t,r){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){const t="ClipboardStrategyBase.set: this.clipboardStorage should be defined";return i().ULS.shipAssertTag(596121485,e.nh.msoulscat_ES_EWAJS,!1,t),Promise.reject(new L(c.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(t),this.clipboardStorage.set(t,r)}catch(e){return Promise.reject(new L(c.SetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).set`,e))}}get(t){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){const t="ClipboardStrategyBase.get: this.clipboardStorage should be defined";return i().ULS.shipAssertTag(596121486,e.nh.msoulscat_ES_EWAJS,!1,t),Promise.reject(new L(c.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(t).then((e=>(this.clipboardDataProcessor&&this.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)))).catch((r=>{throw i().ULS.traceTag(507848131,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`ClipboardStrategyBase.get - Failed to get clipboard items. Command id: ${t.id}, Error: ${e.Wp.getStringifiedError(r)}`),r}))}catch(e){return Promise.reject(new L(c.GetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).get`,e))}}onSystemClipboardChangedExternally(t){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(te(),t):(i().ULS.shipAssertTag(595882508,e.nh.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new L(c.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new L(c.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())}constructor(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=Ze(`${e}`)}}const Ye=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Xe(e){let t=e;return t&&0!==t.trim().length||(t=Je()),new rt(t)}function Qe(){return Ye?window.performance.now():Date.now()}function et(e){return Ye?new Date(e+window.performance.timing.navigationStart):new Date(e)}function tt(e,t,r){if(!r)throw new y(o,"creationTimestamp");return`${e?"Fulfilled":"Still unfulfilled"} after ${e?t?t-r:"?":Qe()-r}ms`}class rt{fulfilled(){return this.isFulfilled}resolve(t){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(t):i().ULS.traceTag(596456257,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`Deferred promise - resolve: the resolve for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}reject(t){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(t):i().ULS.traceTag(596456260,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`Deferred promise - reject: the reject for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}markAsFulfilled(t){this.fulfillmentCheck(t)||(this.isFulfilled=!0,this.rejected="resolve"!==t,this.fulfillmentTimestamp=Qe(),i().ULS.traceTag(596456261,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Deferred promise: marking promise #${this.sequenceId} with id '${this.id}' as fulfilled (${this.rejected?"rejected":"resolved"}). ${tt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`))}fulfillmentCheck(t){return i().ULS.traceTag(596456258,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Deferred promise: asked to ${t} deferred promise #${this.sequenceId} with id '${this.id}'`),this.isFulfilled&&i().ULS.traceTag(596456259,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`Deferred promise: cannot ${t} deferred promise #${this.sequenceId} with id '${this.id}' since it was ${this.rejected?"rejected":"resolved"} already on ${et(this.fulfillmentTimestamp)}. ${tt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`),this.isFulfilled}constructor(t){this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=ze(t),rt.sequenceId+=1,this.sequenceId=rt.sequenceId,this.creationTimestamp=Qe(),i().ULS.traceTag(596456225,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Deferred promise: creating deferred promise #${this.sequenceId} with id '${this.id}' on ${et(this.creationTimestamp)}`),this.promise=new Promise(((t,r)=>{i().ULS.traceTag(596456226,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Deferred promise: registering callback for promise #${this.sequenceId} with id '${this.id}' on ${et(Qe())}`),this.internalResolve=t,this.internalReject=r}))}}rt.sequenceId=0;class at{getDeferredPromise(e){const t=ze(e);return this.deferredResultMessagePromiseCache[t]}getPromise(t){const r=this.getDeferredPromise(t);if(r)return i().ULS.traceTag(596456218,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Deferred promise cache: found a deferred promise with id '${t}'.`),r.promise;i().ULS.traceTag(596456219,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Deferred promise cache: there is no deferred promise with id '${t}'.`)}addNewPromise(t){const r=Xe(t);if(this.getDeferredPromise(r.id))throw new C("A deferred promise already exists in the cache for the specified id","id",r.id);const a=ze(r.id);return this.deferredResultMessagePromiseCache[a]=r,i().ULS.traceTag(596456220,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Deferred promise cache: added a new deferred promise with id '${r.id}'.`),r}getLength(){let e=0;for(const t in this.deferredResultMessagePromiseCache)e+=1;return e}delete(t){if(!this.getDeferredPromise(t))return void i().ULS.traceTag(596456221,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Deferred promise cache: no need to delete an item with id '${t}' since this id is not associated with an existing deferred promise.`);const r=ze(t);delete this.deferredResultMessagePromiseCache[r],i().ULS.traceTag(596456222,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Deferred promise cache: deleted id '${t}'.`)}clear(){if(i().ULS.traceTag(596456223,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Deferred promise cache: clearing ${this.getLength()} items from the cache`),this.deferredResultMessagePromiseCache)for(const t in this.deferredResultMessagePromiseCache){const r=this.deferredResultMessagePromiseCache[t];if(r)try{r.reject()}catch(r){i().ULS.traceTag(596456224,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`Deferred promise cache: clear failed to reject promise id '${t}' with this exception: ${r.message}. Ignoring.`)}}this.deferredResultMessagePromiseCache={}}constructor(){this.deferredResultMessagePromiseCache={}}}const it="initmessageid",ot="CreatorOrigin";function nt(e){if(!e)throw new y(o,"remoteWindow");if(!("window"in e)||!e.window)throw new y(o,"remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new y(o,"remoteWindow.windowOrigin");const t=function(e){Ne();const t=Re(e),r=Re(Te().origin);if(t===r)return t;if(!_e().whitelistOriginComponents)throw new E(`validateOriginForReceivedMessage: Caller origin '${e}' doesn't match the current window's origin '${r}'`);const a=Oe(t),i=Oe(r);if(a.protocol!==i.protocol)throw new E(`validateRemoteWindowOrigin: Caller origin's protocol '${a.protocol}' doesn't match the current window origin's protocol '${i.protocol}'`);if(a.environment!==i.environment)throw new E(`validateRemoteWindowOrigin: Caller origin's environment '${a.environment}' doesn't match the current window origin's environment '${i.environment}'`);return t}(e.windowOrigin);return{window:e.window,windowOrigin:t}}class st{get disposableImplementationExtension(){return this._disposableImplementationExtension}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(x([()=>{this.sender&&this.sender.dispose()},()=>{this.receiver&&this.receiver.dispose()}]),this.disposableImplementationExtension.dispose())}postMessage(t){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!t)throw new y(o,"outgoingMessage");if(!this.sender){const t="WindowRPCBase::postMessage - this.sender should be defined";throw i().ULS.shipAssertTag(596121484,e.nh.msoulscat_ES_EWAJS,!1,t),new E(t)}this.sender.postMessage(t)}constructor(e,t,r,a){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=Ze(a)}}function lt(){return ct}const ct={addEventListener:(e,t)=>window.addEventListener(e,t),removeEventListener:(e,t)=>window.removeEventListener(e,t)},dt="message";class pt{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(lt().removeEventListener(dt,this.windowMessageHandler),this.disposableImplementationExtension.dispose())}shouldFilterMessageEvent(t){try{if(!t.origin||!t.source)return i().ULS.traceTag(596452370,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(t.source===window)return i().ULS.traceTag(596452371,e.nh.msoulscat_ES_EWAJS,e.kp.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&t.source!==this.remoteWindow.window)return i().ULS.traceTag(596452372,e.nh.msoulscat_ES_EWAJS,e.kp.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(t.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return i().ULS.traceTag(596452373,e.nh.msoulscat_ES_EWAJS,e.kp.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1}onMessageReceived(t){if(this.shouldFilterMessageEvent(t))return;let r;try{r=this.deserializer.deserialize(t.data)}catch(t){i().ULS.traceTag(596452374,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Window RPC Receiver: unable to deserialize incoming message. ${e.Wp.getStringifiedError(t)}`);try{this.handler.handleDeserializationError(t)}catch(t){i().ULS.traceTag(596452184,e.nh.msoulscat_ES_EWAJS,e.kp.Error,`Window RPC Receiver: unable to handle deserialization error. ${e.Wp.getStringifiedError(t)}`)}return}if(r)try{this.handler.handleMessage(r).catch((t=>{i().ULS.traceTag(595985880,e.nh.msoulscat_ES_EWAJS,e.kp.Error,`Window RPC Receiver: unable to process incoming message. ${e.Wp.getStringifiedError(t)}`)}))}catch(t){i().ULS.traceTag(596452186,e.nh.msoulscat_ES_EWAJS,e.kp.Error,`Window RPC Receiver: unable to process incoming message. ${e.Wp.getStringifiedError(t)}`)}else i().ULS.traceTag(596452185,e.nh.msoulscat_ES_EWAJS,e.kp.Error,"Window RPC Receiver: the incoming message is empty")}constructor(e,t,r){if(this.deserializer=e,this.handler=t,this.windowMessageHandler=e=>this.onMessageReceived(e),!e)throw new y(o,"deserializer");if(!t)throw new y(o,"handler");if(!r)throw new y(o,"windowRPC");this.disposableImplementationExtension=Ze("WindowRPCReceiverInternal"),this.remoteWindow=nt(r.remoteWindow),lt().addEventListener(dt,this.windowMessageHandler)}}class mt{postMessage(e){if(!e)throw new y(o,"outgoingMessage");if(!this.remoteWindow.window)throw new E("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new E("The remote window does not support postMessage");const t=this.serializer.serialize(e);N(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t,r=!1){if(this.serializer=e,this.delayedQueueEnabled=r,!e)throw new y(o,"serializer");if(!t)throw new y(o,"windowRPC");this.disposableImplementationExtension=Ze("WindowRPCSenderInternal"),this.remoteWindow=nt(t.remoteWindow)}}const ut="OfficeOnlineCCP_",gt=ut+"Metadata_",ht=ut+"Data_",ft="_LocalStorageChangedFlag";function St(e){return gt+e}class bt{constructor(){this.copyStatus=yt.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0,this.isFullSheetCopy=!1}}var yt;function Ct(e){let t;return e&&e.lastCopy&&(t={...e.lastCopy}),{lastCopy:t}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(yt||(yt={}));class Et{get(t){this.disposableImplementationExtension.throwIfDisposed("get"),i().ULS.traceTag(595716238,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`localStorageClipboardStorage.get: commandParameters.id='${t?t.id:o}'`);const r=localStorage.getItem(this.localStorageKey);if(!r)return Promise.resolve(te());try{const e=JSON.parse(r);if(!e||0===re(e))return Promise.resolve(te());const t=ie(e);return Promise.resolve(t)}catch(e){return Promise.resolve(te())}}set(t,r){this.disposableImplementationExtension.throwIfDisposed("set"),i().ULS.traceTag(595716239,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`localStorageClipboardStorage.set: item count=${ae(t)}'; commandParameters.id='${r?r.id:o}'`),0===ae(t)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(t.getData()));const a=`${this.localStorageKey+ft}`,n=Je();return i().ULS.traceTag(595654546,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`localStorageClipboardStorage.set: set local storage value. eventFalgKey = ${a}. eventFlagValue = ${n}`),localStorage.setItem(a,n),Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[G,Z,"data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new L(c.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new L(c.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=pe.LocalStorage,this.disposableImplementationExtension=Ze("LocalStorageClipboardStorage")}}class wt extends qe{constructor(e){super(s.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class _t{onStorageChanged(t){i().ULS.shipAssertTag(595716249,e.nh.msoulscat_ES_EWAJS,null!=t,"e should not be null"),i().ULS.traceTag(595716288,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ${t.key}. localStorageKeyToWatch = ${this.localStorageKeyToWatch}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),i().ULS.traceTag(595716289,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((()=>{this.raiseMetadataChangedEvent()}),(()=>{i().ULS.traceTag(595716295,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))}raiseMetadataChangedEvent(){return i().ULS.traceTag(595715525,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.clipboardStrategy.get({userHash:0}).then((t=>{this.listener(t),i().ULS.traceTag(595716232,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ${this.lastLocalStorageValue}`)}),(t=>{i().ULS.traceTag(595716233,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))}isLocalStorageValueChanged(){const t=localStorage.getItem(this.localStorageKeyToWatch),r=this.lastLocalStorageValue!==t;return i().ULS.traceTag(595715526,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ${this.lastLocalStorageValue}. currentLocalStorageValue = ${t}`),this.lastLocalStorageValue=t,r}waitForLocalStorageValueToChange(t){if(i().ULS.traceTag(595715527,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged())return i().ULS.traceTag(595715528,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ${this.lastLocalStorageValue}`),Promise.resolve();const r=Xe(),a=new Date,o=setInterval((()=>{const n=(new Date).getTime()-a.getTime();i().ULS.traceTag(595715529,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ${a}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()?(clearInterval(o),i().ULS.traceTag(595716234,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ${a}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),r.resolve()):n>t&&(clearInterval(o),i().ULS.traceTag(595716235,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ${a}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),r.reject())}),200);return r.promise}constructor(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}}r(8615);const vt="\n",Tt="\r",It=new RegExp(`(${vt}${Tt})|(${Tt}${vt})|(${Tt})`,"g"),At=new RegExp("(\t)","g"),Pt=10240,Lt=new RegExp("<","g"),xt=new RegExp(">","g"),Dt="table",Mt="tr",kt="td",$t=`Version:0.9${vt}StartHTML:0000000100${vt}EndHTML:{EndHTML0}${vt}StartFragment:0000000134${vt}EndFragment:{EndFragm}${vt}<html>${vt}<body>${vt}\x3c!--StartFragment--\x3e${vt}`,Wt=`\x3c!--EndFragment--\x3e${vt}</body>${vt}</html>`,Rt="0000000000",Ot="data-ccp-timestamp";function Ut(e){return e?e.replace(It,vt):e}function Ft(e){return e?e.length<=Pt?e:e.substr(0,Pt):o}function Nt(e){var t,r;const a=function(e){return e?e.replace(It,`</${kt}></${Mt}><${Mt}><${kt}>`):e}((r=(t=e)?t.replace(Lt,"&lt;").replace(xt,"&gt;"):o)?r.replace(At,`</${kt}><${kt}>`):r);return`<${Dt}><${Mt}><${kt}>${a}</${kt}></${Mt}></${Dt}>`}function jt(e){const t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(let e=1;e<r.length;e+=1)t.push("\t"),t.push(r[e].innerText)}return t.join("")}function Jt(t){if(!F()||F()&&k.isEdgeVersionWithTextHtmlWrapperSupportProperty)return t;const r=10,a=$t.length+t.length+Wt.length;let o=(a-Wt.length).toString();if(o.length<r&&(o=Rt.substr(0,r-o.length)+o),o.length!==r){const t=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is ${o.length} but it should be 10`;throw i().ULS.shipAssertTag(596128536,e.nh.msoulscat_ES_EWAJS,!1,t),new L(c.UnexpectedClipboardTextHtmlContentLength,t)}let n=(a-7).toString();if(n.length<r&&(n=Rt.substr(0,r-n.length)+n),n.length!==r){const t=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is ${n.length} but it should be 10`;throw i().ULS.shipAssertTag(596128537,e.nh.msoulscat_ES_EWAJS,!1,t),new L(c.UnexpectedClipboardTextHtmlContentLength,t)}const s=$t.replace("{EndHTML0}",n).replace("{EndFragm}",o)+t+Wt;return i().ULS.shipAssertTag(596128538,e.nh.msoulscat_ES_EWAJS,s.length===a,`addClipboardWrapperForEdge: The resulting text/html payload length of ${s.length} differs from the expected length of ${a}`),s}let zt;var Ht=r(4645);let Vt;const Bt={serializeMetadata:function(t){if(!t)return"{}";try{const r={},a=function(t){if(t)try{if(!t.id)throw new L(c.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.id is not defined");if(!t.sessionId)throw new L(c.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.sessionId is not defined");if(void 0===t.copyStatus)throw new L(c.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.copyStatus is not defined");return{id:t.id,sessionId:t.sessionId,sourceItem:Vt.serializeSourceItem(t.sourceItem),commandParameters:Vt.serializeCommandParameters(t.commandParameters),copyStatus:t.copyStatus,isTimestampStoredInSystemClipboard:t.isTimestampStoredInSystemClipboard,isAsyncSerializeFailed:t.isAsyncSerializeFailed,asyncClipboardItemsKeys:t.asyncClipboardItemsKeys,syncClipboardItemsKeys:t.syncClipboardItemsKeys,isFullSheetCopy:t.isFullSheetCopy}}catch(t){return void i().ULS.traceTag(595945243,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`MetadataSerializer.serializeCopyContext: failed to serialized copyContext: ${e.Wp.getStringifiedError(t)}`)}}(t.lastCopy);return a&&(r.copyContext=a),JSON.stringify(r)}catch(t){return i().ULS.traceTag(595945242,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`MetadataSerializer.serializeMetadata: failed to serialized metadata: ${e.Wp.getStringifiedError(t)}`),"{}"}},deserializeMetadata:function(t){if(!t)return{};try{const r=JSON.parse(t),a={};return r.copyContext&&(a.lastCopy=function(t){if(t)try{if(!t.id)throw new L(c.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.id is not defined");if(!t.sessionId)throw new L(c.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sessionId is not defined");if(!t.copyStatus)throw new L(c.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.copyStatus is not defined");if(!t.sourceItem)throw new L(c.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sourceItem is not defined");if(!t.commandParameters)throw new L(c.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.commandParameters is not defined");const e=new bt;return e.id=t.id,e.sessionId=t.sessionId,e.copyStatus=t.copyStatus,e.isTimestampStoredInSystemClipboard=t.isTimestampStoredInSystemClipboard,e.isAsyncSerializeFailed=t.isAsyncSerializeFailed,e.sourceItem=Vt.deserializeSourceItem(t.sourceItem),e.commandParameters=Vt.deserializeCommandParameters(t.commandParameters),e.asyncClipboardItemsKeys=t.asyncClipboardItemsKeys,e.syncClipboardItemsKeys=t.syncClipboardItemsKeys,e.isFullSheetCopy=t.isFullSheetCopy,e}catch(t){return void i().ULS.traceTag(595945245,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`MetadataSerializer.deserializeMetadata: failed to deserialized copyContext with error: ${e.Wp.getStringifiedError(t)}.`)}}(r.copyContext)),a}catch(t){i().ULS.traceTag(595945244,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`MetadataSerializer.deserializeMetadata: failed to deserialized metadata with error: ${e.Wp.getStringifiedError(t)}`)}return{}}};let Gt,Kt,Zt,qt={};const Yt={};let Xt;const Qt={getCachedMetadata:function(){return i().ULS.traceTag(595730648,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`MetadataManager.getCachedMetadata: get cached metadata with value: ${ir(qt)}`),Ct(qt)},updateMetadata:function(t){i().ULS.traceTag(595730652,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`MetadataManager.updateMetadata: start update metadata with metadata : ${ir(t)}`);const r={...qt,...t},a=ie();a.setItem("metadata",Kt.serializeMetadata(r)),i().ULS.traceTag(595730653,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`MetadataManager.updateMetadata: schedule metadata with value: ${ir(r)}`),rr(a,r)},clear:function(){i().ULS.traceTag(595730654,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"MetadataManager.clear: start clear metadata");rr(ie(),{})},addMetadataChangeListener:function(t,r){t||i().ULS.traceTag(595936158,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define"),r||i().ULS.traceTag(595936159,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,"MetadataManager.addMetadataChangeListener: expected listener to be define"),Yt[t]&&i().ULS.traceTag(595936160,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`MetadataManager.addMetadataChangeListener: listener with same listenerId(${t} already exist.`),Yt[t]=r},removeMetadataChangeListener:function(t){t||i().ULS.traceTag(595936161,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define"),Yt[t]?delete Yt[t]:i().ULS.traceTag(595936162,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`MetadataManager.removeMetadataChangeListener: can't find listener with listenerId = ${t}.`)},getMetadataSyncPromise:function(){return Xt&&(0,Ht.isChangeGateEnabled)("OfficeVSO:2594435_ArtCCPWaitForCopyToComplete")?(i().ULS.traceTag(595937174,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"MetadataManager.getMetadataSyncPromise: metadata not sync, return deferred promise."),Xt.deferredPromise.promise.then((t=>(i().ULS.traceTag(595937175,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"MetadataManager.getMetadataSyncPromise: sync promise resolved."),t)))):(i().ULS.traceTag(595937173,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"MetadataManager.getMetadataSyncPromise: metadata is sync, return resolved promise."),Promise.resolve(Ct(qt)))},isMetadataSync:function(){return!Xt},serializeMetadata:function(e){return Kt.serializeMetadata(e)},deserializeMetadata:function(e){return Kt.deserializeMetadata(e)}};function er(t){try{if(t&&0!==ae(t)){const r=t.getItem("metadata");qt=Kt.deserializeMetadata(r),i().ULS.traceTag(595730650,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`MetadataManager.onMetadataChanged: set cached metadata with value ${ir(qt)}`)}else i().ULS.traceTag(595730649,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"MetadataManager.onMetadataChanged: set empty cached metadata because clipboardItems were not found"),qt={}}catch(t){i().ULS.traceTag(595945248,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`MetadataManager.onMetadataChanged: failed to parse metadata string with error: ${e.Wp.getStringifiedError(t)}`),qt={}}tr(Ct(qt))}function tr(t){i().ULS.traceTag(595730651,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`MetadataManager.updateListenerForMetadataChanged: update listeners with metadata : ${ir(t)}`);for(const e in Yt){const r=Yt[e];r&&r(t)}}function rr(t,r){const a=Je();Xt?Xt.metadataSyncMessageId=a:(Xt={metadataSyncMessageId:a,deferredPromise:Xe()},i().ULS.traceTag(595937176,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`MetadataManager.scheduleMetadataUpdate: _syncMetadata created. ${Xt.metadataSyncMessageId}`)),i().ULS.traceTag(595937177,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`MetadataManager.scheduleMetadataUpdate: set metadata request was sent with message id ${a}.`),setTimeout((()=>{Gt.set(t,{}).then((()=>{qt=r,i().ULS.traceTag(595937178,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`MetadataManager.scheduleMetadataUpdate: set metadata successfully. messageId=${a}. _syncMetadata.metadataSyncMessageId = ${Xt&&Xt.metadataSyncMessageId}. newMetadata = ${ir(r)}`),ar(a)}),(t=>{i().ULS.traceTag(595945250,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`MetadataManager.updateMetadata: failed to update metadata store with error: ${e.Wp.getStringifiedError(t)}`),ar(a)}))}),0)}function ar(t){if(i().ULS.traceTag(595730655,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`MetadataManager.notifyMetadataSyncIfNeeded: start notifyMetadataSyncIfNeeded with messageId: ${t}`),Xt&&Xt.metadataSyncMessageId===t){const t=Xt;Xt=void 0;const r=Ct(qt);i().ULS.traceTag(595730656,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`MetadataManager.notifyMetadataSyncIfNeeded: resolve with metadata: ${ir(r)}`),tr(r),t.deferredPromise.resolve(r)}}function ir(e){return e?e.lastCopy?`copyContext.id=${e.lastCopy.id}`:"copy context is null":"metadata is null"}const or="ccp_infra_version=['|\"](\\d+)['|\"]";class nr{wrapTextWithDataSignature(e,t,r,a="null",i){const o={ccp_infra_version:3,ccp_infra_timestamp:r,ccp_infra_user_hash:this.userHash,ccp_infra_copy_id:a};let n;return n=null!==i&&0!==Object.keys(i).length?{...o,...i}:o,n[Ot]=r,function(e,t,r){let a="";return r&&(a=Object.keys(r).reduce(((e,t)=>t?`${e} ${t}='${r[t]}'`:e),"")),`<${t}${a}>${e}</${t}>`}(e,t,n)}ensureDataSignatureInHtmlItem(e){if(0===ae(e))return;const t=ce(e),r=se(t,Q),a=se(t,"metadata/additional-signature-data-attributes");let i=null;if(a!==o&&(i=JSON.parse(a)),e.hasDeferredItem(Z)){const t=e.getDeferredItem(Z);if(t){const a=t.then((e=>e.text())).then((e=>void 0!==this.getRegExIntValue(e,or)?new Blob([e],{type:Z}):new Blob([this.wrapTextWithDataSignature(e,"div",Date.now(),r,i)],{type:Z})));return void e.setDeferredItem(Z,a)}}else{const a=se(t,Z);if(a){if(void 0!==this.getRegExIntValue(a,or))return;return void e.setItem(Z,this.wrapTextWithDataSignature(a,"div",Date.now(),r,i))}}if(e.hasDeferredItem(G)){const t=e.getDeferredItem(G);if(t){const a=t.then((e=>e.text())).then((e=>{const t=Nt(e),a=this.wrapTextWithDataSignature(t,"pre",Date.now(),r,i);return new Blob([Jt(a)],{type:Z})}));e.setDeferredItem(Z,a)}}else{const a=Nt(le(t)),o=this.wrapTextWithDataSignature(a,"pre",Date.now(),r,i);e.setItem(Z,Jt(o))}}extractSignatureData(t){if(re(t)>0){const r=oe(t,Z),a=this.getRegExIntValue(r,or);if(void 0===a)return this.parsePreSignatureData(r);if(this.blockMismatchDataVersion&&3!==a)throw i().ULS.traceTag(595902983,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`clipboardDataManager.extractSignatureData: block mismatch version. dataVer = ${a}, CCPInfraVersion = 3`),new w("ClipboardDataManagerImpl.extractSignatureData",a,3,this.blockMismatchDataVersion);return a<3?(i().ULS.traceTag(595902986,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`clipboardDataManager.extractSignatureData: got data with older version then app version: dataVer = ${a}, CCPInfraVersion = 3. Converting to the data`),this.parseOldSignatureData(r)):(a>3&&i().ULS.traceTag(595900176,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`clipboardDataManager.extractSignatureData: got data with newer version then app version: dataVer = ${a}, CCPInfraVersion = 3. ( It's OK - Should be forward compatibility)`),this.parseCurrentVersionSignatureData(r))}}parseCurrentVersionSignatureData(t){const r=this.getRegExIntValue(t,"\\s+ccp_infra_timestamp=['|\"](\\d+)['|\"]"),a=this.getRegExIntValue(t,"\\s+ccp_infra_user_hash=['|\"](\\d+)['|\"]");if(void 0!==r&&void 0!==a){const o=this.getRegExStringValue(t,"\\s+ccp_infra_copy_id=['|\"]([\\w-]+)['|\"]");return o&&i().ULS.traceTag(595183181,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`clipboardDataManager.parseCurrentVersionSignatureData: copy ID of legacy paste cross session : ${o}`),{ccp_infra_version:3,ccp_infra_timestamp:r,ccp_infra_user_hash:a,ccp_infra_copy_id:o||""}}i().ULS.traceTag(595902985,e.nh.msoulscat_ES_EWAJS,e.kp.Error,`clipboardDataManager.extractSignatureData: Failed to extract SignatureData. textHtmlItem: ${t}`)}parseOldSignatureData(e){return this.parseCurrentVersionSignatureData(e)}parsePreSignatureData(t){const r=function(e){const t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new y(o,"attributeName");const r=new RegExp(`${t}=['"](\\d+)['"]`,"i").exec(e);return!r||r.length<2?void 0:r[1]}(e,Ot);if(!t||!t.trim())return;const r=Number(t);return!r&&0!==r||isNaN(r)?void 0:r}(t);if(i().ULS.traceTag(595723668,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`clipboardDataManager.parsePreSignatureData: dataTimeStamp=${r}`),r){if(this.blockMismatchDataVersion)throw i().ULS.traceTag(595899270,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,"clipboardDataManager.parsePreSignatureData: block mismatch version. block pre signature data"),new w("ClipboardDataManagerImpl.extractSignatureData",NaN,3,this.blockMismatchDataVersion);const t={ccp_infra_version:3,ccp_infra_timestamp:r,ccp_infra_user_hash:0};return i().ULS.traceTag(595723669,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"clipboardDataManager.parsePreSignatureData"),t}}validateTTL(t){if(t&&this.ttlInMs){const r=Date.now()-t.ccp_infra_timestamp;if(r>this.ttlInMs)throw i().ULS.traceTag(595899858,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`Time elapsed (${r} ms) from setting Clipboard (${t.ccp_infra_timestamp}) is greater then TTL (${this.ttlInMs} ms) - return error`),new _("clipboardDataManager.validateTTL validation failed",r,this.ttlInMs)}}validateUserHash(t){if(t&&t.ccp_infra_user_hash!==this.userHash)throw i().ULS.traceTag(595723670,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,"clipboardDataManager.validateUserHash: user hash mismatch detected. throw error"),new v("clipboardDataManager.validateUserHash validation failed",t?t.ccp_infra_user_hash:0,this.userHash)}setMetaDataVersionItem(e){if(0===ae(e))return;e.setItem(X,JSON.stringify({ccp_infra_version:3}))}validateMetaDataVersionItem(t){if(t&&ae(t)>0){const r=oe(t.getData(),X);let a;try{a=JSON.parse(r)}catch(t){if(!this.blockMismatchDataVersion)return;throw i().ULS.traceTag(595899272,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`clipboardDataManager.validateMetaDataVersionItem: failed parse SignatureMetaData. error = ${t}`),new T(`ClipboardDataManagerImpl.validateMetaDataVersionItem: failed parse SignatureMetaData. SignatureMetaData text = ${r}`)}if(this.blockMismatchDataVersion&&3!==a.ccp_infra_version)throw i().ULS.traceTag(595899203,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`clipboardDataManager.validateMetaDataVersionItem: block mismatch version. dataVer = ${a.ccp_infra_version}, CCPInfraVersion = 3`),new w("ClipboardDataManagerImpl.validateMetaDataVersionItem",a.ccp_infra_version,3,this.blockMismatchDataVersion)}}createClipboardDataProcessor(t){return i().ULS.traceTag(595723671,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`clipboardDataManager.createClipboardDataProcessor: get called. validateUserHash=${t}`),{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:(r=>{if(i().ULS.traceTag(595723672,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`clipboardDataManager.createClipboardDataProcessor.postGet: get called. validateUserHash=${t}`),r){const a=this.extractSignatureData(r.getData());i().ULS.traceTag(595723673,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`clipboardDataManager.createClipboardDataProcessor.postGet: clipboardItems not empty. validateUserHash=${t}`),a&&r.setItem(Q,a.ccp_infra_copy_id),this.validateTTL(a),t&&(i().ULS.traceTag(595723674,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`clipboardDataManager.createClipboardDataProcessor.postGet: going to validate user hash. validateUserHash=${t}`),this.validateUserHash(a))}}).bind(this)}}createDualClipboardDataProcessor(t){return i().ULS.traceTag(595723675,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"clipboardDataManager.createDualClipboardDataProcessor: get called."),{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:(t=>{i().ULS.traceTag(595723676,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"clipboardDataManager.createDualClipboardDataProcessor.postGet: get called."),t&&t.clipboardItemsData&&(t.signatureData=this.extractSignatureData(t.clipboardItemsData),t.signatureData&&(t.clipboardItemsData.items[Q]=t.signatureData.ccp_infra_copy_id),this.validateTTL(t.signatureData))}).bind(this),validateUserHash:t?this.validateUserHash.bind(this):()=>{}}}createClipboardMetaDataProcessor(){return{preSetProcess:this.setMetaDataVersionItem.bind(this),postGetProcess:this.validateMetaDataVersionItem.bind(this)}}getRegExStringValue(e,t){const r=new RegExp(t,"g").exec(e);if(r&&r.length&&r.length>1)return r[1]}getRegExIntValue(e,t){const r=this.getRegExStringValue(e,t);if(r){const e=Number(r);return isNaN(e)?void 0:e}}constructor(t,r,a){this.ttlInMs=r,this.blockMismatchDataVersion=a,t?this.userHash=e.Wp.calcHashCode(t):(this.userHash=1565411791,i().ULS.traceTag(595903939,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,"userId not exist!. Use default ID"))}}class sr extends st{init(t){var r,a;return this.deferredResultMessagePromiseCache=new at,this.sender=(r=this.serializer,new mt(r,this)),this.receiver=(a=this.deserializer,new pt(a,this,this)),this.postInitMessage(t).catch((t=>(i().ULS.traceTag(596129250,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Init failure or timeout. Error: ${e.Wp.getStringifiedError(t)}`),u(t,c.IframeInitializationTimeout)?Promise.reject(t):Promise.reject(new L(c.IframeInitialization,"failed to init the Shared Clipboard",t)))))}registerPushMessageListener(e,t){this.pushMessageListeners[e]=t}postInitMessage(t){const r=He(it,"init",Ve.initIframe);if(!this.deferredResultMessagePromiseCache){const t="RPC Client - postInitMessage: this.deferredResultMessagePromiseCache should be defined";return i().ULS.shipAssertTag(596121487,e.nh.msoulscat_ES_EWAJS,!1,t),Promise.reject(new E(t))}const a=this.postMessage(r),o=this.deferredResultMessagePromiseCache.getDeferredPromise(r.id),n=Date.now();return setTimeout((()=>{if(o&&!o.fulfilled()){const t=Date.now(),r=`initialization started on ${new Date(n)} and timed out on ${new Date(t)} after ${t-n} ms`;i().ULS.traceTag(596129251,e.nh.msoulscat_ES_EWAJS,e.kp.Info,r),o.reject(new L(c.IframeInitializationTimeout,r))}}),t),a}postMessage(t){try{if(!t)throw new y(o,"outgoingMessage");if(i().ULS.shipAssertTag(596452175,e.nh.msoulscat_ES_EWAJS,!!t.id,"postMessage: outgoingMessage.id must be defined"),super.postMessage(t),!this.deferredResultMessagePromiseCache){const t="RPC Client - postMessage: this.deferredResultMessagePromiseCache should be defined";throw i().ULS.shipAssertTag(596121488,e.nh.msoulscat_ES_EWAJS,!1,t),new E(t)}return this.deferredResultMessagePromiseCache.addNewPromise(t.id).promise}catch(e){return Promise.reject(new E(`Unable to post message for operation '${t?t.operationCode:void 0}'`,e))}}handleMessage(t){i().ULS.traceTag(596452376,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`RPC Client - handleMessage: incomingMessage.id='${t&&t.id}'; incomingMessage.operationCode='${t&&t.operationCode}'; incomingMessage.failed='${t&&t.failed}'; incomingMessage.error='${t&&t.error}'; incomingMessage.clipboardItems.length=${re(t&&t.clipboardItemsData)}`);const r=this.pushMessageListeners[t.operationCode];if(r)return r(t.clipboardItemsData),Promise.resolve();if(!this.deferredResultMessagePromiseCache){const t="RPC Client - handleMessage: this.deferredResultMessagePromiseCache should be defined";return i().ULS.shipAssertTag(596121489,e.nh.msoulscat_ES_EWAJS,!1,t),Promise.reject(new E(t))}const a="initresult"===t.operationCode?it:t.id,o=this.deferredResultMessagePromiseCache.getDeferredPromise(a);return o?(this.deferredResultMessagePromiseCache.delete(a),t.failed?o.reject(t.error):o.resolve(t),Promise.resolve()):(i().ULS.traceTag(596452377,e.nh.msoulscat_ES_EWAJS,e.kp.Info,a===t.id?`RPC Client - handleMessage: no deferred promise with id '${t.id}'; dropping this result.`:`RPC Client - handleMessage: no deferred promise with id '${a}' for message id '${t.id}'; dropping this result.`),Promise.resolve())}handleDeserializationError(t){return!t||"NoValidKeyError"!==t.errorName||this.deferredResultMessagePromiseCache&&0!==this.deferredResultMessagePromiseCache.getLength()?(i().ULS.traceTag(596452379,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`RPC Client - handleDeserializationError. There are ${this.deferredResultMessagePromiseCache?this.deferredResultMessagePromiseCache.getLength():0} deferred promise(s) in the cache. Error: ${e.Wp.getStringifiedError(t)}`),Promise.resolve()):(i().ULS.traceTag(542687372,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`RPC Client - handleDeserializationError. Error: ${e.Wp.getStringifiedError(t)}`),Promise.resolve())}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(x([()=>{this.deferredResultMessagePromiseCache&&this.deferredResultMessagePromiseCache.clear()}]),super.dispose())}constructor(e,t,r){super(e,t,r,"WindowRPCClientInternal"),this.pushMessageListeners={}}}const lr=[],cr="load",dr="clipboard",pr="clipboard/shared.aspx",mr="corrid",ur={initialized:!1,origin:o,src:o,deferredPromise:void 0};let gr,hr;function fr(){return ur}function Sr(){if(gr){try{gr()}catch{}gr=void 0}}function br(t){return hr||(hr=fr()),hr.initialized||(hr.origin=function(t){Ne();const r=Re(t);let a=r.split(Ie);if(!a||2!==a.length||!a[0]||!a[1])throw new C("Invalid origin","parentOrigin",t);const n=_e();let s=o;if(n.whitelistOriginComponents){const e=a[0]+Ie;if(a=a[1].split(Le),!a||a.length<2||!a[0])throw new C("Invalid origin","parentOrigin",t);a.splice(0,1,n.sharedClipboardHostingApp),s=e+a.join(Le)}else s=r;return i().ULS.traceTag(596452424,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`getSharedClipboardValidatedOrigin: app's origin = '${t}'; Shared Clipboard iframe origin = '${s}' components=${JSON.stringify(a)}`),s}(t),hr.src=function(t){const r=fr().origin;let a=r;"/"!==r.charAt(r.length-1)&&(a+="/"),a+=pr,t&&(a+=`?${encodeURIComponent(ot)}=${encodeURIComponent(t)}`);const o=[];lr.forEach((e=>{(0,Ht.isChangeGateEnabled)(e)||o.push({key:e,value:"1"})}));const n=function(){if(!zt)throw new E("ClipboardPlatformSettings is not ready. Call ClipboardPlatformEnvironment.init(...).");return zt}();n&&(n.sessionId&&o.push({key:fe,value:n.sessionId}),n.bulsEndpointUrl&&o.push({key:he,value:n.bulsEndpointUrl}));const[s,l]=(0,e.kA)();return i().ULS.traceTag(595722560,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`getValidatedIframeSrc.getValidatedIframeSrc: Generate correlation if for loading the shared clipboard frame. CorrelationId: ${s} newGuidLogging: ${l}`),o.push({key:mr,value:s}),o.push({key:"NoAuth",value:"true"}),o.length>0&&o.forEach((e=>{a+=a.indexOf("?")>=0?"&":"?",a+=`${encodeURIComponent(e.key)}=${encodeURIComponent(e.value)}`})),a}(t),hr.initialized=!0),hr.origin}function yr(){if(!hr)return Promise.reject("state in undefined, please make sure to call initialize first");let t=function(){if(!fr().initialized)throw new E("getIframe: the initialize function should be called beforehand");const t=document.getElementsByTagName("iframe");if(t&&0!==t.length){i().ULS.traceTag(595952723,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`getIframe: found ${t.length} iframes`);for(let e=0;e<t.length;e+=1){const r=t[e];if(r&&r.id&&r.id===dr)return r}i().ULS.traceTag(595952724,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"getIframe: the CCP iframe does not exist")}else i().ULS.traceTag(595952722,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"getIframe: found no iframes")}();t&&(i().ULS.traceTag(596448770,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`ensureIframeWindow: The CCP iframe exists. Removing the iframe and re-adding it. iframe.src ${void 0!==t.src&&void 0!==hr.src&&t.src.toLowerCase()===hr.src.toLowerCase()?"===":"!=="} src; deferredPromise ${void 0===hr.deferredPromise?"does not exist":"exists"}; The iframe's content window ${void 0===t.contentWindow?"does not exist":"exists"}.`),function(t){if(!t)throw new y(o,"iframe");i().ULS.traceTag(595952725,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,"removeIframe: removing the CCP iframe"),Sr(),t.parentNode&&t.parentNode.removeChild(t)}(t),t=void 0);let r=hr.deferredPromise,a=r?r.id:o;if(r){Sr(),hr.deferredPromise=void 0;const t=`ensureIframeWindow: the CCP iframe does not exist and the deferred promise of its content window should not exist as well. Rejecting deferred promise id '${a}' and creating a new one`;i().ULS.shipAssertTag(596453587,e.nh.msoulscat_ES_EWAJS,!1,t),r.reject(new E(t)),r=void 0}hr.deferredPromise=Xe(Je()),r=hr.deferredPromise,a=r.id;try{t=function(){const t=document.createElement("iframe");return t.style.display="none",t.id=dr,i().ULS.shipAssertTag(595952726,e.nh.msoulscat_ES_EWAJS,!gr,"createIframe: the last shared clipboard iframe's onload event listener should have been removed. Removing it and registering a new event listener."),Sr(),gr=B(t,cr,(t=>function(t){i().ULS.traceTag(595952727,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"CCP iframe onload event: Entering"),Sr();const r=fr().deferredPromise;if(!r)return void i().ULS.shipAssertTag(595952728,e.nh.msoulscat_ES_EWAJS,!1,"CCP iframe onload event: the CCP iframe does not have a matching deferred promise to notify subscribers when the iframe loaded");const a=r.id;try{fr().deferredPromise=void 0;const o=t.target;if(!o){const t=`CCP iframe onload event: the CCP iframe should exist when its onload event is called. Rejecting deferred promise id '${a}'`;return i().ULS.shipAssertTag(595952729,e.nh.msoulscat_ES_EWAJS,!1,t),void r.reject(new E(t))}if(!o.contentWindow){const t=`CCP iframe onload event: the contentWindow of the CCP iframe does not exist. Rejecting deferred promise id '${a}'`;return i().ULS.shipAssertTag(595952730,e.nh.msoulscat_ES_EWAJS,!1,t),void r.reject(new E(t))}i().ULS.traceTag(595952732,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`CCP iframe onload event: resolving deferred promise id '${a}' with the iframe`),r.resolve(o)}catch(t){const o=`iframeOnLoad: an error has occurred: [${e.Wp.getStringifiedError(t)}]. Rejecting deferred promise id '${a}'`;i().ULS.traceTag(595952733,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,o),r.reject(new E(o,t))}}(t))),t.src=fr().src,t}(),document.getElementsByTagName("body")[0].appendChild(t)}catch(t){const r=`ensureIframeWindow: unable to create and/or add a CCP iframe. Dropping tentative deferred promise id '${a}'`;return i().ULS.traceTag(596453588,e.nh.msoulscat_ES_EWAJS,e.kp.Error,r),hr.deferredPromise=void 0,Sr(),Promise.reject(new E(r,t))}return r&&!r.fulfilled()?r.promise:(Sr(),t.contentWindow?(hr.deferredPromise=void 0,Promise.resolve(t)):(i().ULS.shipAssertTag(596453589,e.nh.msoulscat_ES_EWAJS,!1,`ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '${a}'`),Promise.reject(new E(`ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '${a}'`))))}let Cr,Er;function wr(){if(Er)return Er.promise;Er=Xe(Je());try{const t=br(Te().origin);Cr=function(t,r){return new sr(function(t){if(!t)throw new y(o,"validator");return{serialize:r=>function(t,r){if(!t)throw new y(o,"outgoingMessage");if(!r)throw new y(o,"validator");return r(t),function(t){let r;try{r=JSON.stringify(t)}catch(e){throw new C("Serialization failed","outgoingMessage",`${Object.keys(t).length} properties`,e)}return i().ULS.traceTag(596452375,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`The length of the serialized message is ${r.length}`),r}(t)}(r,t)}}(Be),function(e){if(!e)throw new y(o,"validator");return{deserialize:t=>function(e,t){if(!e)throw new y(o,"incomingMessage");if(!t)throw new y(o,"validator");if(0===e.length)throw new C("An empty message is invalid","incomingMessage");const r=e.trim();if(0===r.length)throw new C("A message cannot contain only spaces","incomingMessage");let a;try{a=JSON.parse(r)}catch(t){throw new C("Deserialization failed","incomingMessage",`Contains ${e.length.toString()} characters`,t)}if(!a)throw new C("Deserialization returned nothing","incomingMessage");return t(a),a}(t,e)}}(Ke),{window:void 0,windowOrigin:t})}(t),e.Wp.retry(((t,r)=>function(t,r){if(!Cr){const t="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";return i().ULS.shipAssertTag(595947544,e.nh.msoulscat_ES_EWAJS,!1,t),Promise.reject(new E(t))}const a=e.TZ.start(`Iframe_initialize_${t}`);e.TZ.mark(a,"start"),Cr.remoteWindow.window=void 0;const n=n=>{const s=u(n,c.IframeInitializationTimeout)?` due to a timeout of approx. ${r} ms`:o;e.TZ.mark(a,"finish_error"),e.TZ.failure(a,(t=>i().ULS.traceTag(596452419,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,t)),`Attempt #${t} failed to initialize an iframe ${s}. ${t<3?"Retrying...":"No more retries!"}. Error: ${e.Wp.getStringifiedError(n)}`)},s=Xe();return yr().then((o=>{if(e.TZ.mark(a,"iframe_loaded"),e.TZ.mark(a,"iframe_waiting_for_idb_init"),!Cr){const t="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";i().ULS.shipAssertTag(595947545,e.nh.msoulscat_ES_EWAJS,!1,t);const r=new E(t);return n(r),Promise.reject(r)}if(!o.contentWindow){const t="clipboardIframeLoader::initializeIframe - remoteWindow.contentWindow should be defined";i().ULS.shipAssertTag(595903557,e.nh.msoulscat_ES_EWAJS,!1,t);const r=new E(t);return n(r),Promise.reject(r)}return Cr.remoteWindow.window=o.contentWindow,Cr.init(r).then((()=>(e.TZ.mark(a,"iframe_idb_init_complete"),e.TZ.mark(a,"finish"),e.TZ.success(a,(t=>i().ULS.traceTag(596452418,e.nh.msoulscat_ES_EWAJS,e.kp.Info,t)),`Attempt #${t} initialized iframe`),Promise.resolve())))})).then((()=>{s.resolve()}),(e=>{n(e),s.reject(e)})),s.promise}(t,2e4+(u(r,c.IframeInitializationTimeout)?5e3:0)*(t-1))),3).then((()=>{Er.resolve(Cr)}),(e=>{Er.reject(e)}))}catch(e){Er.reject(e)}return Er.promise}class _r{innerInitialize(){return wr().then((e=>(this.initialized=!0,this.windowRPCClient=e,this)))}registerPushMessageListener(e,t){this.windowRPCClient&&this.windowRPCClient.registerPushMessageListener(e,t)}postMessage(t,r){if(!this.initialized)return Promise.reject(new L(c.IframeInitialization));const a=e.TZ.start(`BaseIframeProxy_${r}`);e.TZ.mark(a,"start");const o=t=>(e.TZ.mark(a,"finish_error"),e.TZ.failure(a,(t=>i().ULS.traceTag(596452188,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,t)),`Failed in BaseIframeProxy.postMessage. Error: ${e.Wp.getStringifiedError(t)}`),Promise.reject(new L(c.IframeProxyGeneralError,"Failed in BaseIframeProxy.postMessage",t)));if(!this.windowRPCClient){const t="BaseIframeProxy.postMessage - this.windowRPCClient should be defined";return i().ULS.shipAssertTag(595944461,e.nh.msoulscat_ES_EWAJS,!1,t),o(new E(t))}return this.windowRPCClient.postMessage(t).then((t=>(i().ULS.shipAssertTag(595944462,e.nh.msoulscat_ES_EWAJS,!!t,"BaseIframeProxy.postMessage: postMessage must have returned a result message"),t?t.failed?Promise.reject(new L(c.IframeProxyGeneralError,`BaseIframeProxy.postMessage: the operation failed. Error: ${t.error}`)):(e.TZ.mark(a,"finish"),e.TZ.success(a,(t=>i().ULS.traceTag(596452187,e.nh.msoulscat_ES_EWAJS,e.kp.Info,t))),Promise.resolve(t)):Promise.reject(new L(c.IframeProxyEmptyResultMessage,"BaseIframeProxy.postMessage: postMessage succeeded but returned nothing"))))).catch((e=>o(e)))}constructor(){this.initialized=!1}}class vr{initialize(e){return new _t(this.localStorageKey,e,(e=>{this._onMetadataChangedListener&&this._onMetadataChangedListener(e)})),Promise.resolve()}setOnMetadataChangedListener(t){i().ULS.traceTag(595716297,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),i().ULS.shipAssertTag(595716298,e.nh.msoulscat_ES_EWAJS,!!t,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=t}constructor(e){this.localStorageKey=e}}class Tr extends _r{initialize(e){return super.innerInitialize().then((()=>{this.registerPushMessageListener("getMetadata_longPollingresult",(e=>{this._onMetadataChangedListener&&this._onMetadataChangedListener(ie(e))}))}))}setOnMetadataChangedListener(t){i().ULS.traceTag(595730647,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"LongPollingMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),i().ULS.shipAssertTag(595944466,e.nh.msoulscat_ES_EWAJS,!!t,"LongPollingMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=t}}class Ir extends qe{constructor(e){super(s.SystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},e)}}let Ar=!0;function Pr(){return Ar}function Lr(){Ar=!1}let xr=!0;function Dr(){return xr}function Mr(){xr=!1}function kr(){let t;try{t=window.clipboardData}catch(t){i().ULS.traceTag(595985225,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`ieSystemClipboard.getDataTransfer: An error occurred when attempting to access window.clipboardData. Error: ${e.Wp.getStringifiedError(t)}`)}return t}function $r(){if(i().ULS.shipAssertTag(596455701,e.nh.msoulscat_ES_EWAJS,U(),"The browser must be IE"),!U())throw new E("The browser must be IE")}function Wr(e){return!!e}function Rr(t){if(!t)return void i().ULS.traceTag(596456320,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"A clipboard event parameter is missing");let r;try{r=t.clipboardData}catch(t){throw i().ULS.traceTag(595985224,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`systemClipboard.getDataTransfer: An error occurred when attempting to access rawEvent.clipboardData. Error: ${e.Wp.getStringifiedError(t)}`),t}return r}function Or(t,r,a,o){let n=!1;try{const o=Rr(a);if(!o||!Wr(o))return i().ULS.traceTag(596456264,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`setData - programmatic ${j} and ${J} is broken. There is no valid data transfer object. clipboardDataFormat = '${t}'`),!1;n=o.setData(t,r),!1===n&&i().ULS.traceTag(596456265,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`setData returned false for '${t}'.`)}catch(r){i().ULS.traceTag(596456266,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`setData with '${t}' threw an exception: ${e.Wp.getStringifiedError(r)}`)}return void 0===n&&(n=!0),n}function Ur(t,r,a,o){if($r(),!o&&!Pr()&&!Dr())return i().ULS.traceTag(596456269,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`setData - programmatic ${j} and ${J} clipboard access is not supported. rawEvent is empty = ${!!a}`),!1;const n=kr();if(!n||!Wr(n))return i().ULS.traceTag(596456270,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`setData - ${j} and ${J} is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '${t}'`),o||(i().ULS.shipAssertTag(596456271,e.nh.msoulscat_ES_EWAJS,Pr()&&Dr(),`setData - programmatic ${j} and ${J} is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '${Pr()}'. isProgrammaticAccessSupported = '${Dr()}'. clipboardDataFormat = '${t}'`),Lr(),Mr()),!1;let s,l=t;l===G&&(l=K);try{s=n.setData(l,r),!1===s&&i().ULS.traceTag(596456272,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`setData returned false for '${l}'.`)}catch(t){i().ULS.traceTag(596456273,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`setData with '${l}' threw an exception: ${t.message}`)}return!o&&Pr()&&(Lr(),!1===s&&Mr()),void 0===s&&(s=!0),s}function Fr(){return Pr()&&Ur(G,o,void 0,!1),!!Dr()||(i().ULS.traceTag(596456274,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`document.execCommand - programmatic clipboard access is not allowed for '${j}' and '${J}'.`),!1)}const Nr={execCommandCopy:function(){let t;try{t=document.execCommand(j,!1,null)}catch(t){i().ULS.traceTag(596456262,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`document.execCommand('${j}') threw an exception. This is a browser bug. Ignoring. Exception: ${t.message}`)}return void 0===t&&(t=!0),t},execCommandCut:function(){let t;try{t=document.execCommand(J,!1,null)}catch(t){i().ULS.traceTag(596456263,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`document.execCommand('${J}') threw an exception. This is a browser bug. Ignoring. Exception: ${t.message}`)}return void 0===t&&(t=!0),t},setData:Or,defaultClipboardDataFormat:G},jr={execCommandCopy:function(){if($r(),!Fr())return!1;try{document.execCommand(j,!1,null)}catch(t){i().ULS.traceTag(596456267,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`document.execCommand('${j}') threw an exception. This is a browser bug. Ignoring. Exception: ${t.message}`)}return!0},execCommandCut:function(){if($r(),!Fr())return!1;try{document.execCommand(J,!1,null)}catch(t){i().ULS.traceTag(596456268,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`document.execCommand('${J}') threw an exception. This is a browser bug. Ignoring. Exception: ${t.message}`)}return!0},setData:Ur,defaultClipboardDataFormat:K};let Jr;function zr(e,t,r,a){return Hr().setData(e,t,r,a)}function Hr(){return void 0===Jr&&(Jr=Nr),Jr}U()&&(Jr=jr);const Vr="command",Br="getClipboardData",Gr="getAvailableCommands";let Kr;const Zr={};function qr(){if(void 0===Kr&&(Kr=!1,"chrome"in window)){const t=window.chrome;t&&("runtime"in t&&t.runtime?"sendMessage"in t.runtime&&t.runtime.sendMessage?Kr=!0:i().ULS.traceTag(596455703,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,"chrome.runtime.sendMessage is not available"):i().ULS.traceTag(596455704,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"chrome.runtime is not available"))}return Kr}function Yr(t){if(!t||!t.items)return Promise.reject(new P(p.ClipboardIsInaccessible,`getImageDataUrlFromClipboardData: clipboardData is undefined=${!t} clipboardData.items is undefined=${!t.items}`));for(let r=0;r<t.items.length;r+=1){const a=t.items[r].type&&t.items[r].type.startsWith("image");if(a||i().ULS.traceTag(528859143,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"Non-image type read from System Clipboard. File Type is "+t.items[r].type),"file"===t.items[r].kind&&a)return Xr(t.items[r].getAsFile())}return Promise.resolve(o)}function Xr(t){const r=e.TZ.start("ImageFile_Read_From_Clipboard"),a=t?t.size:-1,o=Xe(),n=new FileReader;return n.onload=()=>{n.result?(e.TZ.success(r,(t=>i().ULS.traceTag(595911452,e.nh.msoulscat_ES_EWAJS,e.kp.Info,Qr(t,a)))),o.resolve(n.result.toString())):(e.TZ.failure(r,(t=>i().ULS.traceTag(595911453,e.nh.msoulscat_ES_EWAJS,e.kp.Info,Qr(t,a)))),o.reject(new P(p.FileReaderResultIsEmpty,"getImageDataUrlFromClipboardData: FileReader result is null or undefined")))},n.onerror=()=>{e.TZ.failure(r,(t=>i().ULS.traceTag(595911454,e.nh.msoulscat_ES_EWAJS,e.kp.Info,Qr(t,a)))),o.reject(new P(p.FileReaderFailed,"getImageDataUrlFromClipboardData: FileReader failed"))},e.TZ.mark(r,"Starting_readAsDataURL"),n.readAsDataURL(t),o.promise}function Qr(e,t){const r=JSON.parse(e);return r.filesize=t,JSON.stringify(r)}function ea(t,r,a){if($r(),!a&&!Pr()&&!Dr())return i().ULS.traceTag(596456327,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`getData - programmatic ${z} clipboard access is not supported. rawEvent is empty = ${!!r}`),Promise.resolve(o);const n=kr();if(!n||!Wr(n))return i().ULS.traceTag(596456328,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`getData - ${z} is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '${t}'`),a||(i().ULS.shipAssertTag(596456329,e.nh.msoulscat_ES_EWAJS,Pr()&&Dr(),`getData - programmatic ${z} is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '${Pr()}'. isProgrammaticAccessSupported = '${Dr()}'. clipboardDataFormat = '${t}'`),Lr(),Mr()),Promise.resolve(o);let s=t;s===G&&(s=K);let l=o;try{l=n.getData(s),l||(l=o),i().ULS.traceTag(596456330,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`getData('${s}') returned ${l.length} characters`)}catch(t){i().ULS.traceTag(596456331,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`getData with '${s}' threw an exception. This is a browser bug. Ignoring. Exception: ${t.message}`)}if(!a&&Pr()&&(Lr(),l===o)){if(Or(t," ",void 0))return ea(t,void 0,!1).then((e=>(e===o?Mr():Or(t,o,void 0),Promise.resolve(l))));Mr()}return Promise.resolve(l)}const ta={init:function(){},execCommandPaste:function(){let t;try{t=document.execCommand(z,!1,null)}catch(t){i().ULS.traceTag(596456322,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`document.execCommand('${z}') threw an exception. This is a browser bug. Ignoring. Exception: ${t.message}`)}return void 0===t&&(t=!0),t},getData:function(t,r,a){let n=o;try{const a=Rr(r);if(!a||!Wr(a))return Promise.resolve(n);if(t===q)return Yr(a);n=a.getData(t),n||(n=o),i().ULS.traceTag(596456323,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`getData('${t}') returned ${n.length} characters`)}catch(r){i().ULS.traceTag(596456324,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`getData with '${t}' threw an exception. This is a browser bug. Ignoring. Exception:: ${e.Wp.getStringifiedError(r)}`)}return Promise.resolve(n)},browserExtensionPaste:function(){return Promise.reject(new L(c.NoBrowserExtensionsInConfiguration))}},ra={init:function(){},execCommandPaste:function(){if($r(),Pr()&&ea(G,void 0,!1),!Dr())return i().ULS.traceTag(596456325,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`document.execCommand - programmatic clipboard '${z}' access is not allowed in this session.`),!1;try{document.execCommand(z,!1,null)}catch(t){i().ULS.traceTag(596456326,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`document.execCommand('${z}') threw an exception. This is a browser bug. Ignoring. Exception: ${t.message}`)}return!0},getData:ea,browserExtensionPaste:function(){return Promise.reject(new L(c.NoBrowserExtensionsInConfiguration))}},aa={init:function(){!function(){const t=Va().getChromeExtensionIds();if(0===t.length)return;const r={};r[Vr]=Gr,t.forEach((t=>{window.chrome.runtime.sendMessage(t,r,void 0,(r=>{const a=window.chrome.runtime.lastError;if(r&&Array.isArray(r)&&0!==r.length&&!a)Zr[t]=r;else{let r=o;a&&"message"in a&&"string"==typeof a.message&&(r=a.message),i().ULS.traceTag(589947074,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`chromeSystemClipboard - '${Gr}': browser extension '${t}' is not available. Error: ${r}`)}}))}))}()},execCommandPaste:function(){let t=!1;try{t=document.execCommand(z,!1,null),void 0===t&&(t=!0)}catch(t){i().ULS.traceTag(596455698,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Chrome: document.execCommand('${z}') threw an exception. This is a browser bug. Ignoring. Exception: ${t.message}`)}return t},getData:function(t,r,a){let n=o;try{const a=Rr(r);if(!a||!Wr(a))return Promise.resolve(n);if(t===q)return Yr(a);n=a.getData(t),n||(n=o),i().ULS.traceTag(596455699,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Chrome: getData('${t}') returned ${n.length} characters`)}catch(r){i().ULS.traceTag(596455700,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`Chrome: getData with '${t}' threw an exception. This is a browser bug. Ignoring. Exception:: ${e.Wp.getStringifiedError(r)}`)}return Promise.resolve(n)},browserExtensionPaste:function(){return function(){if(!qr())return Promise.reject(new L(c.MissingBrowserExtensionCapability));const t=function(){for(const e in Zr)if(Zr[e].includes(Br))return e;return null}();if(!t)return Promise.reject(new L(c.NoBrowserExtensionWithGetClipboardDataCommand));const r={};return r[Vr]="getClipboardData",function(t,r){return new Promise(((a,n)=>{let s=!0;window.chrome.runtime.sendMessage(t,r,void 0,(e=>{const r=window.chrome.runtime.lastError;if(!e||"object"!=typeof e||Array.isArray(e)||r){s=!1;let e=o;r&&"message"in r&&"string"==typeof r.message&&(e=r.message),n(new L(c.UnavailableBrowserExtension,`chromeSystemClipboard - '${Br}': browser extension '${t}' is not available. Error: ${e}`))}else{s=!1;const t=e,r=t.html,i=t.img,o=t.text,n=function(e,t,r){const a=!!e,i=!!t,o=!!r,n=e.includes("<img src=");return i&&!o||i&&a&&n}(r,i,o);a({text:o,html:n?i:r})}})),setTimeout((()=>{s&&(i().ULS.traceTag(589947076,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`chromeSystemClipboard - getPasteWithExtensionPromise reject the promise after timeout. chromeExtenstionsInfo: '${Zr}'`),n(new L(c.UnavailableBrowserExtension,`chromeSystemClipboard - '${Br}': browser extension '${t}' is not available. Timeout after : 2000 ms`)))}),2e3)}))}(t,r).then((r=>{if(!r)return Promise.reject(new L(c.NoAvailableBrowserExtensions));i().ULS.traceTag(589947075,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`chromeSystemClipboard - paste by browser extension '${t}'`);const a=ie();return a.setItem(G,r.text),a.setItem(Z,r.html),a.setItem("metadata/chrome-extension-id",t),a}))}()}};let ia;function oa(){return void 0===ia&&(ia=qr()?aa:ta),ia}U()&&(ia=ra);var na=r(8805);const sa=(e,t)=>{if(ca(e))e.replaceChildren(t);else{for(;e.firstChild;)e.removeChild(e.firstChild);la(e,t)}},la=(e,t)=>{if(da(e))e.append(t);else if("string"==typeof t){const r=document.createTextNode(t);e.appendChild(r)}else e.appendChild(t)},ca=e=>!!e.replaceChildren,da=e=>!!e.append,pa="ccpContentEditable";function ma(){const e=document.getSelection();if(e&&e.getRangeAt&&"function"==typeof e.getRangeAt&&!(e.rangeCount<1))return e.getRangeAt(0)}function ua(t,r,a=void 0){i().ULS.shipAssertTag(596444114,e.nh.msoulscat_ES_EWAJS,!1===r&&!a||!0===r&&(!!a||a===o),`enableClipboardEvents: useTextHtmlContentCandidate = '${r}', textHtmlContentCandidate is ${a||a===o?o:"not "}provided`);let n=document.activeElement&&document.activeElement.id;n||i().ULS.traceTag(595719625,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,"hiddenContentEditableDiv.enableClipboardEvents: activeElementIdToRestore must to be define");const s=function(t,r){let a=fa();if(a&&a.tagName&&"div"!==a.tagName.toLowerCase()&&(a.parentElement&&a.parentElement.removeChild(a),a=void 0),a||(a=function(){const t=document.createElement("div");return function(t){t.id=pa,t.contentEditable="true",ya()&&(t.contentEditable="false"),t.spellcheck=!1,t.setAttribute("autocomplete","off"),t.setAttribute("autocorrect","off"),t.setAttribute("autocapitalize","off"),t.setAttribute("aria-hidden","true"),t.tabIndex=-1,t.style.display="inline-block",t.style.position="absolute",t.style.fontSize="10",t.style.height="0px",t.style.width="0px",t.style.top="0px",t.style.left="0px",t.style.zIndex="-100",t.style.overflow="hidden",t.onmousemove=()=>{t.onmousemove=null,i().ULS.assertTag(595957699,e.nh.msoulscat_ES_EWAJS,!1,`contentEditableElement.onmousemove: Mouse move event is not expected on element '${pa}'. it should be covered by other elements`)}}(t),document.body.appendChild(t),t}()),U()){let e=r;t?e||(e=o):e=ba().outerHTML,a.innerHTML=na.sanitize(e)}else sa(a,t?r??o:ba());return a}(r,a);n&&n===s.id&&(n=void 0),s.focus();const l=document.getSelection();if(l){l.removeAllRanges();const e=document.createRange();e.selectNodeContents(s),l.addRange(e)}return t&&ga(!0),n}function ga(e){if(!ya())return;const t=fa();t&&(t.contentEditable=e?"true":"false")}function ha(){const t=fa();if(!t)return!1;try{const e=t.clientLeft+t.scrollWidth/2,r=t.clientTop+t.scrollTop/2,a=document.elementFromPoint(e,r);return!!a&&(a.id===t.id||!!a.parentElement&&a.parentElement.id===t.id)}catch(t){return i().ULS.traceTag(595957534,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`isContentEditableElementVisibleToUser: hit test failed with error: ${e.Wp.getStringifiedError(t)}`),!1}}function fa(){return document.getElementById(pa)}function Sa(){const e=fa();e&&(U()?e.innerHTML=na.sanitize(ba().outerHTML):sa(e,ba()))}function ba(){const e=document.createElement("span");return e.innerText=n,e}function ya(){return!U()}class Ca{get(t){if(this.disposableImplementationExtension.throwIfDisposed("get"),i().ULS.traceTag(596449096,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`SystemClipboardStorage.get: isKeyboardEvent = '${t.isKeyboardEvent}'`),t.skipSystemClipboardAccess){i().ULS.traceTag(596124883,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"SystemClipboardStorage.get: Skipping system clipboard access");const t=B(document,V,(e=>this.skipSystemClipboardPasteHandler(e,t)),!0);return this.removeLastPasteEventListenerCallback=t,Promise.resolve(te())}if(this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()){const t=this.lastDeferredPastePromise,r=`There exists a pending deferred promise with id '${t.id}', representing an active ${z} event. Scheduling a rejection to execute after the current operation.`;i().ULS.traceTag(596455680,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,r),window.setTimeout((()=>{t.reject(new L(c.RejectingPendingPastePromiseDueToNewPasteOperation,r))}),0)}this.clearPasteCallbackConfiguration(this.lastDeferredPastePromise,!0,!1);const r=Xe();this.lastDeferredPastePromise=r;const a=r.id,o=B(document,V,(e=>this.pasteHandler(e,r,t.isKeyboardEvent,o)),!0);this.removeLastPasteEventListenerCallback=o,this.selectedRangeToRestore=ma(),this.activeElementIdToRestore=ua(!0,!1);try{let e=!1;if(t.isKeyboardEvent||(e=oa().execCommandPaste()),t.isKeyboardEvent);else if(!e)return this.clearPasteCallbackConfiguration(r,!0,!0),t.isAsyncSystemClipboardEnabled?Promise.reject(new L(c.ClipboardIsInaccessible,`Reject the Promise if not keyboard event in SystemClipboardStorage.get. Deferred promise id = '${a}'`)):oa().browserExtensionPaste().then((e=>(t.isChromiumExtension=!0,t.clearSystemClipboard&&this.clearSystemClipboard(),e)),(e=>(!t.isAsyncSystemClipboardEnabled&&t.clearSystemClipboard&&this.clearSystemClipboard(),Promise.reject(new L(c.ClipboardIsInaccessible,`document.execCommand(${z}) failed in SystemClipboard.get. Deferred promise id = '${a}'`,e)))))}catch(e){return this.clearPasteCallbackConfiguration(r,!0,!1),Promise.reject(new L(c.GetClipboardItems,`Failed in SystemClipboard.get. Deferred promise id = '${a}'`,e))}return r.promise.then((e=>(t.clearSystemClipboard&&this.clearSystemClipboard(),e)),(e=>(t.clearSystemClipboard&&this.clearSystemClipboard(),u(e,c.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(e):Promise.reject(new L(c.GetClipboardItems,`Failed in SystemClipboard.get. Deferred promise id = '${a}'`,e)))))}set(t,r){if(this.disposableImplementationExtension.throwIfDisposed("set"),i().ULS.traceTag(596449097,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`SystemClipboardStorage.set: isKeyboardEvent = '${r.isKeyboardEvent}'; cutCopyPasteFlags = '${r.commandType}'`),i().ULS.shipAssertTag(595932513,e.nh.msoulscat_ES_EWAJS,!r.skipSystemClipboardAccess,"SystemClipboardStorage.set: skipSystemClipboardAccess shouldn't be used using set of SystemClipboardStorage as we have to set the timestamp metadata in the html in order to support last copy item scenario. "),U()&&!r.isKeyboardEvent){if(r.silentClipboardAccessFailures&&Pr())return i().ULS.traceTag(596455681,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"Aborting attempt to store content in the clipboard since silentClipboardAccessFailures is on and the user did not select Allow access in IE's clipboard access dialog"),Promise.resolve();if(!Pr()&&!Dr())return i().ULS.traceTag(596455682,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection."),Promise.resolve()}if(this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()){const t=this.lastDeferredCutCopyPromise,a=`There exists a pending deferred promise with id '${t.id}', representing an active ${J}/${j} event. Scheduling a rejection to execute after the current operation.`;i().ULS.traceTag(596455683,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,a),window.setTimeout((()=>{t.reject(new L(r.isKeyboardEvent?c.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation:c.RejectingBlockedSyncCutCopyPromise,a))}),0)}this.clearCutCopyCallbackConfiguration(this.lastDeferredCutCopyPromise,!0,!1);const a=Xe();this.lastDeferredCutCopyPromise=a;const n=a.id;try{const s=ce(t),l=Ca.getClipboardCutCopyEventType(r.commandType),c=B(document,l,(e=>{r.isTimestampStoredInSystemClipboard=!0,this.cutCopyHandler(e,a,s,r.isKeyboardEvent,r.commandType,c)}));this.removeLastCutCopyEventListenerCallback=c;let d=o;U()&&(d=se(s,Z)),this.selectedRangeToRestore=ma(),this.activeElementIdToRestore=ua(!1,!!d,d);let p=!1;if(U()&&r.isKeyboardEvent||(p=r.commandType===ue.Cut?Hr().execCommandCut():Hr().execCommandCopy()),r.isKeyboardEvent);else if(!p)return this.clearCutCopyCallbackConfiguration(a,!0,!0),!U()||Pr()||Dr()||(i().ULS.traceTag(596455684,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection. Deferred promise id = '${n}'`),a.resolve()),Promise.resolve()}catch(e){return this.clearCutCopyCallbackConfiguration(a,!0,!1),Promise.reject(new L(c.SetClipboardItems,`Failed in SystemClipboard.set. Deferred promise id = '${n}'`,e))}return a.promise.catch((e=>e&&g(e,[c.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,c.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.reject(new L(c.SetClipboardItems,`Failed in SystemClipboard.set. Deferred promise id = '${n}'`,e))))}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[G,Z,q]}cutCopyHandler(t,r,a,n,s,l){try{if(i().ULS.traceTag(596449098,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '${n}'; cutCopyPasteFlags = '${s}'; bubbles = '${t.bubbles}'; eventPhase = '${t.eventPhase}'`),l(),this.removeLastCutCopyEventListenerCallback===l&&(this.removeLastCutCopyEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("cutCopyHandler"))return;if(i().ULS.shipAssertTag(596455686,e.nh.msoulscat_ES_EWAJS,!!r,`SystemClipboardStorage.cutCopyHandler: the deferred promise parameter is missing. isKeyboardEvent = '${n}'; cutCopyPasteFlags = '${s}'`),!r)return;if(i().ULS.traceTag(596455687,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '${n}'; cutCopyPasteFlags = '${s}'; deferred promise id = '${r.id}'`),i().ULS.shipAssertTag(596455688,e.nh.msoulscat_ES_EWAJS,!r.fulfilled(),`SystemClipboardStorage.cutCopyHandler: deferred promise '${r.id}' is already fulfilled. isKeyboardEvent = '${n}'; cutCopyPasteFlags = '${s}'`),r.fulfilled())return;const o=()=>{r.resolve(),this.clearCutCopyCallbackConfiguration(r,!1,!1)},c=se(a,Z);if(c&&U())window.setTimeout(o,0);else{c&&zr(Z,c,t,n);const e=le(a);zr(Hr().defaultClipboardDataFormat,e,t,n),t.preventDefault(),o()}}catch(t){this.clearCutCopyCallbackConfiguration(r,!1,!1),i().ULS.traceTag(596455689,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`SystemClipboardStorage.cutCopyHandler callback with deferred promise id '${r?r.id:o}' (fulfilled = '${r?r.fulfilled():o}') failed with this exception: ${t&&t.message?t.message:"NA"}. Call stack: ${t.stack?t.stack:"NA"}`),r&&r.reject(new L(c.SetClipboardItems,`Failed in SystemClipboard.set > cutCopyHandler callback. Deferred promise id = '${r.id}'. Error: ${t&&t.message?t.message:"NA"}`,t))}}pasteHandler(t,r,a,n){let s=!0;try{if(i().ULS.traceTag(596449099,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`SystemClipboardStorage.pasteHandler: isKeyboardEvent = '${a}'; eventPhase='${t.eventPhase}'`),t.preventDefault(),n(),this.removeLastPasteEventListenerCallback===n&&(this.removeLastPasteEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("pasteHandler"))return;if(i().ULS.shipAssertTag(596455690,e.nh.msoulscat_ES_EWAJS,!!r,`SystemClipboardStorage.pasteHandler: the deferred promise parameter is missing. isKeyboardEvent = '${a}'`),!r)return;if(i().ULS.traceTag(596455691,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`SystemClipboardStorage.pasteHandler: isKeyboardEvent = '${a}'; deferred promise id = '${r.id}'`),i().ULS.shipAssertTag(596455692,e.nh.msoulscat_ES_EWAJS,!r.fulfilled(),`SystemClipboardStorage.pasteHandler: deferred promise '${r.id}' is already fulfilled. isKeyboardEvent = '${a}'`),r.fulfilled())return;const l=ie(),c=this.getSupportedDataFormats(),d=this.readDataFormats(c,t,a,l);Promise.all(d).then((()=>{t.stopPropagation(),s=!1,U()?window.setTimeout((()=>{const t=document.getElementById(pa);if(t&&t.firstChild&&"IMG"===t.firstChild.nodeName){const r=t.firstChild;r&&r.src&&r.src.indexOf("base64")>-1?l.setItem(q,r.src):i().ULS.traceTag(595907107,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"SystemClipboardStorage.pasteHandler: IE has provided the IMG HTML rather than the image blob, which is unsupported.")}else l.setItem(Z,function(){const t=fa();return i().ULS.shipAssertTag(596444113,e.nh.msoulscat_ES_EWAJS,!!t,"getTextHtmlContent: the content editable element does not exist"),t?na.sanitize(t.innerHTML):o}()),(a=t)&&a.firstChild&&a.firstElementChild&&a.firstElementChild.getAttribute(Ot)&&l.setItem(G,function(e){const t=[],r=e.getElementsByTagName("tr");if(r.length>0){const e=jt(r[0]);t.push(e);for(let e=1;e<r.length;e+=1){t.push(Tt),t.push(vt);const a=jt(r[e]);t.push(a)}}return t.join("")}(t));var a;Sa(),r.resolve(l),this.clearPasteCallbackConfiguration(r,!1,!1)}),0):(Sa(),r.resolve(l),this.clearPasteCallbackConfiguration(r,!1,!1))}))}catch(a){Sa();try{s&&t.stopPropagation()}catch(t){i().ULS.traceTag(595985030,e.nh.msoulscat_ES_EWAJS,e.kp.Error,`SystemClipboardStorage.pasteHandler: failed when performing stopPropagation/preventDefault on the raw event. Failed with an exception: ${e.Wp.getStringifiedError(t)}`)}this.clearPasteCallbackConfiguration(r,!1,!1),i().ULS.traceTag(596455693,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`SystemClipboardStorage.pasteHandler callback with deferred promise id '${r?r.id:o}' (fulfilled = '${r?r.fulfilled():o}') failed with an exception: ${a&&a.message?a.message:"NA"}. Call stack: ${a.stack?a.stack:"NA"}`),r&&r.reject(new L(c.GetClipboardItems,`Failed in SystemClipboard.get > pasteHandler callback. Deferred promise id = '${r.id}'. Error: ${a&&a.message?a.message:"NA"}`,a))}}isFileFormat(e){return e===q}isPlainTextEmpty(e){const t=e.getItem("text/plain");return!t||0===t.length}readDataFormats(t,r,a,o){if(!this.skipFilesIfPlainTextExists||!a&&function(){const e=D();let t=!1;if(e&&e.userAgent){const r=e.userAgent();r&&r.indexOf("Edg/")>=0&&(t=!0)}return t}())return this.readDataFormatsInternal(t,r,a,o);const n=t.filter((e=>this.isFileFormat(e)));if(0===n.length)return this.readDataFormatsInternal(t,r,a,o);const s=t.filter((e=>!this.isFileFormat(e))),l=this.readDataFormatsInternal(s,r,a,o);return[Promise.all(l).then((()=>{if(!this.isPlainTextEmpty(o))return i().ULS.traceTag(595653317,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"SystemClipboardStorage.readDataFormats: skip files loading because clipboard contains plain text"),Promise.resolve();const t=this.readDataFormatsInternal(n,r,a,o);return Promise.all(t)}))]}readDataFormatsInternal(t,r,a,o){const n=[];return t.forEach((t=>{n.push(function(e,t,r){return oa().getData(e,t,r)}(t,r,a).then((r=>{i().ULS.traceTag(541646989,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"SystemClipboardStorage.readDataFormatsInternal: Read "+t+" from clipboard"),o.setItem(t,r)})).catch((r=>{i().ULS.traceTag(595653318,e.nh.msoulscat_ES_EWAJS,e.kp.Error,`SystemClipboardStorage.readDataFormatsInternal: Failed to get data of type [${t}]. Error [${e.Wp.getStringifiedError(r)}]`)})))})),n}skipSystemClipboardPasteHandler(t,r){try{r(),t.stopPropagation(),t.preventDefault()}catch(t){i().ULS.traceTag(595993058,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`SystemClipboardStorage.skipSystemClipboardPasteHandler: failed with an exception: ${t&&t.message?t.message:"NA"}. Call stack: ${t.stack?t.stack:"NA"}`)}this.removeLastPasteEventListenerCallback===r&&(this.removeLastPasteEventListenerCallback=void 0)}hasPlainText(e){return!!e&&Object.keys(e.getData().items).indexOf(G)>-1}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(x([()=>{this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()&&(this.lastDeferredCutCopyPromise.reject(),this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback&&(this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0))},()=>{this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()&&(this.lastDeferredPastePromise.reject(),this.lastDeferredPastePromise=void 0,this.removeLastPasteEventListenerCallback&&(this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0))}]),this.disposableImplementationExtension.dispose())}static getClipboardCutCopyEventType(e){if(!e)return H;if(e===ue.Copy)return H;if(e===ue.Cut)return"cut";throw new C(o,"cutCopyPasteFlags",e.toString())}restoreFocusToPreviouslyActiveElement(){if(!this.activeElementIdToRestore)return;const e=document.getElementById(this.activeElementIdToRestore);e&&e.focus(),this.activeElementIdToRestore=void 0}restoreSelection(){this.selectedRangeToRestore&&(function(e){if(!e)return;const t=document.getSelection();t&&t.removeAllRanges&&"function"==typeof t.removeAllRanges&&t.addRange&&"function"==typeof t.addRange&&(t.removeAllRanges(),t.addRange(e))}(this.selectedRangeToRestore),this.selectedRangeToRestore=void 0)}clearCutCopyCallbackConfiguration(t,r,a){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),i().ULS.shipAssertTag(595957697,e.nh.msoulscat_ES_EWAJS,!ha(),"SystemClipboardStorage.set: ccpContentEditable is visible to the user during a copy/cut operation, but it should not be visible."),(t===this.lastDeferredCutCopyPromise||t&&this.lastDeferredCutCopyPromise&&t.id===this.lastDeferredCutCopyPromise.id)&&(this.lastDeferredCutCopyPromise=void 0),r&&this.removeLastCutCopyEventListenerCallback&&(a||i().ULS.traceTag(596449290,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`SystemClipboardStorage.set: the ${J}/${j} event listener was not called. Calling removeLastCutCopyEventListenerCallback()`),this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0)}clearPasteCallbackConfiguration(t,r,a){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),ga(!1),i().ULS.shipAssertTag(595957698,e.nh.msoulscat_ES_EWAJS,!ha(),"SystemClipboardStorage.clearPasteCallbackConfiguration: ccpContentEditable is visible to the user during a paste operation, but it should not be visible"),(t===this.lastDeferredPastePromise||t&&this.lastDeferredPastePromise&&t.id===this.lastDeferredPastePromise.id)&&(this.lastDeferredPastePromise=void 0),r&&this.removeLastPasteEventListenerCallback&&(a||i().ULS.traceTag(596449291,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`SystemClipboardStorage.get: the ${z} event listener was not called. Calling removeLastPasteEventListenerCallback()`),this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0)}clearSystemClipboard(){const t=te(),r={isKeyboardEvent:!1,commandType:ue.Copy};this.set(t,r).then((()=>{i().ULS.traceTag(595935906,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard succeed")}),(()=>{i().ULS.traceTag(595935907,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard failed")}))}constructor(e){this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback=void 0,this.lastDeferredPastePromise=void 0,this.selectedRangeToRestore=void 0,this.removeLastPasteEventListenerCallback=void 0,this.activeElementIdToRestore=void 0,this.skipFilesIfPlainTextExists=e,this.clipboardStorageType=pe.SystemClipboard,this.disposableImplementationExtension=Ze("SystemClipboardStorage"),oa().init()}}class Ea extends qe{constructor(e){super(s.InMemory,{browserStorage:!1,systemClipboard:!1,inMemory:!0},e)}}class wa{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.inMemoryClipboardItems=void 0,this.disposableImplementationExtension.dispose())}get(e){return this.disposableImplementationExtension.throwIfDisposed("get"),this.inMemoryClipboardItems?Promise.resolve(this.inMemoryClipboardItems):Promise.resolve(te())}set(e,t){return this.disposableImplementationExtension.throwIfDisposed("set"),this.inMemoryClipboardItems=e,Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[G,Z,"data/shadow-workbook"]}constructor(){this.clipboardStorageType=pe.InMemory,this.disposableImplementationExtension=Ze("InMemoryClipboardStorage")}}class _a extends qe{constructor(e){super(s.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class va{initialize(e,t){return this.initialized=!1,this.systemClipboardStrategy=void 0,this.fullAccessClipboardStrategy=void 0,e.then((e=>(this.systemClipboardStrategy=e,t.then((e=>(this.fullAccessClipboardStrategy=e,this.initialized=!0,Promise.resolve(this)))))))}set(t,r){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new L(c.ClipboardStrategyNotInitialized));const a={systemClipboardOperationResult:Ge(n,"setresult",!1),fullAccessClipboardOperationResult:Ge(n,"setresult",!1)};return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.preSetProcess(t),this.systemClipboardStrategy.set(t,r).then((()=>Promise.resolve(a)),(e=>(a.systemClipboardOperationResult.failed=!0,a.systemClipboardOperationResult.clipboardOperationResultError=e,g(e,[c.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,c.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.resolve(a)))).then((a=>this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.set(t,r).then((()=>Promise.resolve(a)),(t=>(i().ULS.traceTag(595933078,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`Failed to save to fullAccessClipboardStrategy. clipboardStrategyType: '${this.fullAccessClipboardStrategy&&this.fullAccessClipboardStrategy.clipboardStrategyType}', Command Id: '${r.id?r.id:o}', Error: ${e.Wp.getStringifiedError(t)}`),a.fullAccessClipboardOperationResult.failed=!0,a.fullAccessClipboardOperationResult.clipboardOperationResultError=t,Promise.resolve(a)))):(a.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(a)))).then((e=>{if(e.systemClipboardOperationResult.failed&&e.fullAccessClipboardOperationResult.failed){let t=e.systemClipboardOperationResult.clipboardOperationResultError;return t||(t=e.fullAccessClipboardOperationResult.clipboardOperationResultError),t?Promise.reject(t):Promise.reject(new L(c.SetClipboardItems,o))}return Promise.resolve()}))}catch(e){return Promise.reject(new L(c.SetClipboardItems,"Failed in system clipboard.set",e))}}get(t){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new L(c.ClipboardStrategyNotInitialized));const r={systemClipboardOperationResult:Ge(n,"getresult",!1,void 0,{items:{}}),fullAccessClipboardOperationResult:Ge(n,"getresult",!1,void 0,{items:{}})};return this.systemClipboardStrategy.get(t).then((e=>(r.systemClipboardOperationResult.clipboardItemsData=e.getData(),this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.postGetProcess(r.systemClipboardOperationResult),Promise.resolve(r)))).catch((a=>(i().ULS.traceTag(507904974,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Failed to get data from systemClipboardStrategy. clipboardStrategyType: '${this.systemClipboardStrategy&&this.systemClipboardStrategy.clipboardStrategyType}', Command Id: '${t.id?t.id:o}', Error: ${e.Wp.getStringifiedError(a)}`),r.systemClipboardOperationResult.failed=!0,r.systemClipboardOperationResult.clipboardOperationResultError=a,u(a,c.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(a):Promise.resolve(r)))).then((r=>this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.get(t).then((e=>(r.fullAccessClipboardOperationResult.clipboardItemsData=e.getData(),this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.postGetProcess(r.fullAccessClipboardOperationResult),Promise.resolve(r)))).catch((a=>(i().ULS.traceTag(595933079,e.nh.msoulscat_ES_EWAJS,e.kp.Warning,`Failed to get from fullAccessClipboardStrategy. clipboardStrategyType: '${this.fullAccessClipboardStrategy&&this.fullAccessClipboardStrategy.clipboardStrategyType}', Command Id: '${t.id?t.id:o}', Error: ${e.Wp.getStringifiedError(a)}`),r.fullAccessClipboardOperationResult.failed=!0,r.fullAccessClipboardOperationResult.clipboardOperationResultError=a,Promise.resolve(r)))):(r.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(r)))).then((e=>{if(e.systemClipboardOperationResult.failed||t.skipSystemClipboardAccess){if(e.fullAccessClipboardOperationResult.failed){let t=e.systemClipboardOperationResult.clipboardOperationResultError;return t||(t=e.fullAccessClipboardOperationResult.clipboardOperationResultError),t?Promise.reject(t):Promise.reject(new L(c.GetClipboardItems,o))}return 0===re(e.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.reject(e.systemClipboardOperationResult.clipboardOperationResultError):this.validateAndReturnFullAccessData(e)}return e.fullAccessClipboardOperationResult.failed?Promise.resolve(ie(e.systemClipboardOperationResult.clipboardItemsData)):!F()||F()&&k.isEdgeWithTextHtmlClipboardSupportProperty?this.pasteSourceReconciliation(e,t):this.pasteSourceReconciliationBasedOnlyOnTextPlain(e)}))}catch(e){return Promise.reject(new L(c.GetClipboardItems,"Failed in system clipboard.get",e))}}onSystemClipboardChangedExternally(t){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.initialized?this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.onSystemClipboardChangedExternally(t):(i().ULS.shipAssertTag(595882509,e.nh.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.fullAccessClipboardStrategy should be defined"),Promise.reject(new L(c.ClipboardStrategyNotInitialized))):Promise.reject(new L(c.ClipboardStrategyNotInitialized))}catch(e){return Promise.reject(new L(c.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(x([()=>{this.systemClipboardStrategy&&this.systemClipboardStrategy.dispose()},()=>{this.fullAccessClipboardStrategy&&this.fullAccessClipboardStrategy.dispose()}]),this.disposableImplementationExtension.dispose())}pasteSourceReconciliation(t,r){let a,o,n;return t.systemClipboardOperationResult.signatureData&&(a=t.systemClipboardOperationResult.signatureData.ccp_infra_timestamp),t.fullAccessClipboardOperationResult.signatureData&&(o=t.fullAccessClipboardOperationResult.signatureData.ccp_infra_timestamp),i().ULS.traceTag(595719624,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`systemClipboardAndFullAccessClipboardStrategy.pasteSourceReconciliation: ccpTimestampInSystemClipboard=${a} ccpTimestampInFullAccessClipboard=${o}`),a?(n=o||0,a>n?(Ta(t.systemClipboardOperationResult.clipboardItemsData,!0),Promise.resolve(ie(t.systemClipboardOperationResult.clipboardItemsData))):Promise.resolve(ie(t.fullAccessClipboardOperationResult.clipboardItemsData))):r.isTimestampStoredInSystemClipboard&&Ia(t)?Promise.resolve(ie(t.fullAccessClipboardOperationResult.clipboardItemsData)):Aa(t)?this.validateAndReturnFullAccessData(t):(Ta(t.systemClipboardOperationResult.clipboardItemsData,!1),Promise.resolve(ie(t.systemClipboardOperationResult.clipboardItemsData)))}validateAndReturnFullAccessData(e){return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.validateUserHash(e.fullAccessClipboardOperationResult.signatureData),Promise.resolve(ie(e.fullAccessClipboardOperationResult.clipboardItemsData))}pasteSourceReconciliationBasedOnlyOnTextPlain(e){return 0===re(e.systemClipboardOperationResult.clipboardItemsData)||0===re(e.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.resolve(ie(e.systemClipboardOperationResult.clipboardItemsData)):Ia(e)?Promise.resolve(ie(e.fullAccessClipboardOperationResult.clipboardItemsData)):Aa(e)?this.validateAndReturnFullAccessData(e):(e.systemClipboardOperationResult.clipboardItemsData.items[Y]="1",Promise.resolve(ie(e.systemClipboardOperationResult.clipboardItemsData)))}constructor(e,t,r,a){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this._fullAccessClipboardStrategyType=r,this.dualClipboardDataProcessor=a,this.initialized=!1,this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.disposableImplementationExtension=Ze(`${e}`)}}function Ta(e,t){e.items[Y]="1",t&&(e.items["metadata/is-last-copy-was-external-XLO-source"]="1")}function Ia(e){const t=Ut(Ft(e.systemClipboardOperationResult.clipboardItemsData.items[G])),r=e.fullAccessClipboardOperationResult.clipboardItemsData.items[G];return!!r&&t===Ut(Ft(r))}function Aa(e){return Ut(Ft(e.systemClipboardOperationResult.clipboardItemsData.items[G]))===Va().getCopyToClipboardLatencyMessage()}class Pa extends va{constructor(e){super(s.SystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},s.LocalStorage,e)}}class La extends va{constructor(e){super(s.SystemClipboardAndInMemory,{browserStorage:!1,systemClipboard:!0,inMemory:!0},s.InMemory,e)}}class xa extends _r{initialize(){return this.innerInitialize().then((()=>this))}get(t){this.disposableImplementationExtension.throwIfDisposed("get"),i().ULS.traceTag(595947538,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`ClipboardStorageIframeProxy.get: isKeyboardEvent = ${t.isKeyboardEvent}; silentClipboardAccessFailures = ${t.silentClipboardAccessFailures||!1}`);const r=He(Je(),"get",this.messageDestination,t.userHash);return this.postMessage(r,"get").then((e=>e.clipboardItemsData?Promise.resolve(ie(e.clipboardItemsData)):Promise.resolve(te())))}set(t,r){let a;return this.disposableImplementationExtension.throwIfDisposed("set"),i().ULS.traceTag(595947541,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`ClipboardStorageIframeProxy.set: isKeyboardEvent = ${r.isKeyboardEvent}; silentClipboardAccessFailures = ${r.silentClipboardAccessFailures||!1}`),a=ae(t)>0?He(Je(),"set",this.messageDestination,r.userHash,t.getData()):He(Je(),"set",this.messageDestination),this.postMessage(a,"set").then((()=>{}))}clearClipboardNecessary(e,t){return function(e,t){return null==e||1===e||null==t||e!==t}(e,t)}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[G,Z,"data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t){if(super(),this.messageDestination=t,!t)throw new y(o,"messageDestination");this.clipboardStorageType=e,this.disposableImplementationExtension=Ze(t)}}class Da extends xa{constructor(e){super(pe.LocalStorage,e)}}class Ma extends qe{constructor(e){super(s.AsyncSystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},e)}}let ka;const $a=e=>{ka=e},Wa=(e,t=!1)=>ka?ka.getBooleanFeatureGate(e,t):t;class Ra{async get(t){if(this.disposableImplementationExtension.throwIfDisposed("get"),t.isAsyncClipboardAPI=!0,t.skipSystemClipboardAccess)return Promise.resolve(te());const r={name:"clipboard-read",allowWithoutGesture:!1};try{const a=await(navigator.permissions?.query(r));t.asyncClipboardReadPermissionState=a?.state,i().ULS.traceTag(507626376,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.get - Clipboard read permission state: ${a?.state}. Command id: ${t.id}`),this.initialClipboardPermissionState=a?.state,"prompt"===a?.state&&(this.isActionPerformedOnPermissionPrompt=!1,a.onchange=()=>{t.asyncClipboardReadPermissionUpdatedState=a?.state,this.isActionPerformedOnPermissionPrompt=!0,"denied"===a?.state?i().ULS.traceTag(507626375,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.get - Clipboard read permission is denied from prompt. Command id: ${t.id}`):"granted"===a?.state&&i().ULS.traceTag(507626374,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.get - Clipboard read permission is granted from prompt. Command id: ${t.id}`)})}catch(r){t.asyncClipboardReadPermissionState=`Failed to query "clipboard-read" permission. Error: ${e.Wp.getStringifiedError(r)}`,i().ULS.traceTag(508651269,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.get: Failed to query "clipboard-read" permission. Command id: ${t.id}, Error: ${e.Wp.getStringifiedError(r)}`)}return await this.readFromSystemClipboard(t)}async set(t,r){this.disposableImplementationExtension.throwIfDisposed("set"),r.isAsyncClipboardAPI=!0;const a=this.getSupportedDataFormats();try{const o={name:"clipboard-write",allowWithoutGesture:!0};try{const t=await(navigator.permissions?.query(o));r.asyncClipboardWritePermissionState=t?.state,i().ULS.traceTag(507626372,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.set - Clipboard write permission state: ${t?.state}. Command id: ${r.id}`),this.initialClipboardPermissionState=t?.state,"prompt"===t?.state&&(this.isActionPerformedOnPermissionPrompt=!1,t.onchange=()=>{r.asyncClipboardWritePermissionUpdatedState=t?.state,this.isActionPerformedOnPermissionPrompt=!0,"denied"===t?.state?i().ULS.traceTag(507626371,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.set - Clipboard write permission is denied from prompt. Command id: ${r.id}`):"granted"===t?.state&&i().ULS.traceTag(507626370,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.set - Clipboard write permission is granted from prompt. Command id: ${r.id}`)})}catch(t){r.asyncClipboardWritePermissionState=`Failed to query "clipboard-write" permission. Error: ${e.Wp.getStringifiedError(t)}`,i().ULS.traceTag(508651268,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.set: Failed to query "clipboard-write" permission. Command id: ${r.id}, Error: ${e.Wp.getStringifiedError(t)}`)}const n=ce(t);if(!n||n.length<1)return;const s={};for(const e of n){if(!a.includes(e.clipboardDataFormat))continue;let t;t=e.deferred?e.data:new Blob([e.data],{type:e.clipboardDataFormat});const r=a.includes(`${this.webCustomFormatPrefix}${e.clipboardDataFormat}`);r&&this.isAsyncClipboardEnhancementsEnabled?s[`${this.webCustomFormatPrefix}${e.clipboardDataFormat}`]=t:r||(s[e.clipboardDataFormat]=t)}const l=new ClipboardItem(s,{unsanitized:[Z]});r.timeElapsedBeforeAsyncClipboardWrite=r.stopwatch?.getElapsedTime?.(),r.isDocumentFocusedBeforeAsyncClipboardWrite=document.hasFocus?.(),r.isTransientUserActiveBeforeAsyncClipboardWrite=navigator?.userActivation?.isActive,await navigator.clipboard.write([l]);const c=r.stopwatch?.getElapsedTime?.();r.asyncClipboardWriteDuration=c-r.timeElapsedBeforeAsyncClipboardWrite,r.isAsyncClipboardWriteSucceeded=!0,i().ULS.traceTag(508703872,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.set: Write successful. Command id: ${r.id}, TimeElapsedBeforeClipboardWrite: ${r.timeElapsedBeforeAsyncClipboardWrite}ms, ClipboardWriteDurationInMs: ${r.asyncClipboardWriteDuration}ms, IsDocumentFocused: ${r.isDocumentFocusedBeforeAsyncClipboardWrite}, IsTransientUserActive: ${r.isTransientUserActiveBeforeAsyncClipboardWrite}`),r.isTimestampStoredInSystemClipboard=!0}catch(t){if(!r.id&&r.silentClipboardAccessFailures)return void i().ULS.traceTag(506009493,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.set: Failed to write data formats to system clipboard in Non-Copy flow. Error: ${e.Wp.getStringifiedError(t)}`);throw r.isAsyncClipboardWriteSucceeded=!1,r.asyncClipboardWriteErrorMessage=e.Wp.getStringifiedError(t),"prompt"!==this.initialClipboardPermissionState||this.isActionPerformedOnPermissionPrompt||i().ULS.traceTag(507626369,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.set - Clipboard write permission prompt is closed without any action. Command id: ${r.id}`),i().ULS.traceTag(508843076,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.set: Failed to write data formats to system clipboard. Command id: ${r.id}, Error: ${e.Wp.getStringifiedError(t)}, TimeElapsedBeforeClipboardWrite: ${r.timeElapsedBeforeAsyncClipboardWrite}ms, IsDocumentFocused: ${r.isDocumentFocusedBeforeAsyncClipboardWrite}, IsTransientUserActive: ${r.isTransientUserActiveBeforeAsyncClipboardWrite}`),this.isAsyncClipboardEnhancementsEnabled?t?.message?.includes(this.clipboardWritePermissionDeniedErrorMessage)?new L(c.ClipboardIsInaccessible,`AsyncSystemClipboardStorage.set - Clipboard permission is denied. Command id: ${r.id}`,t):new L(c.AsyncClipboardWriteFailure,`AsyncSystemClipboardStorage.set - Failed to write clipboard items. Command id: ${r.id}`,t):new L(c.ClipboardIsInaccessible,`AsyncSystemClipboardStorage.set - Clipboard permission is denied or failed to write. Command id: ${r.id}`,t)}}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[G,Z,q,"data/shadow-workbook","web data/shadow-workbook","metadata/copy-context","web metadata/copy-context"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}async readFromSystemClipboard(t){const r=ie();try{t.timeElapsedBeforeAsyncClipboardRead=t.stopwatch?.getElapsedTime?.(),t.isDocumentFocusedBeforeAsyncClipboardRead=document.hasFocus?.(),t.isTransientUserActiveBeforeAsyncClipboardRead=navigator?.userActivation?.isActive;const o=await navigator.clipboard.read({unsanitized:[Z]}),n=t.stopwatch?.getElapsedTime?.();t.isAsyncClipboardReadSucceeded=!0,t.asyncClipboardReadDuration=n-t.timeElapsedBeforeAsyncClipboardRead,i().ULS.traceTag(506017227,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard: Read successful, Command id: ${t.id}, isKeyboardEvent: ${t.isKeyboardEvent}, TimeElapsedBeforeClipboardRead: ${t.timeElapsedBeforeAsyncClipboardRead}ms, ClipboardReadDurationInMs: ${t.asyncClipboardReadDuration}ms, IsDocumentFocused: ${t.isDocumentFocusedBeforeAsyncClipboardRead}, IsTransientUserActive: ${t.isTransientUserActiveBeforeAsyncClipboardRead}`);const s=this.getSupportedDataFormats();if(!o||o.length<1)return r;for(const n of o)for(const o of n.types){if(!s.includes(o))continue;const l=await n.getType(o);if(!l){i().ULS.traceTag(506840981,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard: Failed to read blob for '${o}' type, Command id: ${t.id}, isKeyboardEvent: ${t.isKeyboardEvent}`);continue}let c;c=o===q?await(a=l,Xr(a)):await l.text();const d=o.startsWith(this.webCustomFormatPrefix);d&&this.isAsyncClipboardEnhancementsEnabled?r.setItem(o.replace(this.webCustomFormatPrefix,""),c):d||r.setItem(o,c)}}catch(a){if(t.isAsyncClipboardReadSucceeded=!1,t.asyncClipboardReadErrorMessage=e.Wp.getStringifiedError(a),"prompt"!==this.initialClipboardPermissionState||this.isActionPerformedOnPermissionPrompt||t.isKeyboardEvent||i().ULS.traceTag(507626373,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard - Clipboard read permission prompt is closed without any action. Command id: ${t.id}`),a.name===this.emptyClipboardReadErrorName&&a.message===this.emptyClipboardReadErrorMessage)return i().ULS.traceTag(508352130,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard: System clipboard is empty. Command id: ${t.id}, Error: ${e.Wp.getStringifiedError(a)}`),r;if(i().ULS.traceTag(508843077,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`AsyncSystemClipboardStorage.readFromSystemClipboard: Failed to read data formats from system clipboard. Command id: ${t.id}, IsKeyboardEvent: ${t.isKeyboardEvent}, Error: ${e.Wp.getStringifiedError(a)}, TimeElapsedBeforeClipboardRead: ${t.timeElapsedBeforeAsyncClipboardRead}ms, IsDocumentFocused: ${t.isDocumentFocusedBeforeAsyncClipboardRead}, IsTransientUserActive: ${t.isTransientUserActiveBeforeAsyncClipboardRead}`),this.isAsyncClipboardEnhancementsEnabled)throw a?.message?.includes(this.clipboardReadPermissionDeniedErrorMessage)?new L(c.ClipboardIsInaccessible,`AsyncSystemClipboardStorage.readFromSystemClipboard - Clipboard read permission is denied. Command id: ${t.id}`,a):new L(c.AsyncClipboardReadFailure,`AsyncSystemClipboardStorage.readFromSystemClipboard - Failed to read clipboard items. Command id: ${t.id}`,a);throw new L(c.ClipboardIsInaccessible,`AsyncSystemClipboardStorage.readFromSystemClipboard - Clipboard permission is denied or failed to read. Command id: ${t.id}`,a)}finally{t.clearSystemClipboard&&this.clearSystemClipboard()}var a;return r}async clearSystemClipboard(){try{await navigator.clipboard.writeText(""),i().ULS.traceTag(508703843,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"AsyncSystemClipboardStorage.clearSystemClipboard: Clipboard cleared")}catch(t){i().ULS.traceTag(508703842,e.nh.msoulscat_ES_EWAJS,e.kp.Info,"AsyncSystemClipboardStorage.clearSystemClipboard: Failed to clear system clipboard.")}}constructor(){this.initialClipboardPermissionState=null,this.isActionPerformedOnPermissionPrompt=!1,this.webCustomFormatPrefix="web ",this.emptyClipboardReadErrorName="DataError",this.clipboardReadPermissionDeniedErrorMessage="Read permission denied",this.clipboardWritePermissionDeniedErrorMessage="Write permission denied",this.emptyClipboardReadErrorMessage="No valid data on clipboard.",this.clipboardPermissionDeniedErrorMessage="AsyncSystemClipboardStorage - Clipboard permission is denied",this.clipboardIsInaccessibleError=new L(c.ClipboardIsInaccessible,this.clipboardPermissionDeniedErrorMessage),this.isAsyncClipboardEnhancementsEnabled=!1,this.clipboardStorageType=pe.AsyncSystemClipboard,this.disposableImplementationExtension=Ze("AsyncSystemClipboardStorage"),this.isAsyncClipboardEnhancementsEnabled=Wa("Microsoft.Office.Excel.AsyncClipboardEnhancements",!1)}}class Oa extends va{constructor(e){super(s.AsyncSystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},s.LocalStorage,e)}}class Ua{async initialize(e,t){this.initialized=!1;const[r,a]=await Promise.all([e,t]);return this.systemClipboardStorage=r,this.asyncSystemClipboardStorage=a,this.initialized=!0,this}async get(t){this.disposableImplementationExtension.throwIfDisposed("get");const r=window.performance.now();if(!this.initialized||!this.asyncSystemClipboardStorage||!this.systemClipboardStorage)throw new L(c.ClipboardStrategyNotInitialized);try{return await this.systemClipboardStorage.get(t)}catch(r){i().ULS.traceTag(508154642,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`CombinedSystemClipboardStorage.get - systemClipboardStorage get failed. Command id: ${t.id}, Error: ${e.Wp.getStringifiedError(r)}`);try{return await this.asyncSystemClipboardStorage.get(t)}catch(r){throw i().ULS.traceTag(507904976,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`CombinedSystemClipboardStorage.get - asyncSystemClipboardStorage get failed. Command id: ${t.id}, Error: ${e.Wp.getStringifiedError(r)}`),new L(c.ClipboardIsInaccessible,"CombinedSystemClipboardStorage.get - Clipboard permission is denied or failed to read",r)}}finally{i().ULS.traceTag(508154640,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`CombinedSystemClipboardStorage.get | System clipboard total read time: ${window.performance.now()-r} ms, Command id: ${t.id}`)}}async set(t,r){this.disposableImplementationExtension.throwIfDisposed("set");const a=window.performance.now();if(!this.initialized||!this.asyncSystemClipboardStorage||!this.systemClipboardStorage)throw new L(c.ClipboardStrategyNotInitialized);try{return void await this.systemClipboardStorage.set(t,r)}catch(a){i().ULS.traceTag(508154638,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`CombinedSystemClipboardStorage.set - systemClipboardStorage set failed. Command id: ${r.id}, Error: ${e.Wp.getStringifiedError(a)}`);try{return void await this.asyncSystemClipboardStorage.set(t,r)}catch(t){throw i().ULS.traceTag(507904975,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`CombinedSystemClipboardStorage.set - asyncSystemClipboardStorage set failed. Command id: ${r.id}, Error: ${e.Wp.getStringifiedError(t)}`),new L(c.ClipboardIsInaccessible,"CombinedSystemClipboardStorage.set - Clipboard permission is denied or failed to write",t)}}finally{i().ULS.traceTag(508154637,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`CombinedSystemClipboardStorage.set - System clipboard total write time: ${window.performance.now()-a} ms, Command id: ${r.id}`)}}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[...this.systemClipboardStorage?.getSupportedDataFormats()??[],...this.asyncSystemClipboardStorage?.getSupportedDataFormats()??[]].reduce(((e,t)=>(-1===e.indexOf(t)&&e.push(t),e)),[])}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(){this.initialized=!1,this.clipboardStorageType=pe.AsyncSystemClipboard,this.disposableImplementationExtension=Ze("CombinedSystemClipboardStorage")}}class Fa extends va{constructor(e){super(s.AsyncSystemClipboardAndInMemory,{browserStorage:!1,systemClipboard:!0,inMemory:!0},s.InMemory,e)}}class Na{async initialize(e,t,r){const[a,i]=await Promise.all([e,t]);return this.primarySystemClipboardStrategy=a,this.secondarySystemClipboardStrategy=i,this.currentSystemClipboardStrategy=a,this.initialized=!0,this.isAsyncClipboardRoamingSettingsEnabled&&r&&queueMicrotask((()=>{this.switchToSecondaryStrategyIfClipboardPermissionDenied(r)})),this}async set(e,t){if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.initialized)throw new L(c.ClipboardStrategyNotInitialized);try{return void await this.currentSystemClipboardStrategy.set(e,t)}catch(e){throw this.handleClipboardStrategyFailure(t,e),e}}async get(e){if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.initialized)throw new L(c.ClipboardStrategyNotInitialized);try{return await this.currentSystemClipboardStrategy.get(e)}catch(t){throw this.handleClipboardStrategyFailure(e,t),t}}onSystemClipboardChangedExternally(e){if(this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),!this.initialized)throw new L(c.ClipboardStrategyNotInitialized);return this.currentSystemClipboardStrategy.onSystemClipboardChangedExternally(e)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.primarySystemClipboardStrategy?.dispose(),this.secondarySystemClipboardStrategy?.dispose(),this.initialized=!1,this.primarySystemClipboardStrategy=null,this.secondarySystemClipboardStrategy=null,this.currentSystemClipboardStrategy=null,this.disposableImplementationExtension.dispose())}async switchToSecondaryStrategyIfClipboardPermissionDenied(t){try{await t&&this.currentSystemClipboardStrategy===this.primarySystemClipboardStrategy&&this.switchToSecondaryStrategy(void 0,!0)}catch(t){i().ULS.traceTag(504739846,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`CircuitBreakerSystemClipboardStrategy.switchToSecondaryStrategyIfClipboardPermissionDenied: Error while switching clipboard strategy: ${t}`)}}handleClipboardStrategyFailure(e,t){const r=t;this.currentSystemClipboardStrategy===this.primarySystemClipboardStrategy&&r.reason===c.ClipboardIsInaccessible&&(this.errorCount++,this.errorCount>=this.circuitBreakerThreshold&&this.switchToSecondaryStrategy(e))}switchToSecondaryStrategy(t,r){this.currentSystemClipboardStrategy=this.secondarySystemClipboardStrategy,t&&(t.dataClipboardStrategyType=this.secondarySystemClipboardStrategy?.clipboardStrategyType),i().ULS.traceTag(505520142,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`Switched to secondary system clipboard strategy. isAppBootPhase: ${!!r}`)}constructor(){this.initialized=!1,this.primarySystemClipboardStrategy=null,this.secondarySystemClipboardStrategy=null,this.currentSystemClipboardStrategy=null,this.circuitBreakerThreshold=1,this.errorCount=0,this.clipboardStrategyType=s.AsyncSystemClipboard,this.clipboardCapabilities={browserStorage:!0,systemClipboard:!0,inMemory:!1},this.disposableImplementationExtension=Ze("CircuitBreakerSystemClipboardStrategy"),this.isAsyncClipboardRoamingSettingsEnabled=Wa("Microsoft.Office.Excel.AsyncClipboardRoamingSettings",!1)}}function ja(e){return new Ca(e)}function Ja(){return new Ra}function za(t,r,a,n,l,d,p){const m=function(e,t,r){return new nr(e,t,r)}(a,n,l);return function(t,r,a,n,l){let d=ge.NoError;return e.Wp.chainFallbackPromises(t,(t=>function(t,r,a,n,l){i().ULS.traceTag(595716231,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Attempting to create clipboard strategy type '${t.clipboardStrategyType}'`);const d=()=>(()=>{switch(t.clipboardStrategyType){case s.SystemClipboard:case s.SystemClipboardAndInMemory:case s.AsyncSystemClipboard:case s.AsyncSystemClipboardAndInMemory:return t;case s.SystemClipboardAndLocalStorage:case s.AsyncSystemClipboardAndLocalStorage:return t.systemClipboardStrategyParameters;default:throw new T(`createClipboardEnvironmentComponentsByType: getSystemClipboardParameters couldn't be used for ${t.clipboardStrategyType}`)}})().skipFilesIfPlainTextExists,p=()=>{switch(t.clipboardStrategyType){case s.LocalStorage:return t;case s.AsyncSystemClipboard:case s.AsyncSystemClipboardAndInMemory:case s.SystemClipboardAndLocalStorage:case s.AsyncSystemClipboardAndLocalStorage:return t.localStorageStrategyParameters;default:throw new T(`createClipboardEnvironmentComponentsByType: getLocalStorageParameters couldn't be used for ${t.clipboardStrategyType}`)}},m=e=>a.createClipboardDataProcessor(e),u=()=>a.createClipboardMetaDataProcessor(),g=e=>a.createDualClipboardDataProcessor(e),h=()=>{const e=p();return e.useSharedClipboardIframe?new Tr:function(e){return new vr(e)}(St(e.sharedClipboardSchemaVersion)+ft)},f=(t,a)=>(a?a.initialize(t):Promise.resolve(void 0)).then((()=>function(t,r,a){return i().ULS.shipAssertTag(595945246,e.nh.msoulscat_ES_EWAJS,!!t,"MetadataManager.createMetadataManager: expected clipboardStrategy to be defined."),i().ULS.shipAssertTag(595945247,e.nh.msoulscat_ES_EWAJS,!!t,"MetadataManager.createMetadataManager: expected metadataSerializationHelper to be defined."),Gt=t,Kt=function(e){return Vt=e,Bt}(r),Zt=a,Zt&&Zt.setOnMetadataChangedListener(er),Qt}(t,r,a))),S=e=>{let t;return t=Wa("Microsoft.Office.Excel.AsyncClipboardEnhancements",!1)?Promise.resolve(Ja()):Promise.resolve((new Ua).initialize(Promise.resolve(ja(d())),Promise.resolve(Ja()))),function(e){return new Ma(e)}(e).initialize(t)},b=()=>(new Ir).initialize(Promise.resolve(ja(d()))),C=e=>function(e){return new Ea(e)}(e).initialize(Promise.resolve(new wa)),E=t=>{const r={};t.wacCluster&&(r.wacCluster=t.wacCluster.trim()),t.sessionId&&(r.sessionId=t.sessionId),n&&(r.bulsEndpointUrl=n);const a=t.sharedClipboardOverrideOrigin?1:0;var s;s={sharedClipboardHostingApp:t.sharedClipboardHostingApp,sharedClipboardHostingApps:t.sharedClipboardHostingApps,sharedClipboardHostingEnvironments:t.sharedClipboardHostingEnvironments,sharedClipboardSchemaVersion:t.sharedClipboardSchemaVersion,sharedClipboardExpirationInMinutes:t.sharedClipboardExpirationInMinutes,clipboardPromiseTimeoutInMinutes:t.sharedClipboardExpirationInMinutes,whitelistOriginComponents:a},we=!1,function(t){if(!t)throw new y(o,"sharedClipboardSettingsCandidate");const r=ve();if("number"!=typeof t.sharedClipboardSchemaVersion||isNaN(t.sharedClipboardSchemaVersion)||(r.sharedClipboardSchemaVersion=t.sharedClipboardSchemaVersion),"number"!=typeof t.sharedClipboardExpirationInMinutes||isNaN(t.sharedClipboardExpirationInMinutes)||(r.sharedClipboardExpirationInMinutes=t.sharedClipboardExpirationInMinutes),"number"!=typeof t.clipboardPromiseTimeoutInMinutes||isNaN(t.clipboardPromiseTimeoutInMinutes)||(r.clipboardPromiseTimeoutInMinutes=t.clipboardPromiseTimeoutInMinutes),"string"==typeof t.remoteLoggerPath&&t.remoteLoggerPath&&t.remoteLoggerPath.trim()&&(r.remoteLoggerPath=t.remoteLoggerPath),"number"!=typeof t.whitelistOriginComponents||1!==t.whitelistOriginComponents)return Ee=r,void(we=!0);if("string"!=typeof t.sharedClipboardHostingApp||!t.sharedClipboardHostingApp||!t.sharedClipboardHostingApp.trim())return i().ULS.traceTag(596124181,e.nh.msoulscat_ES_EWAJS,e.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),Ee=r,void(we=!0);r.sharedClipboardHostingApp=t.sharedClipboardHostingApp.trim();let a=r.sharedClipboardHostingApp;const n=a.indexOf(Se);n>=0&&(a=a.substr(n+1));try{r.sharedClipboardHostingApps=t.sharedClipboardHostingApps?JSON.parse(t.sharedClipboardHostingApps):void 0}catch{i().ULS.traceTag(579737680,e.nh.msoulscat_ES_EWAJS,e.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+t.sharedClipboardHostingApps)}if(!r.sharedClipboardHostingApps||!Array.isArray(r.sharedClipboardHostingApps)||0===r.sharedClipboardHostingApps.length||r.sharedClipboardHostingApps.some((e=>!e||!e.trim())))return i().ULS.traceTag(596124182,e.nh.msoulscat_ES_EWAJS,e.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),r.sharedClipboardHostingApp=o,r.sharedClipboardHostingApps=[],Ee=r,void(we=!0);try{r.sharedClipboardHostingEnvironments=t.sharedClipboardHostingEnvironments?JSON.parse(t.sharedClipboardHostingEnvironments):void 0}catch{i().ULS.traceTag(579737681,e.nh.msoulscat_ES_EWAJS,e.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+t.sharedClipboardHostingEnvironments)}if(!r.sharedClipboardHostingEnvironments||!Array.isArray(r.sharedClipboardHostingEnvironments)||0===r.sharedClipboardHostingEnvironments.length||r.sharedClipboardHostingEnvironments.some((e=>!e||!e.trim())))return i().ULS.traceTag(596124183,e.nh.msoulscat_ES_EWAJS,e.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),r.sharedClipboardHostingApp=o,r.sharedClipboardHostingApps=[],r.sharedClipboardHostingEnvironments=[],Ee=r,void(we=!0);if(r.sharedClipboardHostingApps.indexOf(r.sharedClipboardHostingApp)<0){if(r.sharedClipboardHostingApp===a)return i().ULS.traceTag(596124184,e.nh.msoulscat_ES_EWAJS,e.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${r.sharedClipboardHostingApp}' should be listed in sharedClipboardHostingApps`),r.sharedClipboardHostingApp=o,r.sharedClipboardHostingApps=[],r.sharedClipboardHostingEnvironments=[],Ee=r,void(we=!0);if(r.sharedClipboardHostingApps.indexOf(a)<0)return i().ULS.traceTag(596124185,e.nh.msoulscat_ES_EWAJS,e.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${r.sharedClipboardHostingApp}' or '${a}' should be listed in sharedClipboardHostingApps`),r.sharedClipboardHostingApp=o,r.sharedClipboardHostingApps=[],r.sharedClipboardHostingEnvironments=[],Ee=r,void(we=!0)}r.whitelistOriginComponents=!0,Ee=r,we=!0}(s),function(t){i().ULS.shipAssertTag(595944468,e.nh.msoulscat_ES_EWAJS,!!t,"ClipboardPlatformSettings.setClipboardPlatformSettings: expect clipboardPlatformSettings to be defined."),zt=t}(r)},w=(e,t)=>{const r=p();return r.useSharedClipboardIframe?(E(r),function(e){return new _a(e)}(t).initialize((a=e?Ve.localStorageMetadata:Ve.localStorageData,new Da(a)).initialize())):function(e){return new wt(e)}(t).initialize(Promise.resolve((i=e?St(r.sharedClipboardSchemaVersion):(o=r.sharedClipboardSchemaVersion,ht+o),new Et(i))));var a,i,o},_=()=>{return(e=g(!0),new Pa(e)).initialize(b(),w(!1));var e},v=(e,t,r)=>Promise.all([e,t]).then((([e,t])=>f(t,r).then((t=>({dataClipboardStrategy:e,metadataManager:t})))));try{switch(t.clipboardStrategyType){case s.AsyncSystemClipboard:return v((e=>{const t=m(!1);return(new Na).initialize(S(t),_(),e)})(l),w(!0,u()),h());case s.SystemClipboard:return v(b(),C(u()));case s.InMemory:return v(C(m(!1)),C(u()));case s.LocalStorage:return v(w(!1,m(!0)),w(!0,u()),h());case s.AsyncSystemClipboardAndLocalStorage:return v((I=g(!0),new Oa(I)).initialize(S(),w(!1)),w(!0,u()),h());case s.AsyncSystemClipboardAndInMemory:return v((()=>{return(e=g(!1),new Fa(e)).initialize(S(),C());var e})(),w(!0,u()),h());case s.SystemClipboardAndLocalStorage:return v(_(),w(!0,u()),h());case s.SystemClipboardAndInMemory:return v((()=>{return(e=g(!1),new La(e)).initialize(b(),C());var e})(),C(u()))}return Promise.reject(new L(c.UnsupportedClipboardStrategyType,`Clipboard strategy type '${t.clipboardStrategyType}' is not supported`))}catch(r){return Promise.reject(new L(c.UnsupportedClipboardStrategyType,`failed to create clipboardStrategyType: '${t.clipboardStrategyType}' with error: ${e.Wp.getStringifiedError(r)}`))}var I}(t,r,a,n,l).then((r=>(i().ULS.traceTag(595716294,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Clipboard strategy type '${t.clipboardStrategyType}' was created.`),r.infraInitializationError=d,r))).catch((r=>{let a=!1;a=h(r),a&&(d=ge.LocalStorageInaccessible);const o=`clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: selectClipboardStrategy: failed to create clipboard strategy type '${t.clipboardStrategyType}'. Error: ${e.Wp.getStringifiedError(r)}`;return i().ULS.traceTag(595716230,e.nh.msoulscat_ES_EWAJS,a?e.kp.Info:e.kp.Error,o),Promise.reject(new L(c.SelectClipboardStrategy,o,r))}))))}(t,r,m,d,p).then((e=>({dataClipboardStrategy:e.dataClipboardStrategy,clipboardDataManager:m,metadataManager:e.metadataManager,infraInitializationError:e.infraInitializationError})))}class Ha{static setFeatureGateManager(e){$a(e)}}function Va(){return Za}function Ba(e){Ha.setFeatureGateManager(e)}var Ga;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.StateReady=1]="StateReady",e[e.InitializationSucceed=2]="InitializationSucceed"}(Ga||(Ga={}));const Ka={initializationStatus:Ga.NotInitialized,stateInitialized:!1,clipboardStrategy:void 0,chromeExtensionIds:[],clipboardPromiseTimeoutInMinutes:Ce,copyToClipboardLatencyMessage:"Retrieving data. Wait a few seconds and try to cut or copy again.",metadataManager:void 0,clipboardDataManager:void 0,initializationError:ge.NoError},Za={init:function(r,a,n,s,l,c,d,p,m,u,g,h,f,S,b,C,E,w,_){return Ka.lastClipboardPlatformEnvironmentInitializationInfo?Promise.resolve(Ka.lastClipboardPlatformEnvironmentInitializationInfo):(function(r){if(!r)throw new Error("The 'logger' argument is missing");t=e.Hv.getFromExternalLogger(r)}(r),a&&Array.isArray(a)?(i().ULS.traceTag(596455702,e.nh.msoulscat_ES_EWAJS,e.kp.Info,`ClipboardPlatformEnvironment.init: chromeExtensionIds = '${JSON.stringify(a)}'`),Ka.chromeExtensionIds=function(e){const t=[];if(!e)return t;for(const r of e)r&&"string"==typeof r&&r.trim().length>0&&t.push(r);return t}(a),u&&(Ka.copyToClipboardLatencyMessage=u),"number"!=typeof m||isNaN(m)||(Ka.clipboardPromiseTimeoutInMinutes=m),Ka.initializationStatus=Ga.StateReady,za(f,h,S,b,C,w,_).then((e=>(Ka.clipboardDataManager=e.clipboardDataManager,Ka.metadataManager=e.metadataManager,Ka.clipboardStrategy=e.dataClipboardStrategy,Ka.initializationError=e.infraInitializationError,Ka.initializationStatus=Ga.InitializationSucceed,Ka.lastClipboardPlatformEnvironmentInitializationInfo={clipboardStrategiesToInitialize:f,dataClipboardCapabilities:Ka.clipboardStrategy&&Ka.clipboardStrategy.clipboardCapabilities,dataClipboardStrategyType:Ka.clipboardStrategy&&Ka.clipboardStrategy.clipboardStrategyType,infraInitializationError:Ka.initializationError},Ka.lastClipboardPlatformEnvironmentInitializationInfo)))):Promise.reject(new y(o,"chromeExtensionIds")))},getClipboardStrategy:function(){if(qa(),!Ka.clipboardStrategy)throw new E("A clipboard strategy has not been selected. Call selectClipboardStrategy.");return Ka.clipboardStrategy},getChromeExtensionIds:function(){return Ya(),Ka.chromeExtensionIds},getClipboardPromiseTimeoutInMinutes:function(){return Ya(),Ka.clipboardPromiseTimeoutInMinutes},getCopyToClipboardLatencyMessage:function(){return Ya(),Ka.copyToClipboardLatencyMessage},getMetadataManager:function(){return qa(),Ka.metadataManager},getClipboardDataManager:function(){return qa(),Ka.clipboardDataManager},getInitializationError:function(){return qa(),Ka.initializationError}};function qa(){if(Ka.initializationStatus!==Ga.InitializationSucceed)throw new E("ClipboardPlatformEnvironment is not initialized. Call init(...).")}function Ya(){if(Ka.initializationStatus<Ga.StateReady)throw new E("ClipboardPlatformEnvironment state is not ready. Call init(...).")}}(),clipboardPlatform=a}();
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/clipboardPlatform.min.js.map/f0385cca97581b9842736f14b93da9b5/clipboardPlatform.min.js.map