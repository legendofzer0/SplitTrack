var copyPasteInfra;!function(){var e={8805:function(e){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,r){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,r)}function r(e,o,n){return r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,r,o){var n=[null];n.push.apply(n,r);var a=new(Function.bind.apply(e,n));return o&&t(a,o.prototype),a},r.apply(null,arguments)}function o(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var a=Object.hasOwnProperty,i=Object.setPrototypeOf,s=Object.isFrozen,c=Object.getPrototypeOf,l=Object.getOwnPropertyDescriptor,d=Object.freeze,p=Object.seal,u=Object.create,m="undefined"!=typeof Reflect&&Reflect,f=m.apply,g=m.construct;f||(f=function(e,t,r){return e.apply(t,r)}),d||(d=function(e){return e}),p||(p=function(e){return e}),g||(g=function(e,t){return r(e,o(t))});var h,y=A(Array.prototype.forEach),S=A(Array.prototype.pop),C=A(Array.prototype.push),b=A(String.prototype.toLowerCase),w=A(String.prototype.toString),E=A(String.prototype.match),_=A(String.prototype.replace),P=A(String.prototype.indexOf),T=A(String.prototype.trim),v=A(RegExp.prototype.test),I=(h=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(h,t)});function A(e){return function(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return f(e,t,o)}}function x(e,t,r){var o;r=null!==(o=r)&&void 0!==o?o:b,i&&i(e,null);for(var n=t.length;n--;){var a=t[n];if("string"==typeof a){var c=r(a);c!==a&&(s(t)||(t[n]=c),a=c)}e[a]=!0}return e}function L(e){var t,r=u(null);for(t in e)!0===f(a,e,[t])&&(r[t]=e[t]);return r}function M(e,t){for(;null!==e;){var r=l(e,t);if(r){if(r.get)return A(r.get);if("function"==typeof r.value)return A(r.value)}e=c(e)}return function(e){return console.warn("fallback value for",e),null}}var F=d(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),k=d(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),W=d(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),$=d(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),O=d(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),D=d(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),R=d(["#text"]),N=d(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),U=d(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),j=d(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),H=d(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),J=p(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z=p(/<%[\w\W]*|[\w\W]*%>/gm),V=p(/\${[\w\W]*}/gm),B=p(/^data-[\-\w.\u00B7-\uFFFF]/),G=p(/^aria-[\-\w]+$/),K=p(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),q=p(/^(?:\w+script|data):/i),Z=p(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),X=p(/^html$/i),Y=p(/^[a-z][.\w]*(-[.\w]+)+$/i);return function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,n=function(e){return t(e)};if(n.version="2.5.7",n.removed=[],!r||!r.document||9!==r.document.nodeType)return n.isSupported=!1,n;var a=r.document,i=r.document,s=r.DocumentFragment,c=r.HTMLTemplateElement,l=r.Node,p=r.Element,u=r.NodeFilter,m=r.NamedNodeMap,f=void 0===m?r.NamedNodeMap||r.MozNamedAttrMap:m,g=r.HTMLFormElement,h=r.DOMParser,A=r.trustedTypes,Q=p.prototype,ee=M(Q,"cloneNode"),te=M(Q,"nextSibling"),re=M(Q,"childNodes"),oe=M(Q,"parentNode");if("function"==typeof c){var ne=i.createElement("template");ne.content&&ne.content.ownerDocument&&(i=ne.content.ownerDocument)}var ae=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var o=null,n="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(n)&&(o=r.currentScript.getAttribute(n));var a="dompurify"+(o?"#"+o:"");try{return t.createPolicy(a,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+a+" could not be created."),null}}(A,a),ie=ae?ae.createHTML(""):"",se=i,ce=se.implementation,le=se.createNodeIterator,de=se.createDocumentFragment,pe=se.getElementsByTagName,ue=a.importNode,me={};try{me=L(i).documentMode?i.documentMode:{}}catch(e){}var fe={};n.isSupported="function"==typeof oe&&ce&&void 0!==ce.createHTMLDocument&&9!==me;var ge,he,ye=J,Se=z,Ce=V,be=B,we=G,Ee=q,_e=Z,Pe=Y,Te=K,ve=null,Ie=x({},[].concat(o(F),o(k),o(W),o(O),o(R))),Ae=null,xe=x({},[].concat(o(N),o(U),o(j),o(H))),Le=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Me=null,Fe=null,ke=!0,We=!0,$e=!1,Oe=!0,De=!1,Re=!0,Ne=!1,Ue=!1,je=!1,He=!1,Je=!1,ze=!1,Ve=!0,Be=!1,Ge=!0,Ke=!1,qe={},Ze=null,Xe=x({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ye=null,Qe=x({},["audio","video","img","source","image","track"]),et=null,tt=x({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),rt="http://www.w3.org/1998/Math/MathML",ot="http://www.w3.org/2000/svg",nt="http://www.w3.org/1999/xhtml",at=nt,it=!1,st=null,ct=x({},[rt,ot,nt],w),lt=["application/xhtml+xml","text/html"],dt=null,pt=i.createElement("form"),ut=function(e){return e instanceof RegExp||e instanceof Function},mt=function(t){dt&&dt===t||(t&&"object"===e(t)||(t={}),t=L(t),ge=ge=-1===lt.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,he="application/xhtml+xml"===ge?w:b,ve="ALLOWED_TAGS"in t?x({},t.ALLOWED_TAGS,he):Ie,Ae="ALLOWED_ATTR"in t?x({},t.ALLOWED_ATTR,he):xe,st="ALLOWED_NAMESPACES"in t?x({},t.ALLOWED_NAMESPACES,w):ct,et="ADD_URI_SAFE_ATTR"in t?x(L(tt),t.ADD_URI_SAFE_ATTR,he):tt,Ye="ADD_DATA_URI_TAGS"in t?x(L(Qe),t.ADD_DATA_URI_TAGS,he):Qe,Ze="FORBID_CONTENTS"in t?x({},t.FORBID_CONTENTS,he):Xe,Me="FORBID_TAGS"in t?x({},t.FORBID_TAGS,he):{},Fe="FORBID_ATTR"in t?x({},t.FORBID_ATTR,he):{},qe="USE_PROFILES"in t&&t.USE_PROFILES,ke=!1!==t.ALLOW_ARIA_ATTR,We=!1!==t.ALLOW_DATA_ATTR,$e=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Oe=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,De=t.SAFE_FOR_TEMPLATES||!1,Re=!1!==t.SAFE_FOR_XML,Ne=t.WHOLE_DOCUMENT||!1,He=t.RETURN_DOM||!1,Je=t.RETURN_DOM_FRAGMENT||!1,ze=t.RETURN_TRUSTED_TYPE||!1,je=t.FORCE_BODY||!1,Ve=!1!==t.SANITIZE_DOM,Be=t.SANITIZE_NAMED_PROPS||!1,Ge=!1!==t.KEEP_CONTENT,Ke=t.IN_PLACE||!1,Te=t.ALLOWED_URI_REGEXP||Te,at=t.NAMESPACE||nt,Le=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&ut(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Le.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ut(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Le.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Le.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De&&(We=!1),Je&&(He=!0),qe&&(ve=x({},o(R)),Ae=[],!0===qe.html&&(x(ve,F),x(Ae,N)),!0===qe.svg&&(x(ve,k),x(Ae,U),x(Ae,H)),!0===qe.svgFilters&&(x(ve,W),x(Ae,U),x(Ae,H)),!0===qe.mathMl&&(x(ve,O),x(Ae,j),x(Ae,H))),t.ADD_TAGS&&(ve===Ie&&(ve=L(ve)),x(ve,t.ADD_TAGS,he)),t.ADD_ATTR&&(Ae===xe&&(Ae=L(Ae)),x(Ae,t.ADD_ATTR,he)),t.ADD_URI_SAFE_ATTR&&x(et,t.ADD_URI_SAFE_ATTR,he),t.FORBID_CONTENTS&&(Ze===Xe&&(Ze=L(Ze)),x(Ze,t.FORBID_CONTENTS,he)),Ge&&(ve["#text"]=!0),Ne&&x(ve,["html","head","body"]),ve.table&&(x(ve,["tbody"]),delete Me.tbody),d&&d(t),dt=t)},ft=x({},["mi","mo","mn","ms","mtext"]),gt=x({},["annotation-xml"]),ht=x({},["title","style","font","a","script"]),yt=x({},k);x(yt,W),x(yt,$);var St=x({},O);x(St,D);var Ct=function(e){C(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ie}catch(t){e.remove()}}},bt=function(e,t){try{C(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){C(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Ae[e])if(He||Je)try{Ct(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},wt=function(e){var t,r;if(je)e="<remove></remove>"+e;else{var o=E(e,/^[\r\n\t ]+/);r=o&&o[0]}"application/xhtml+xml"===ge&&at===nt&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var n=ae?ae.createHTML(e):e;if(at===nt)try{t=(new h).parseFromString(n,ge)}catch(e){}if(!t||!t.documentElement){t=ce.createDocument(at,"template",null);try{t.documentElement.innerHTML=it?ie:n}catch(e){}}var a=t.body||t.documentElement;return e&&r&&a.insertBefore(i.createTextNode(r),a.childNodes[0]||null),at===nt?pe.call(t,Ne?"html":"body")[0]:Ne?t.documentElement:a},Et=function(e){return le.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null,!1)},_t=function(e){return e instanceof g&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof f)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Pt=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Tt=function(e,t,r){fe[e]&&y(fe[e],(function(e){e.call(n,t,r,dt)}))},vt=function(e){var t;if(Tt("beforeSanitizeElements",e,null),_t(e))return Ct(e),!0;if(v(/[\u0080-\uFFFF]/,e.nodeName))return Ct(e),!0;var r=he(e.nodeName);if(Tt("uponSanitizeElement",e,{tagName:r,allowedTags:ve}),e.hasChildNodes()&&!Pt(e.firstElementChild)&&(!Pt(e.content)||!Pt(e.content.firstElementChild))&&v(/<[/\w]/g,e.innerHTML)&&v(/<[/\w]/g,e.textContent))return Ct(e),!0;if("select"===r&&v(/<template/i,e.innerHTML))return Ct(e),!0;if(7===e.nodeType)return Ct(e),!0;if(Re&&8===e.nodeType&&v(/<[/\w]/g,e.data))return Ct(e),!0;if(!ve[r]||Me[r]){if(!Me[r]&&At(r)){if(Le.tagNameCheck instanceof RegExp&&v(Le.tagNameCheck,r))return!1;if(Le.tagNameCheck instanceof Function&&Le.tagNameCheck(r))return!1}if(Ge&&!Ze[r]){var o=oe(e)||e.parentNode,a=re(e)||e.childNodes;if(a&&o)for(var i=a.length-1;i>=0;--i){var s=ee(a[i],!0);s.__removalCount=(e.__removalCount||0)+1,o.insertBefore(s,te(e))}}return Ct(e),!0}return e instanceof p&&!function(e){var t=oe(e);t&&t.tagName||(t={namespaceURI:at,tagName:"template"});var r=b(e.tagName),o=b(t.tagName);return!!st[e.namespaceURI]&&(e.namespaceURI===ot?t.namespaceURI===nt?"svg"===r:t.namespaceURI===rt?"svg"===r&&("annotation-xml"===o||ft[o]):Boolean(yt[r]):e.namespaceURI===rt?t.namespaceURI===nt?"math"===r:t.namespaceURI===ot?"math"===r&&gt[o]:Boolean(St[r]):e.namespaceURI===nt?!(t.namespaceURI===ot&&!gt[o])&&!(t.namespaceURI===rt&&!ft[o])&&!St[r]&&(ht[r]||!yt[r]):!("application/xhtml+xml"!==ge||!st[e.namespaceURI]))}(e)?(Ct(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!v(/<\/no(script|embed|frames)/i,e.innerHTML)?(De&&3===e.nodeType&&(t=e.textContent,t=_(t,ye," "),t=_(t,Se," "),t=_(t,Ce," "),e.textContent!==t&&(C(n.removed,{element:e.cloneNode()}),e.textContent=t)),Tt("afterSanitizeElements",e,null),!1):(Ct(e),!0)},It=function(e,t,r){if(Ve&&("id"===t||"name"===t)&&(r in i||r in pt))return!1;if(We&&!Fe[t]&&v(be,t));else if(ke&&v(we,t));else if(!Ae[t]||Fe[t]){if(!(At(e)&&(Le.tagNameCheck instanceof RegExp&&v(Le.tagNameCheck,e)||Le.tagNameCheck instanceof Function&&Le.tagNameCheck(e))&&(Le.attributeNameCheck instanceof RegExp&&v(Le.attributeNameCheck,t)||Le.attributeNameCheck instanceof Function&&Le.attributeNameCheck(t))||"is"===t&&Le.allowCustomizedBuiltInElements&&(Le.tagNameCheck instanceof RegExp&&v(Le.tagNameCheck,r)||Le.tagNameCheck instanceof Function&&Le.tagNameCheck(r))))return!1}else if(et[t]);else if(v(Te,_(r,_e,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==P(r,"data:")||!Ye[e])if($e&&!v(Ee,_(r,_e,"")));else if(r)return!1;return!0},At=function(e){return"annotation-xml"!==e&&E(e,Pe)},xt=function(t){var r,o,a,i;Tt("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ae};for(i=s.length;i--;){var l=r=s[i],d=l.name,p=l.namespaceURI;if(o="value"===d?r.value:T(r.value),a=he(d),c.attrName=a,c.attrValue=o,c.keepAttr=!0,c.forceKeepAttr=void 0,Tt("uponSanitizeAttribute",t,c),o=c.attrValue,!c.forceKeepAttr&&(bt(d,t),c.keepAttr))if(Oe||!v(/\/>/i,o)){De&&(o=_(o,ye," "),o=_(o,Se," "),o=_(o,Ce," "));var u=he(t.nodeName);if(It(u,a,o))if(!Be||"id"!==a&&"name"!==a||(bt(d,t),o="user-content-"+o),Re&&v(/((--!?|])>)|<\/(style|title)/i,o))bt(d,t);else{if(ae&&"object"===e(A)&&"function"==typeof A.getAttributeType)if(p);else switch(A.getAttributeType(u,a)){case"TrustedHTML":o=ae.createHTML(o);break;case"TrustedScriptURL":o=ae.createScriptURL(o)}try{p?t.setAttributeNS(p,d,o):t.setAttribute(d,o),_t(t)?Ct(t):S(n.removed)}catch(e){}}}else bt(d,t)}Tt("afterSanitizeAttributes",t,null)}},Lt=function e(t){var r,o=Et(t);for(Tt("beforeSanitizeShadowDOM",t,null);r=o.nextNode();)Tt("uponSanitizeShadowNode",r,null),vt(r)||(r.content instanceof s&&e(r.content),xt(r));Tt("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(t){var o,i,c,d,p,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((it=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!Pt(t)){if("function"!=typeof t.toString)throw I("toString is not a function");if("string"!=typeof(t=t.toString()))throw I("dirty is not a string, aborting")}if(!n.isSupported){if("object"===e(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(Pt(t))return r.toStaticHTML(t.outerHTML)}return t}if(Ue||mt(u),n.removed=[],"string"==typeof t&&(Ke=!1),Ke){if(t.nodeName){var m=he(t.nodeName);if(!ve[m]||Me[m])throw I("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof l)1===(i=(o=wt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?o=i:o.appendChild(i);else{if(!He&&!De&&!Ne&&-1===t.indexOf("<"))return ae&&ze?ae.createHTML(t):t;if(!(o=wt(t)))return He?null:ze?ie:""}o&&je&&Ct(o.firstChild);for(var f=Et(Ke?t:o);c=f.nextNode();)3===c.nodeType&&c===d||vt(c)||(c.content instanceof s&&Lt(c.content),xt(c),d=c);if(d=null,Ke)return t;if(He){if(Je)for(p=de.call(o.ownerDocument);o.firstChild;)p.appendChild(o.firstChild);else p=o;return(Ae.shadowroot||Ae.shadowrootmod)&&(p=ue.call(a,p,!0)),p}var g=Ne?o.outerHTML:o.innerHTML;return Ne&&ve["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&v(X,o.ownerDocument.doctype.name)&&(g="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+g),De&&(g=_(g,ye," "),g=_(g,Se," "),g=_(g,Ce," ")),ae&&ze?ae.createHTML(g):g},n.setConfig=function(e){mt(e),Ue=!0},n.clearConfig=function(){dt=null,Ue=!1},n.isValidAttribute=function(e,t,r){dt||mt({});var o=he(e),n=he(t);return It(o,n,r)},n.addHook=function(e,t){"function"==typeof t&&(fe[e]=fe[e]||[],C(fe[e],t))},n.removeHook=function(e){if(fe[e])return S(fe[e])},n.removeHooks=function(e){fe[e]&&(fe[e]=[])},n.removeAllHooks=function(){fe={}},n}()}()},6971:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=function(){return void 0===r[o]&&(r[o]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[o]};const r={},o="promises"},4033:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push(`crypto: ${JSON.stringify(e)}`)}}let o=!1;const n="undefined"!=typeof performance?performance:void 0;try{n&&n.now&&n.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push(`perfNow: ${JSON.stringify(e)}`)}for(let r=0;r<e.length;r+=1){try{if(o){t.perfNow=!0;let e=Math.floor(100*n.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push(`Math.random: ${JSON.stringify(e)}`)}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const o=15&e[r];return r+=1,("x"===t?o:3&o|8).toString(16)})),t]}},1819:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},8234:function(e,t,r){"use strict";t.TZ=t.nh=t.kp=t.Hv=t.Wp=void 0;const o=r(8107);t.Wp=o;const n=r(8960);Object.defineProperty(t,"Hv",{enumerable:!0,get:function(){return n.ULS}}),Object.defineProperty(t,"kp",{enumerable:!0,get:function(){return n.TraceLevel}}),Object.defineProperty(t,"nh",{enumerable:!0,get:function(){return n.LogCategory}}),r(6971);const a=r(1180);t.TZ=a;r(765),r(4726);r(4033),r(9792),r(1819)},8960:function(e,t){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(o||(t.LogCategory=o={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,o)=>t.traceTag(0,e,r,o),traceTag:(e,r,o,n)=>t.traceTag(e,r,o,n),debugTrace:(e,r,o)=>t.debugTraceTag(0,e,r,o),debugTraceTag:(e,r,o,n)=>t.debugTraceTag(e,r,o,n),assert:(e,r,o)=>t.assertTag(0,e,r,o),assertTag:(e,r,o,n)=>t.assertTag(e,r,o,n),shipAssert:(e,r,o)=>t.shipAssertTag(0,e,r,o),shipAssertTag:(e,r,o,n)=>t.shipAssertTag(e,r,o,n),dnmTrace:(e,r,o)=>t.dnmTraceTag(0,e,r,o),dnmTraceTag:(e,r,o,n)=>t.dnmTraceTag(e,r,o,n)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,o){console.assert(r,"shipAssertTag:",e,t,o)}assertTag(e,t,r,o){console.assert(r,"assertTag",e,t,o)}traceTag(e,t,r,o){console.log("traceTag",e,o,t,r)}dnmTraceTag(e,t,r,o){console.log("dnmTraceTag",e,o,t,r)}debugTraceTag(e,t,r,o){console.log("debugTraceTag",e,o,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},1180:function(e,t){"use strict";function r(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function o(e,t,o){e[t]=r()-o}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){const t=r(),n=e,a=t,i={},s=(e,t,r)=>function(e,t,r,n,a,i){o(e,"end",r);const s={sessionName:t,result:n?"success":"failure",message:i,marks:e};a(JSON.stringify(s))}(i,n,a,e,t,r);return i.start=0,{mark:e=>(e=>o(i,e,a))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},9792:function(e,t){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(o||(t.TextAreaInputMode=o={}))},765:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=()=>self.performance.now()),function(o){let n=r(),a=o;return{reset(e){null!=e&&(a=e),n=r()},stop(o){const i=r()-n,s=JSON.stringify({Target:a,Duration:i.toFixed(t),StopInfo:o});e(s)}}}};let r=()=>Date.now()},4726:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},8107:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultToJSONResultWhenStringifyFails=void 0,t.forEachPromise=function(e,t,r){return e.reduce(((e,o)=>e.then((()=>r&&r.stop?Promise.resolve(void 0):t(o,r)))),Promise.resolve(void 0))},t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(o(e))}catch{return t.defaultToJSONResultWhenStringifyFails}},t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(a,n).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===n&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===n&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error(`utils.retry: attempts expected to be greater than 0 but got ${t}`));let r=Promise.reject();for(let o=1;o<=t;o+=1)r=r.catch((t=>e(o,t)));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let o=1;o<e.length;o+=1){const n=e[o];r=r.catch((()=>t(n)))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const o=e.length;for(let n=0;n<o&&(t=4294967295&((t<<5)+t^e.charCodeAt(n)),n!==o-1);n+=2)r=4294967295&((r<<5)+r^e.charCodeAt(n+1));let n=t+35685*r+(23896*r<<16)&4294967295;return n<0&&(n+=4294967296),n},t.defaultToJSONResultWhenStringifyFails="...";const r=5;function o(e,t=0){if(t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;const n={};Object.getOwnPropertyNames(e).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(n[t]=e[t])}));const a=Object.getPrototypeOf(e);a&&"object"==typeof a&&Object.keys(a).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(n[t]=e[t])}));const i={};return Object.keys(n).forEach((e=>{i[e]=o(n[e],t+1)})),i}const n="_",a=new RegExp("\\W+","g")},8621:function(e,t){"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},6662:function(e,t){"use strict";function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const o=r(e),n=r(t);let a=[];for(let e=0;e<=n.length;++e)a[e]=e;for(let e=1;e<=o.length;++e){const t=[e];for(let r=1;r<=n.length;++r)t[r]=o[e-1]===n[r-1]?a[r-1]:1+Math.min(a[r],a[r-1],t[r-1]);a=t}return a[n.length]}},6227:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=a,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){const r=i(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=i(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const o=parseFloat(r);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){const r=i(e)?.trim();if(void 0===r)return t;const o=parseInt(r,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const o=r(6662),n={};function a(){return void 0===globalThis.__get_feature_gate_dictionary_variable?n:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return a()[e]??t;const r=a();if(Object.hasOwn(r,e))return r[e]??t;const n=globalThis.__office_online_feature_gates_verbose_log_callback;n(`Failed lookup for FeatureGate ${e}...`);const i=[],s=e.toLowerCase();for(const e of Object.keys(r))(0,o.editDistance)(e.toLowerCase(),s)<=4&&i.push(e);return i.length>0&&n(`Potential candidates found (edit distance <= 4, case-insensitive): [${i.join(", ")}]`),n(`FeatureGate override not found, returning default: ${t}`),t}},4645:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(6533);o.__exportStar(r(6227),t),o.__exportStar(r(4342),t),o.__exportStar(r(8621),t),o.__exportStar(r(3915),t),o.__exportStar(r(3237),t),o.__exportStar(r(2027),t)},4342:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,o.getBooleanFeatureGate)(t,r);case"number":return(0,o.getNumberFeatureGate)(t,r);case"string":return(0,o.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const o=r(6227)},3915:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)};const o=r(8621)},3237:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=n,t.overrideTypedChangeGates=function(e,t){return n(t)};const o=r(8621);function n(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},2027:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=n,t.overrideTypedFeatureGates=function(e,t){return n(t)};const o=r(6227);function n(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,o.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,o.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},8615:function(e,t,r){"use strict";t.domPurifyPolicyHtml=void 0;var o=r(5267);Object.defineProperty(t,"domPurifyPolicyHtml",{enumerable:!0,get:function(){return o.domPurifyPolicyHtml}});r(6401),r(9591),r(5653),r(3059),r(6052),r(3893)},561:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPolicy=void 0;const r={},o="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t};t.createPolicy=(e,t,n=o)=>{try{r[e]||(r[e]=n.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch{console.info(`Skipped duplicate policy creation: ${e}`)}return r[e]}},5653:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bypassPolicy=t.createBypassPolicy=void 0;const o=r(561);t.createBypassPolicy=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>e,createScript:e=>e},t),t.bypassPolicy=(0,t.createBypassPolicy)("bypassPolicy")},3059:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGraphicsEditorTrustedTypesDefaultPolicy=t.createTrustedTypesDefaultPolicy=t.createDefaultPolicyInternal=void 0;const o=r(4645),n=r(561),a=r(6052),i=r(9591);t.createDefaultPolicyInternal=e=>{(0,n.createPolicy)("default",{createHTML:(e,t,r)=>{try{if("Element innerHTML"===r&&ee(W,h))return te.has(e)?e:(0,a.sanitizedHTMLAndValidate)(e);if("DOMParser parseFromString"===r&&ee(D,y)||"Element setAttribute"===r&&ee(K,E))return e}catch{}},createScript:(e,t,r)=>{try{if("eval"===r&&ee(N,C))return e;if("HTMLScriptElement text"===r&&ee(Z,w)&&(e.startsWith("<math display")||e.startsWith("<math xmlns")))return e;if((0,o.isChangeGateEnabled)("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO:10684524_EnableFuncSinkDefaultTTPolicy")&&"Function"===r&&ee(void 0,_))return e}catch{}},createScriptURL:(e,t,r)=>{try{if("Worker constructor"===r&&ee(X,S)||"HTMLScriptElement src"===r&&ee(G,b)){const{origin:t}=new URL(e,document.baseURI);if((0,i.isAnAllowedOrigin)(t))return e}}catch{}}},e)},t.createTrustedTypesDefaultPolicy=()=>(0,t.createDefaultPolicyInternal)(),t.createGraphicsEditorTrustedTypesDefaultPolicy=e=>{try{e.window.trustedTypes?.createPolicy("default",{createHTML:(e,t,r)=>{try{if("Element innerHTML"===r&&ee(A,h))return(0,a.sanitizedHTMLAndValidate)(e)}catch{}}})}catch{}};const s=/https?:\/\/[^\s/$.?#].[^\s]*/g,c=/\/officeonline\/versioned\/mathjax\-lowercase\-patched\/\d{1,10}\.\d{1,10}\.\d{1,10}\/mathjax\/\d{1,10}\.\d{1,10}\.\d{1,10}\/(config\/|jax\/output\/html\-css\/)?/,l=/\/(officeonline\/)?o\/s\/h?([0-9a-fA-F])+_app_scripts\/(wp5\/)?/,d=/\/(officeonline\/)?x\/s\/h?([0-9a-fA-F])+__layouts\/app_scripts\/((wp5|ac|es6)\/)?/,p=/\/1js\/(build|pr)\/[0-9a-fA-F]+/,u=/\/wd1js\/(ship|debug)\/(we|wv|x)\/(_layouts\/)?app_scripts\/((wp5|ac|es6)\/)?/,m=/\/wo\/webpack\/((wp5|ac)\/)?/,f=/\/officeonline\/pods\/s\/(h[0-9a-fA-F]+|\d+)_(app_scripts|pptscripts)\/?/,g=new RegExp(`(${/\/officeonline\/hashed\/[0-9a-fA-F]+\//.source}|${l.source}|${d.source}|${p.source}(${u.source}|${m.source}|/lib-es5/)|${f.source})`),h=/(wordviewerds|meboot|mathjax|jax|mml_htmlormml|common|common50|commonux([0-9a-fA-F\-]){0,10}|jquery(\.signalr\.merge\.\d+\.\d+\.min)?|compatparentelementfix|sharedcommentslazy|richtexteditor|copilotcommonux|copilotcomprehensionux|gc2host|appchrome|pptedit(ds)?(\.debug)?\.(core\.common|core1|core2|core3|precore)|(\@1js\/oscui\-compact\-quill\@\d{1,10}\.\d{1,10}\.\d{1,10}\/[A-Za-z0-9-]+\/v\d{1,10}\/bundled\/dist\/quill\.custom))\.(min\.)?js/,y=/(microsoftajaxds|common|mml_htmlormml|pptedit(ds)?(\.debug)?\.(core1|core2|core3|precore|ext-lazy)|officeextensionmerge)(\.min)?\.js(\:|$)/,S=/(wordeditords(eagercompile|separatedialog|\.debug)?\.(copilotcommon|common([0-9-])*)|recorder|ewats)(\.min)?\.js/,C=/(wordeditords|mathdesigner|microsoftajaxds|pptedit(ds)?(\.debug)?\.core3)\.(min\.)?js/,b=/(dime|wacboot|officewebsurfaces\.core|lpplazy|midgardbootstrapper|mathjax|livepersonacard_with-react_[0-9a-fA-F]{1,30}|pptedit(ds)?(\.debug)?\.(core1|core2|core3|precore))(\.min)?\.js/,w=/(mathjax|wacboot|wordeditords(eagercompile|separatedialog)?(\.box4\.dll1)?)(\.min)?\.js/,E=/(common|copilotcommonux)\.(min\.)?js/,_=/(officebrowserfeedback_floodgate)\.(min\.)?js/,P=new RegExp(`(${g.source})(common|common50|commonux([0-9a-fA-F]|\\-){0,10}|jquery(\\.signalr\\.merge\\.\\d+\\.\\d+\\.min)?|compatparentelementfix|sharedcommentslazy|richtexteditor|appchrome|copilotcommonux|copilotcomprehensionux)\\.(min\\.)?js`),T=new RegExp(`${c.source}(mathjax|jax|mml_htmlormml)\\.js`),v=new RegExp(`${l.source}mathjax/(mathjax)\\.js`),I=new RegExp("/scripts/me/mecontrol/\\d{1,10}\\.\\d{1,10}\\.\\d{1,10}/[a-zA-Z]{1,10}-[a-zA-Z]{1,10}/meboot.min.js"),A=new RegExp(`(/officeonline/versioned/host-word/\\d{1,4}\\.\\d{1,2}\\.\\d{1,2}/|${f.source}|${p.source}(${u.source}|${m.source}|/lib-es5/))(gc2|gc2host)\\.(min\\.)?js`),x=new RegExp(`(${d.source}|${p.source}(${u.source}|${m.source}|/lib-es5/))(gc2host)\\.(min\\.)?js`),L=new RegExp(`(${f.source})(pptedit(ds)?\\.precore)\\.(min\\.)?js`),M=new RegExp(`(${f.source})(pptedit(ds)?\\.core\\.common)\\.(min\\.)?js`),F=new RegExp(`(${f.source})(immersivereader)\\.(min\\.)?js`),k=new RegExp(`(${f.source})(pptedit(ds)?\\.(core1|core2|core3))\\.(min\\.)?js`),W=new RegExp(`(${P.source})|(${T.source})|(${v.source})|(${I.source})|(${A.source})|(${x.source})|(${L.source})|(${M.source})|(${F.source})|(${k.source})`),$=new RegExp(`(${g.source})(microsoftajaxds|common|pptedit(ds)?(.debug)?.(core1|core2|core3|precore|ext-lazy)|officeextensionmerge)\\.(min\\.)?js(\\:|$)`),O=new RegExp(`${c.source}mml_htmlormml.js`),D=new RegExp(`(${$.source})|(${O.source})`),R=new RegExp(`(${d.source}|${p.source}(${u.source}|${m.source}))feedback/officebrowserfeedback_floodgate\\.(min\\.)?js`),N=new RegExp(`((${g.source})(mathdesigner|microsoftajaxds|pptedit(ds)?(.debug)?.core3)\\.(min\\.)?js)|(${R.source})`),U=new RegExp("/office-growth/resources/programmablesurfaces/(int|prod)/officewebsurfaces\\.core\\.(min\\.)?js"),j=new RegExp(`(${g.source}(lpplazy|midgardbootstrapper)|(${c.source}mathjax))\\.(min\\.)?js`),H=new RegExp("/midgard/versionless/livepersonacard_with-react_[0-9a-fA-F]{1,30}\\.(min\\.)?js"),J=new RegExp("/dime/v1/dime\\.js"),z=new RegExp(`(${g.source}(mathjax/mathjax\\.js))`),V=new RegExp(`(${g.source}(pptedit(?:ds)?\\.(precore|core1|core2|core3)\\.js))`),B=new RegExp("/officeonline/p/s/h?[0-9a-fA-F]+_pptscripts/bootviewds\\.js"),G=new RegExp(`${U.source}|${j.source}|${H.source}|${J.source}|${z.source}|${V.source}|${B.source}`),K=new RegExp(`(${g.source})(common|copilotcommonux)\\.(min\\.)?js`),q=new RegExp(`${c.source}mathjax.js`),Z=new RegExp(`((${g.source})wordeditords(eagercompile|separatedialog)?(\\.box4\\.dll1)?\\.js)|(${q.source})`),X=new RegExp(`(${g.source})(wordeditords(eagercompile|separatedialog|\\.debug)?\\.(copilotcommon|common([0-9-])*)|recorder|ewats)\\.(min\\.)?js`),Y=e=>"https://amcdn.msftauth.net"===e||(0,i.isAnAllowedOrigin)(e),Q=e=>i.localhostRegex.test(e),ee=(e,t)=>{try{throw new Error}catch(r){if(!r.stack)return!1;const o=r.stack.match(s);if(!o?.length)return!1;for(const r of o)try{const{origin:o,pathname:n}=new URL(r);if(!Y(o))continue;const a=n.toLowerCase(),i=Q(o)&&t?.test(a),s=e?.test(a);if(s||i)return!0}catch{}return!1}},te=new Set(["","<input/>","<a href='#'></a>","<option></option>","<textarea>x</textarea>","<form></form><form></form>","<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>","Add-ins","Bold (Ctrl+B)","Border Options","Bullets","Bullets (Ctrl+.)","Catch up","Checklist (Ctrl+,)","Click to see page load statistics","Clipboard","Clear Formatting","Comments","Copy (Ctrl+C)","Copilot","Cut (Ctrl+X)","Decrease Indent (Ctrl+Shift+M)","Designer","Dictate","Dictate (Alt+`)","Editor","Emphasis","Find","Find (Ctrl+F)","Font Color","Font Name","Font Size","Format Painter (Ctrl+Alt+C, Ctrl+Alt+V) <br /> To apply the formatting in multiple places, double-click Format Painter.","Grow Font Size (Ctrl+Shift+>)","Heading 1","Heading 2","Headings and Other Styles","Help Improve Office","Highlight","Increase Indent (Ctrl+M)","Italic (Ctrl+I)","Mode Menu: Editing","More Collaboration Options","More Options","Normal","Numbering","Numbering (Ctrl+/)","Line Spacing","Paragraph Options","Paragraph Shading","Paste","RibbonOptionsTooltip","Saved <br /> Click the cloud icon to view file location","Sensitivity","Separate Pages","Set Proofing Language","Share","Share: this file is shared","Show Developer Tools Menu","Shrink Font Size (Ctrl+Shift+<)","Strikethrough (Ctrl+Shift+X)","Subscript (Ctrl+Shift+-)","Subtitle","Superscript (Ctrl+Shift++)","Switch to light background","Text Alignment","The current page number in the document. Click or tap to open the Navigation Pane.","The number of words in the selection or document. Click or tap to open the word count dialog box.","Title","Underline (Ctrl+U)","Undo","Undo (Ctrl+Z)","Zoom","Zoom In","Zoom Level","Zoom Out","Zoom to fit page width"])},5371:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testContent=t.htmlBlockListAttributes=t.htmlBlockList=t.defaultConfig=void 0,t.defaultConfig={ADD_TAGS:["#comment"],RETURN_TRUSTED_TYPE:!1},t.htmlBlockList=["applet","base","basefont","command","embed","frame","frameset","keygen","link","meta","noframes","noscript","object","param","script","title"],t.htmlBlockListAttributes=["contenteditable","contextmenu","controls","data","decoding","defer","dirname","draggable","dropzone","form","formaction","http-equiv","icon","importance","itemprop","keytype","kind","language","lazyload","manifest","minlength","muted","ping","sandbox","scoped","slot","spellcheck","srcdoc","srclang","start","target","translate","wrap","onerror","onclick","onload","onmouseover","onfocus","onblur","src","href"],t.testContent={maliciousHTML:"<div onerror=\"alert('XSS')\"></div>",maliciousSVG:'<svg><circle cx="50" cy="50" r="40" onclick="alert(\'XSS\')"></circle></svg>',maliciousMathML:"<math><msup><mi>x</mi><mn>2</mn></msup><div onclick=\"alert('XSS')\"></div></math>",sanitizedHTML:"<div></div>",sanitizedSVG:'<svg><circle r="40" cy="50" cx="50"></circle></svg>',sanitizedMathML:"<math><msup><mi>x</mi><mn>2</mn></msup></math><div></div>",missingAttrHTML:['<div paraid="example"></div>','<div lang="en"></div>'],missingTagsHTML:['<div class="InsertMediaM365Dialog" id="insertmediadialog"> <div class="InsertMediaM365Panel" id="insertmediapanel"> <iframe id="insertmediaframe" class="InsertMediaFrame" name="InsertMediaFrame"></iframe></div></div>',"\x3c!-- This is a comment --\x3e<div>Content</div>"]}},5267:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domPurifyPolicyHtml=t.createDomPurifyPolicyHtml=void 0;const o=r(561),n=r(6052);t.createDomPurifyPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:(e,t,r)=>(0,n.sanitizedHTMLAndValidate)(e,t,r)},t),t.domPurifyPolicyHtml=(0,t.createDomPurifyPolicyHtml)("domPurifyHTML")},6052:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domPurifyIsValidAttribute=t.sanitizedHTMLAndValidate=void 0;const o=r(6533),n=r(8805),a=o.__importStar(r(5371));t.sanitizedHTMLAndValidate=(e,t,r)=>{let o=!1;const i=t?(e=>({...a.defaultConfig,ALLOW_ARIA_ATTR:!1!==e.ALLOW_ARIA_ATTR,ALLOW_DATA_ATTR:!1!==e.ALLOW_DATA_ATTR,FORCE_BODY:e.FORCE_BODY||!1,IN_PLACE:e.IN_PLACE||!1,SAFE_FOR_TEMPLATES:e.SAFE_FOR_TEMPLATES||!1,SANITIZE_DOM:!1!==e.SANITIZE_DOM,SANITIZE_NAMED_PROPS:e.SANITIZE_NAMED_PROPS||!1,USE_PROFILES:!!e.USE_PROFILES&&e.USE_PROFILES,WHOLE_DOCUMENT:e.WHOLE_DOCUMENT||!1,PARSER_MEDIA_TYPE:e.PARSER_MEDIA_TYPE?e.PARSER_MEDIA_TYPE:"text/html"}))(t):a.defaultConfig;r&&Object.entries(r).forEach((([e,t])=>{(0,n.addHook)(e,t)}));const s=(0,n.sanitize)(e,i);return r&&Object.entries(r).forEach((([e])=>{(0,n.removeHooks)(e)})),t?.USE_PROFILES?s:(o=(e=>{let t=!1,r=!1;const o=new Set,n=new Set;return e.length>0&&(e.forEach((e=>{e.attribute?(r=a.htmlBlockListAttributes.includes(e.attribute.localName)||r,o.add(e.attribute.localName)):e.element&&(r=a.htmlBlockList.includes(e.element.localName)||r,n.add(e.element.localName))})),(o.size>0||n.size>0)&&(r||(t=!0))),t})(n.removed),o?e:s)},t.domPurifyIsValidAttribute=n.isValidAttribute},6401:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emptyStringPolicyURL=t.createEmptyStringPolicyURL=t.emptyStringPolicyHTML=t.createEmptyStringPolicyHtml=void 0;const o=r(561);t.createEmptyStringPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>""},t),t.emptyStringPolicyHTML=(0,t.createEmptyStringPolicyHtml)("emptyStringPolicyHTML"),t.createEmptyStringPolicyURL=(e,t)=>(0,o.createPolicy)(e,{createScriptURL:e=>""},t),t.emptyStringPolicyURL=(0,t.createEmptyStringPolicyURL)("emptyStringPolicyURL")},9591:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urlOriginPolicy=t.createUrlOriginPolicy=t.isAnAllowedOrigin=t.localhostRegex=t.setRuntimeAllowedOrigins=void 0;const o=r(561),n=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-v-sdf.cdn.office.net","https://res-v.cdn.office.net","https://uci.edog.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-h1.cdn.office.net","https://res-1-sdf.cdn.office.net","https://res-2-sdf.cdn.office.net","https://res-1-dev.cdn.officeppe.net","https://res-2-dev.cdn.officeppe.net","https://content.lifecycle.office.net","https://content.lifecycle.officeppe.net","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://res-1.public.onecdn.static.microsoft","https://wordwebclientbuilds.blob.core.windows.net","https://js.live.net","https://c5-onenote-15.cdn.office.net","https://s1-onenote-gcc-15.cdn.office.net","https://ffc-powerpoint.officeapps.live.com","https://ppc-powerpoint.officeapps.live.com","https://powerpoint.officeapps.live.com","https://eurppc-powerpoint.officeapps.live.com","https://ffc-powerpoint.officeapps.live.com","https://fil1-powerpoint.officeapps.live.com","https://fin1-powerpoint.officeapps.live.com","https://fus1-powerpoint.officeapps.live.com","https://gbc-powerpoint.officeapps.live.com","https://jpc-powerpoint.officeapps.live.com","https://usc-powerpoint.officeapps.live.com"].map((e=>e.trim()));let a=[];t.setRuntimeAllowedOrigins=e=>{a=a.concat(e)};const i=[/^https?:\/\/([0-9a-zA-Z]+-)?(onenote|word-edit|word-view|excel)\.officeapps\.live\.com$/],s=[/^https?:\/\/([\w-]+-)?(excel)(-[\w-]+)?\.cdn\.office\.net$/];t.localhostRegex=new RegExp("https?://((localhost|local\\.teams\\.(office|live)\\.com|cpc-[\\w-]+|[\\w-]+\\.[\\w-]+\\.corp\\.microsoft\\.com)(:\\d+)?)(:|/|$)"),t.isAnAllowedOrigin=e=>n.includes(e)||a.includes(e)||i.some((t=>t.test(e)))||s.some((t=>t.test(e)))||t.localhostRegex.test(e),t.createUrlOriginPolicy=(e,r)=>(0,o.createPolicy)(e,{createScriptURL:e=>{let r;try{r=new URL(e,document.baseURI)?.origin}catch(t){r=new URL(e)?.origin}if(r&&(0,t.isAnAllowedOrigin)(r))return e;throw new Error(`TrustedTypes policy does not allow loading URL: ${e} with origin: ${r}`)}},r),t.urlOriginPolicy=(0,t.createUrlOriginPolicy)("urlOriginPolicy")},3893:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidStringPolicyHTML=t.createUUIDStringPolicyHtml=void 0;const o=r(561);t.createUUIDStringPolicyHtml=(e,t)=>(0,o.createPolicy)(e,{createHTML:e=>{if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e))return e;throw new Error("TrustedTypes policy: The provided value is not a valid UUID and cannot be used to create TrustedHTML")}},t),t.uuidStringPolicyHTML=(0,t.createUUIDStringPolicyHtml)("uuidStringPolicyHTML")},6533:function(e,t,r){"use strict";r.r(t),r.d(t,{__addDisposableResource:function(){return W},__assign:function(){return a},__asyncDelegator:function(){return T},__asyncGenerator:function(){return P},__asyncValues:function(){return v},__await:function(){return _},__awaiter:function(){return f},__classPrivateFieldGet:function(){return M},__classPrivateFieldIn:function(){return k},__classPrivateFieldSet:function(){return F},__createBinding:function(){return h},__decorate:function(){return s},__disposeResources:function(){return O},__esDecorate:function(){return l},__exportStar:function(){return y},__extends:function(){return n},__generator:function(){return g},__importDefault:function(){return L},__importStar:function(){return x},__makeTemplateObject:function(){return I},__metadata:function(){return m},__param:function(){return c},__propKey:function(){return p},__read:function(){return C},__rest:function(){return i},__runInitializers:function(){return d},__setFunctionName:function(){return u},__spread:function(){return b},__spreadArray:function(){return E},__spreadArrays:function(){return w},__values:function(){return S},default:function(){return D}});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function s(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,o){t(r,o,e)}}function l(e,t,r,o,n,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=o.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?o.static?e:e.prototype:null,p=t||(d?Object.getOwnPropertyDescriptor(d,o.name):{}),u=!1,m=r.length-1;m>=0;m--){var f={};for(var g in o)f[g]="access"===g?{}:o[g];for(var g in o.access)f.access[g]=o.access[g];f.addInitializer=function(e){if(u)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var h=(0,r[m])("accessor"===c?{get:p.get,set:p.set}:p[l],f);if("accessor"===c){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(s=i(h.get))&&(p.get=s),(s=i(h.set))&&(p.set=s),(s=i(h.init))&&n.unshift(s)}else(s=i(h))&&("field"===c?n.unshift(s):p[l]=s)}d&&Object.defineProperty(d,o.name,p),u=!0}function d(e,t,r){for(var o=arguments.length>2,n=0;n<t.length;n++)r=o?t[n].call(e,r):t[n].call(e);return o?r:void 0}function p(e){return"symbol"==typeof e?e:"".concat(e)}function u(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,o){return new(r||(r=Promise))((function(n,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((o=o.apply(e,t||[])).next())}))}function g(e,t){var r,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((n=(n=i.trys).length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){i.label=s[1];break}if(6===s[0]&&i.label<n[1]){i.label=n[1],n=s;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(s);break}n[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var h=Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function S(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function C(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(C(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,n++)o[n]=a[i];return o}function E(e,t,r){if(r||2===arguments.length)for(var o,n=0,a=t.length;n<a;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function _(e){return this instanceof _?(this.v=e,this):new _(e)}function P(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),a=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){n[e]&&(o[e]=function(t){return new Promise((function(r,o){a.push([e,t,r,o])>1||s(e,t)}))})}function s(e,t){try{(r=n[e](t)).value instanceof _?Promise.resolve(r.value.v).then(c,l):d(a[0][2],r)}catch(e){d(a[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function T(e){var t,r;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:_(e[o](t)),done:!1}:n?n(t):t}:n}}function v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=S(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(o,n){!function(e,t,r,o){Promise.resolve(o).then((function(t){e({value:t,done:r})}),t)}(o,n,(t=e[r](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function x(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return A(t,e),t}function L(e){return e&&e.__esModule?e:{default:e}}function M(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function F(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}function k(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function W(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose]}if("function"!=typeof o)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:o,async:r})}else r&&e.stack.push({async:!0});return t}var $="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var o=new Error(r);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function O(e){function t(t){e.error=e.hasError?new $(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var o=e.stack.pop();try{var n=o.dispose&&o.dispose.call(o.value);if(o.async)return Promise.resolve(n).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const D={__extends:n,__assign:a,__rest:i,__decorate:s,__param:c,__metadata:m,__awaiter:f,__generator:g,__createBinding:h,__exportStar:y,__values:S,__read:C,__spread:b,__spreadArrays:w,__spreadArray:E,__await:_,__asyncGenerator:P,__asyncDelegator:T,__asyncValues:v,__makeTemplateObject:I,__importStar:x,__importDefault:L,__classPrivateFieldGet:M,__classPrivateFieldSet:F,__classPrivateFieldIn:k,__addDisposableResource:W,__disposeResources:O}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,r),a.exports}r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};!function(){"use strict";r.r(o),r.d(o,{BaseError:function(){return T},CCPError:function(){return O},CancelError:function(){return N},CancelErrorTypes:function(){return b},ClipboardPlatformError:function(){return U},ClipboardPlatformErrorTypes:function(){return y},ClipboardStorageType:function(){return Re},ClipboardStrategyBase:function(){return Wt},ClipboardStrategyType:function(){return h},CopyClipboardCommand:function(){return ne},CopyClipboardEvent:function(){return se},CopyContext:function(){return mr},CopyError:function(){return D},CopyErrorTypes:function(){return S},CopyStatus:function(){return gr},CutClipboardCommand:function(){return ae},CutClipboardEvent:function(){return ce},CutCopyPasteFlags:function(){return Ne},InfraInitializationErrorTypes:function(){return Ue},InvalidArgumentError:function(){return A},InvalidOperationError:function(){return x},LocalStorageChangedEventFlagPostfix:function(){return cr},LocalStorageClipboardStorage:function(){return Cr},LocalStorageClipboardStrategy:function(){return wr},LocalStorageKeyChangeTracker:function(){return Er},MessageDestinationConst:function(){return At},MismatchVersionError:function(){return M},MissingArgumentError:function(){return I},NoUserHash:function(){return wt},NoValidKeyError:function(){return v},PasteClipboardCommand:function(){return ie},PasteClipboardEvent:function(){return le},PasteContext:function(){return fr},PasteError:function(){return R},PasteErrorTypes:function(){return C},SharedClipboardError:function(){return j},TTLClipboardDataError:function(){return F},UnexpectedError:function(){return W},UnsupportedError:function(){return L},UserHashMismatchError:function(){return k},WindowRPCBase:function(){return qt},addEventListener:function(){return de},cloneMetadata:function(){return yr},createClipboardItems:function(){return Le},createClipboardOperationMessage:function(){return It},createClipboardOperationResultMessage:function(){return Mt},createContextId:function(){return Pt},createCopyPasteInfra:function(){return lo},createDeferredPromise:function(){return Ot},createDeferredPromiseCache:function(){return jt},createDisposableImplementationExtension:function(){return kt},createLocalStorageClipboardStorage:function(){return Sr},createLocalStorageClipboardStrategy:function(){return br},createMessageDeserializer:function(){return Jt},createMessageId:function(){return _t},createMessageSerializer:function(){return zt},createWindowRPCClientReceiver:function(){return Qt},createWindowRPCClientSender:function(){return or},createWindowRPCServerReceiver:function(){return Yt},createWindowRPCServerSender:function(){return rr},defaultClipboardDataFormat:function(){return pe},defaultIEClipboardDataFormat:function(){return ue},emptyString:function(){return p},getCanonicalValidatedMessageId:function(){return Tt},getClipboardItem:function(){return We},getClipboardItemContent:function(){return Me},getClipboardItemsCount:function(){return xe},getClipboardItemsDataCount:function(){return Ae},getDefaultClipboardData:function(){return $e},getDeferredClipboardItemContent:function(){return Fe},getEmptyClipboardItemsData:function(){return Te},getEmptyMetadata:function(){return hr},getImmutableEmptyClipboardItems:function(){return Ie},getItemsFromClipboardItems:function(){return Oe},getLocalStorageDataKey:function(){return dr},getLocalStorageMetadataKey:function(){return pr},getLocalStorageMetadataKeyToWatch:function(){return ur},getSharedClipboardValidatedOrigin:function(){return ft},getStringifiedError:function(){return uo.getStringifiedError},getValidatedRemoteWindow:function(){return Kt},getWindowLocation:function(){return rt},getWindowMessaging:function(){return re},htmlClipboardItem:function(){return t},imageClipboardDataFormat:function(){return fe},init:function(){return B},initLogger:function(){return d},initMessageIdPrefix:function(){return Vt},isChromiumEdge:function(){return te},isClipboardPlatformErrorType:function(){return w},isClipboardPlatformErrorTypes:function(){return E},isEdge:function(){return Y},isEdgeVersionWithTextHtmlWrapperSupport:function(){return ee},isEdgeWithTextHtmlClipboardSupport:function(){return Q},isIE:function(){return X},isLocalStorageInaccessible:function(){return _},isLocalStorageSupported:function(){return lr},isValidClipboardOperationCode:function(){return xt},metadataAdditionalSignatureDataAttributes:function(){return Ee},metadataChromeExtensionId:function(){return Ce},metadataCopyContextClipboardDataFormat:function(){return _e},metadataCopyContextWebCustomDataFormat:function(){return Pe},metadataCopyId:function(){return we},metadataInfraVersionFormat:function(){return be},metadataIsLastCopyWasExternal:function(){return ye},metadataIsLastCopyWasExternalXLOSource:function(){return Se},metadataLastCopyWasExternal:function(){return f},metadataLastCopyWasExternalXLOSource:function(){return g},oneDot:function(){return m},oneSpace:function(){return u},queryStringBulsEndpointUrlParameter:function(){return je},queryStringCreatorOriginParameter:function(){return Gt},queryStringSessionIdParameter:function(){return Je},queryStringWacClusterParameter:function(){return He},rethrowAfterAllActions:function(){return H},setCopyPasteInfraFeatureGateManager:function(){return mo},shadowWorkbookClipboardDataFormat:function(){return ge},shadowWorkbookClipboardWebCustomDataFormat:function(){return he},sharedClipboardSettings:function(){return e},shouldClearClipboard:function(){return Et},textHtmlClipboardDataFormat:function(){return me},ulsLogger:function(){return l},unknownMessageId:function(){return Bt},validateClipboardOperationMessage:function(){return Lt},validateClipboardOperationResultMessage:function(){return Ft},validateRemoteWindowOrigin:function(){return gt}});var e={};r.r(e),r.d(e,{createEmptySharedClipboardSettings:function(){return tt},defaultPromiseTimeoutInMinutes:function(){return Ke},getSharedClipboardSettings:function(){return Xe},initializeSharedClipboardSettings:function(){return Qe},initializeSharedClipboardSettingsFromWindow:function(){return Ye},sharedClipboardSettingsVariableName:function(){return Ve}});var t={};let n;r.r(t),r.d(t,{addClipboardWrapperForEdge:function(){return ro},ccpTimestampHtmlCustomAttributeName:function(){return Gr},createHtmlItemFromTextPlain:function(){return Yr},createPlainTextFromHtml:function(){return Qr},createTextHtmlFromTextPlain:function(){return Xr},divTagName:function(){return Wr},encodeAngleBrackets:function(){return io},ensureOneLFPerNewLine:function(){return qr},getCcpTimestampHtmlCustomAttributeFromWrappingTag:function(){return no},getExternalSource:function(){return ao},getFragmentFromTextHtml:function(){return oo},isContainsTimestampWrapper:function(){return to},minCcpTimestampHtmlCustomAttributeValue:function(){return Kr},preTagName:function(){return $r},tableTagName:function(){return Or},tdTagName:function(){return Rr},trTagName:function(){return Dr},trimToLength:function(){return Zr},wrapContentWithTagAndAttributes:function(){return so}});const a=e=>{n=e};class i{static setFeatureGateManager(e){a(e)}}var s=r(8234);let c;function l(){return c}function d(e){if(!e)throw new Error("The 'logger' argument is missing");c=s.Hv.getFromExternalLogger(e)}const p="",u=" ",m=".",f="1",g="1";var h,y,S,C,b;function w(e,t){return E(e,[t])}function E(e,t){if(!function(e){if(!e||"object"!=typeof e||!("reason"in e))return!1;return!!function(e){if(!e&&0!==e)return!1;const t=Number(e);return!isNaN(t)&&t.toString()===e.toString()}(e.reason)}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;const r=e.reason;return t.indexOf(r)>=0}function _(e){if(e&&"object"==typeof e){if(P(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(P(JSON.parse(e.innerError).reason))return!0}catch{}}if("string"==typeof e)try{if(P(JSON.parse(e).reason))return!0}catch{}return!1}function P(e){return e===y.LocalStorageInitilizationInaccessible}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",e[e.AsyncSystemClipboard=8]="AsyncSystemClipboard",e[e.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage",e[e.AsyncSystemClipboardAndInMemory=10]="AsyncSystemClipboardAndInMemory"}(h||(h={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage",e[e.AsyncClipboardReadFailure=44]="AsyncClipboardReadFailure",e[e.AsyncClipboardWriteFailure=45]="AsyncClipboardWriteFailure"}(y||(y={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(S||(S={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext",e[e.FailedToReadFromAsyncClipboard=16]="FailedToReadFromAsyncClipboard"}(C||(C={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(b||(b={}));class T extends Error{static augmentParameterValue(e){return e&&"string"==typeof e?e.trim():p}constructor(e,t,r){const o=T.augmentParameterValue(e);if(super(o),this.name=T.augmentParameterValue(t),this.errorName=this.name,this.name?l().ULS.traceTag(596456211,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Error '${this.name}': ${o}`):l().ULS.traceTag(596456212,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Error message: ${o}`),r){this.innerError=r;let e=this.innerError.message;e||(e=this.innerError.name);const t=T.augmentParameterValue(e);t.length>0&&l().ULS.traceTag(596456213,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Inner error message: ${t}`)}this.stack||(this.stack=(new Error).stack)}}class v extends T{constructor(e,t){super(e,"NoValidKeyError",t)}}class I extends T{static getDefaultMessage(e){let t="Missing argument";return e.length>0&&(t=`Missing argument: '${e}'`),t}constructor(e,t,r){const o=T.augmentParameterValue(t),n=I.getDefaultMessage(o);let a=T.augmentParameterValue(e);0===a.length&&(a=n),super(a,"MissingArgumentError",r),this.name=o}}class A extends T{static getDefaultMessage(e,t){return e.length>0?`Invalid '${e}' argument: '${t}'`:"Invalid argument"}constructor(e,t,r,o){const n=T.augmentParameterValue(t);let a=r;a||(a=p);const i=A.getDefaultMessage(n,a);let s=T.augmentParameterValue(e);0===e.length&&(s=i),super(s,"InvalidArgumentError",o),this.name=n,this.value=a}}class x extends T{constructor(e,t){super(e,"InvalidOperationError",t)}}class L extends T{constructor(e,t){super(e,"UnsupportedError",t)}}class M extends T{constructor(e,t,r,o,n){super(`${e}. Data version: ${t}, Infra version: ${r}, blockMismatchDataVersion: ${o}`,"MismatchVersionError",n)}}class F extends T{constructor(e,t,r,o){super(`${e}. Duration in clipboard (ms) : ${t}, TTL (ms): ${r}`,"TTLClipboardDataError",o)}}class k extends T{constructor(e,t,r,o){super(`${e}. Data User Hash : ${t}, infra User Hash: ${r}`,"UserHashMismatchError",o)}}class W extends T{constructor(e,t){super(e,"UnexpectedError",t)}}function $(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:p}class O extends T{constructor(e,t,r,o,n){super(t||`reason=${e}`,r,o),this.reason=e,n&&(this.errorName=n)}}class D extends O{constructor(e,t,r){super(e,t,"CopyError",r,$(e,S))}}class R extends O{constructor(e,t,r){super(e,t,"PasteError",r,$(e,C))}}class N extends O{constructor(e,t,r){super(e,t,"CancelError",r,$(e,b))}}class U extends O{constructor(e,t,r){super(e,t,"ClipboardPlatformError",r,$(e,y))}}class j extends O{constructor(e,t,r){super(e,t,"SharedClipboardError",r,$(e,y))}}function H(e){if(!e||!Array.isArray(e)||0===e.length)return void l().ULS.traceTag(596456214,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,"rethrowAfterAllActions: no actions to execute");let t,r=0;if(e.forEach((e=>{if(r+=1,e)try{e()}catch(e){l().ULS.traceTag(596456216,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`rethrowAfterAllActions: callback action #${r} threw an exception: ${e.message}`),t||(t=new x(e.message,e))}else l().ULS.traceTag(596456215,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`rethrowAfterAllActions: callback action #${r} is empty`)})),t)throw t}function J(){return z}const z={userAgent:()=>window&&window.navigator?window.navigator.userAgent:p,appVersion:()=>window&&window.navigator?window.navigator.appVersion:p};let V={};function B(){V={}}const G=new RegExp("(\\bTrident/| MSIE )"),K=16.16299,q=17.17123,Z=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function X(){if(void 0===V.isIEProperty){V.isIEProperty=!1;const e=J();if(e&&e.userAgent&&"function"==typeof e.userAgent){const t=e.userAgent();if(t){const e=t.match(G);e&&2===e.length&&(V.isIEProperty=!0)}}}return V.isIEProperty}function Y(){if(void 0===V.isEdgeProperty){V.isEdgeProperty=!1,V.isEdgeWithTextHtmlClipboardSupportProperty=!1,V.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;const e=J();if(e&&e.appVersion&&"function"==typeof e.appVersion){const t=e.appVersion();if(t){const e=t.match(Z);if(e&&2===e.length){V.isEdgeProperty=!0;const t=Number(e[1]);isNaN(t)||(t>=K&&(V.isEdgeWithTextHtmlClipboardSupportProperty=!0),t>=q&&(V.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return V.isEdgeProperty}function Q(){return Y()&&V.isEdgeWithTextHtmlClipboardSupportProperty}function ee(){return Y()&&V.isEdgeVersionWithTextHtmlWrapperSupportProperty}function te(){const e=J();let t=!1;if(e&&e.userAgent){const r=e.userAgent();r&&r.indexOf("Edg/")>=0&&(t=!0)}return t}function re(){return oe}const oe={postMessage:(e,t,r,o)=>{e.postMessage(t,r,o)}},ne="copy",ae="cut",ie="paste",se="copy",ce="cut",le="paste",de=(e,t,r,o=!1)=>(e.addEventListener(t,r,o),()=>{e.removeEventListener(t,r,o)}),pe="text/plain",ue="Text",me="text/html",fe="image/png",ge="data/shadow-workbook",he="web data/shadow-workbook",ye="metadata/is-last-copy-was-external",Se="metadata/is-last-copy-was-external-XLO-source",Ce="metadata/chrome-extension-id",be="metadata/ccp-infra-version",we="copyId",Ee="metadata/additional-signature-data-attributes",_e="metadata/copy-context",Pe="web metadata/copy-context";function Te(){return{items:{}}}const ve=function(){const e={items:{}};return{getData:()=>e,getItem:e=>{},setItem:(e,t)=>{throw new x(`Cannot set an item with clipboard data format '${e}' in an immutable empty clipboard (content is ${t&&t.length>0?"not ":p}empty)`)},setDeferredItem:(e,t)=>{throw new x(`Cannot set a deferred item with clipboard data format '${e}' in an immutable empty clipboard`)},hasDeferredItem:e=>!1,getDeferredItem:e=>{},get:()=>De(void 0)}}();function Ie(){return ve}function Ae(e){return e&&e.items?Object.keys(e.items).length:0}function xe(e){return Ae(e&&e.getData())}function Le(e=void 0){let t=e;return t||(t={items:{}}),{getItem:e=>Me(t,e),setItem:(e,r)=>{ke(t,e,r)},setDeferredItem:(e,r)=>{ke(t,e,r)},hasDeferredItem:e=>{if(!t||!t.items)return!1;const r=t.items[e];return!!r&&r instanceof Promise},getDeferredItem:e=>Fe(t,e),getData:()=>t,get:()=>De(t)}}function Me(e,t){if(!e)throw new I(p,"clipboardItemsData");if(!e.items)throw new A(p,"clipboardItemsData.items");const r=e.items[t];if(!(r&&r instanceof Promise))return r}function Fe(e,t){if(!e)throw new I(p,"clipboardItemsData");if(!e.items)throw new A(p,"clipboardItemsData.items");const r=e.items[t];return!r||r instanceof Promise?r:Promise.resolve(new Blob([r],{type:pe}))}function ke(e,t,r){if(!e)throw new I(p,"clipboardItemsData");if(!e.items)throw new A(p,"clipboardItemsData.items");e.items[t]=r}function We(e,t){if(!e||0===e.length||!t||!t.trim())return p;let r;return e.forEach((e=>{e.clipboardDataFormat!==t||e.deferred||(r=e.data)})),r||p}function $e(e){return We(e,pe)}function Oe(e){let t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:pe,data:p}),t}function De(e){const t=[];if(0===Ae(e))return t;for(const r in e.items){let o=e.items[r];o||(o=p);const n={clipboardDataFormat:r,data:o,deferred:o instanceof Promise};t.push(n)}return t}var Re,Ne,Ue;!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage",e[e.AsyncSystemClipboard=4]="AsyncSystemClipboard"}(Re||(Re={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.ColumnWidths=4096]="ColumnWidths",e[e.Copilot=8192]="Copilot",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell",e[e.PasteWithColumnWidths=4100]="PasteWithColumnWidths",e[e.PasteWithCopilot=8196]="PasteWithCopilot"}(Ne||(Ne={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(Ue||(Ue={}));const je="BulsEndpointUrl",He="WacCluster",Je="usid",ze="-",Ve="sharedClipboardSettings",Be=1,Ge=3600,Ke=2;let qe=tt(),Ze=!1;function Xe(){if(!Ze)throw new x("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return qe}function Ye(){Ze=!1,function(){if(!window||!(Ve in window))return qe=tt(),void(Ze=!0);const e=window[Ve];if(!e||"object"!=typeof e)return qe=tt(),void(Ze=!0);et(e)}()}function Qe(e){Ze=!1,et(e)}function et(e){if(!e)throw new I(p,"sharedClipboardSettingsCandidate");const t=tt();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return qe=t,void(Ze=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return l().ULS.traceTag(596124181,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),qe=t,void(Ze=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();let r=t.sharedClipboardHostingApp;const o=r.indexOf(ze);o>=0&&(r=r.substr(o+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch{l().ULS.traceTag(579737680,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((e=>!e||!e.trim())))return l().ULS.traceTag(596124182,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=p,t.sharedClipboardHostingApps=[],qe=t,void(Ze=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch{l().ULS.traceTag(579737681,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((e=>!e||!e.trim())))return l().ULS.traceTag(596124183,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=p,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],qe=t,void(Ze=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return l().ULS.traceTag(596124184,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=p,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],qe=t,void(Ze=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return l().ULS.traceTag(596124185,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' or '${r}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=p,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],qe=t,void(Ze=!0)}t.whitelistOriginComponents=!0,qe=t,Ze=!0}function tt(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:p,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:Be,sharedClipboardExpirationInMinutes:Ge,clipboardPromiseTimeoutInMinutes:Ke,remoteLoggerPath:p}}function rt(){let e=p;return window&&window.location&&window.location.origin?(e=window.location.origin,e||(e=p)):(l().ULS.traceTag(595932950,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`windowLocation.getWindowLocation: is window exist: ${!!window}. is window.location exist: ${window&&!!window.location}. is window.location.origin exist ${window&&window.location&&!!window.location.origin}. is window.location.protocol exist ${window&&window.location&&!!window.location.protocol}. is window.location.hostname exist ${window&&window.location&&!!window.location.hostname}. is window.location.port exist ${window&&window.location&&!!window.location.port}`),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}const ot="://",nt="http",at="https",it=".",st="/",ct=":",lt=new RegExp("^\\d+$");let dt,pt,ut=!1;function mt(e){if(!e)throw new I(p,"origin");const t=e.trim().toLowerCase();let r=p,o=t.split(ot,3);if(!o||0===o.length||!o[0]||o[0]!==nt&&o[0]!==at)throw new A("Missing protocol","origin",e);if(1===o.length)throw new A("Missing domain","origin",e);if(o.length>2)throw new A(`'${ot}' should appear once`,"origin",e);let n=o[1];if(!n)throw new A("Missing domain","origin",e);if(r=o[0]+ot,n=n.trim(),o=n.trim().split(st,3),!o||0===o.length||!o[0]||!o[0].trim())throw new A("Missing domain","origin",e);if(o.length>2)throw new A("The last part of the origin should be the domain","origin",e);if(2===o.length&&o[1])throw new A("The last part of the origin should be the domain","origin",e);if(o=n.split(ct,3),!o||0===o.length||!o[0]||!o[0].trim())throw new A("Missing domain","origin",e);if(o.length>2||2===o.length&&(!o[1]||!o[1].trim()))throw new A("The last part of the origin should be the domain and an optional port number","origin",e);if(n=o[0].trim(),r+=n,2===o.length){const t=o[1].trim(),n=lt.exec(t);if(!n||1!==n.length)throw new A("Invalid port number","origin",e);const a=Number(t);if(isNaN(a))throw new A("Invalid port number","origin",e);r+=ct+t}return l().ULS.traceTag(596452423,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`getValidatedOrigin: origin = '${e}'; validated origin = '${r}'`),r}function ft(e){Ct();const t=mt(e);let r=t.split(ot);if(!r||2!==r.length||!r[0]||!r[1])throw new A("Invalid origin","parentOrigin",e);const o=Xe();let n=p;if(o.whitelistOriginComponents){const t=r[0]+ot;if(r=r[1].split(it),!r||r.length<2||!r[0])throw new A("Invalid origin","parentOrigin",e);r.splice(0,1,o.sharedClipboardHostingApp),n=t+r.join(it)}else n=t;return l().ULS.traceTag(596452424,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`getSharedClipboardValidatedOrigin: app's origin = '${e}'; Shared Clipboard iframe origin = '${n}' components=${JSON.stringify(r)}`),n}function gt(e){Ct();const t=mt(e),r=mt(rt().origin);if(t===r)return t;if(!Xe().whitelistOriginComponents)throw new x(`validateOriginForReceivedMessage: Caller origin '${e}' doesn't match the current window's origin '${r}'`);const o=ht(t),n=ht(r);if(o.protocol!==n.protocol)throw new x(`validateRemoteWindowOrigin: Caller origin's protocol '${o.protocol}' doesn't match the current window origin's protocol '${n.protocol}'`);if(o.environment!==n.environment)throw new x(`validateRemoteWindowOrigin: Caller origin's environment '${o.environment}' doesn't match the current window origin's environment '${n.environment}'`);return t}function ht(e){Ct();const t=e.split(ot,2),r=t[0],o=yt(t[1]),n={protocol:r};if(n.environment=St(e,o,pt),o.length<=n.environment.length+1)throw new A("Missing app component","origin",e);if(o.charAt(n.environment.length)!==it)throw new A("Missing a domain separator after the environment component","origin",e);const a=o.substr(n.environment.length+it.length);if(n.app=St(e,a,dt),n.app.length<a.length&&a.charAt(n.app.length)!==ze)throw new A(`When the Office Online app name is not the domain prefix, '${ze}' should precede it`,"origin",e);return n}function yt(e){if(!e)throw new I(p,"stringToReverse");const t=e.length;let r=p;for(let o=t-1;o>=0;o-=1)r+=e.charAt(o);return r}function St(e,t,r){if(!t)throw new I(p,"reversedValidatedHostname");if(!r)throw new I(p,"reversedStringsToLengthMap");const o=t.length,n=Object.keys(r).filter((e=>{const n=r[e];return n<=o&&t.substr(0,n)===e}));if(n&&n.length>0)return yt(n[0]);throw new A("Invalid origin","validatedOrigin",e)}function Ct(){if(ut)return;const e=Xe();e.whitelistOriginComponents&&(dt=bt(e.sharedClipboardHostingApps),pt=bt(e.sharedClipboardHostingEnvironments),ut=!0)}function bt(e){const t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((e=>{t[yt(e)]=e.length})),t):t}const wt=1;function Et(e,t){return null==e||e===wt||null==t||e!==t}function _t(){return vt()}function Pt(){return vt()}function Tt(e){if(!e)throw new I(p,"id");const t=e.trim().toLowerCase();if(0===t.length)throw new A(p,"id");return t}function vt(){return(Math.random()+1).toString(36).substring(7)}function It(e,t,r,o,n){const a={id:e,operationCode:t,destination:r,userHash:o,clipboardItemsData:n};return Lt(a),a}class At{}function xt(e){return"get"===e||"set"===e||"init"===e}At.localStorageData="localStorage/data",At.localStorageMetadata="localStorage/metadata",At.initIframe="initIframe";const Lt=function(e){if(!e)throw new I(p,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new I(p,"id");if(!e.operationCode)throw new I(p,"operationCode");if(!e.destination)throw new I(p,"destination");if(!xt(e.operationCode))throw new A(p,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new A(`'${e.operationCode}' expects no clipboard items`,"clipboardItemsData")};function Mt(e,t,r,o,n){const a={id:e,operationCode:t,failed:r,error:o,clipboardItemsData:n};return Ft(a),a}const Ft=function(e){if(!e)throw new I(p,"clipboardOperationResultMessage");const t=["failed","error","clipboardItemsData","operationCode","id","userHash"];let r=!1;for(const o of t)if(e.hasOwnProperty(o)){r=!0;break}if(!r)throw new v("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw l().ULS.traceTag(553747865,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`Missing argument 'id'. keys: ${JSON.stringify(Object.keys(e))}, isConstructorObject: ${e.constructor===Object}, operationCode: ${e.operationCode}, id: ${e.id}, failed: ${e.failed}, error: ${e.error}.`),new I(p,"id");if(!e.operationCode)throw new I(p,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new A(p,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new A(`A failed '${e.operationCode}' operation expects a non-empty error argument`,"error");if(e.clipboardItemsData)throw new A(`A failed '${e.operationCode}' operation does not expect a clipboardItemsData argument`,"clipboardItemsData")}else{if(e.error)throw new A(`'${e.operationCode}' expects an empty error argument`,"error");if("unknownresult"===e.operationCode)throw new A(`'${e.operationCode}' can only be used with a failure message`,"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new A(`'${e.operationCode}' expects a clipboardItems argument`,"clipboardItemsData")}else if(e.clipboardItemsData)throw new A(`'${e.operationCode}' expects no clipboardItemsData argument`,"clipboardItemsData")};function kt(e){if(!e||0===e.trim().length)throw new A(p,"className",e);return(()=>{let t=!1;function r(t){return`${e}:${t}: already disposed`}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&l().ULS.traceTag(596456217,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new x(r(e))}}})()}class Wt{initialize(e){return e.then((e=>(this.clipboardStorage=e,l().ULS.traceTag(596453007,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Clipboard strategy type '${this.clipboardStrategyType}' was initialized.`),Promise.resolve(this))),(e=>(l().ULS.traceTag(596453008,s.nh.msoulscat_ES_EWAJS,_(e)?s.kp.Info:s.kp.Error,`Failed to initialize clipboard strategy type '${this.clipboardStrategyType}'. Error: ${s.Wp.getStringifiedError(e)}`),Promise.reject(e))))}set(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){const e="ClipboardStrategyBase.set: this.clipboardStorage should be defined";return l().ULS.shipAssertTag(596121485,s.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new U(y.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new U(y.SetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).set`,e))}}get(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){const e="ClipboardStrategyBase.get: this.clipboardStorage should be defined";return l().ULS.shipAssertTag(596121486,s.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new U(y.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((e=>(this.clipboardDataProcessor&&this.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)))).catch((t=>{throw l().ULS.traceTag(507848131,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`ClipboardStrategyBase.get - Failed to get clipboard items. Command id: ${e.id}, Error: ${s.Wp.getStringifiedError(t)}`),t}))}catch(e){return Promise.reject(new U(y.GetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).get`,e))}}onSystemClipboardChangedExternally(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(Ie(),e):(l().ULS.shipAssertTag(595882508,s.nh.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new U(y.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new U(y.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())}constructor(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=kt(`${e}`)}}const $t=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Ot(e){let t=e;return t&&0!==t.trim().length||(t=_t()),new Ut(t)}function Dt(){return $t?window.performance.now():Date.now()}function Rt(e){return $t?new Date(e+window.performance.timing.navigationStart):new Date(e)}function Nt(e,t,r){if(!r)throw new I(p,"creationTimestamp");return`${e?"Fulfilled":"Still unfulfilled"} after ${e?t?t-r:"?":Dt()-r}ms`}class Ut{fulfilled(){return this.isFulfilled}resolve(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):l().ULS.traceTag(596456257,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`Deferred promise - resolve: the resolve for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}reject(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):l().ULS.traceTag(596456260,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`Deferred promise - reject: the reject for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}markAsFulfilled(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Dt(),l().ULS.traceTag(596456261,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise: marking promise #${this.sequenceId} with id '${this.id}' as fulfilled (${this.rejected?"rejected":"resolved"}). ${Nt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`))}fulfillmentCheck(e){return l().ULS.traceTag(596456258,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise: asked to ${e} deferred promise #${this.sequenceId} with id '${this.id}'`),this.isFulfilled&&l().ULS.traceTag(596456259,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`Deferred promise: cannot ${e} deferred promise #${this.sequenceId} with id '${this.id}' since it was ${this.rejected?"rejected":"resolved"} already on ${Rt(this.fulfillmentTimestamp)}. ${Nt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`),this.isFulfilled}constructor(e){this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=Tt(e),Ut.sequenceId+=1,this.sequenceId=Ut.sequenceId,this.creationTimestamp=Dt(),l().ULS.traceTag(596456225,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise: creating deferred promise #${this.sequenceId} with id '${this.id}' on ${Rt(this.creationTimestamp)}`),this.promise=new Promise(((e,t)=>{l().ULS.traceTag(596456226,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise: registering callback for promise #${this.sequenceId} with id '${this.id}' on ${Rt(Dt())}`),this.internalResolve=e,this.internalReject=t}))}}function jt(){return new Ht}Ut.sequenceId=0;class Ht{getDeferredPromise(e){const t=Tt(e);return this.deferredResultMessagePromiseCache[t]}getPromise(e){const t=this.getDeferredPromise(e);if(t)return l().ULS.traceTag(596456218,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise cache: found a deferred promise with id '${e}'.`),t.promise;l().ULS.traceTag(596456219,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise cache: there is no deferred promise with id '${e}'.`)}addNewPromise(e){const t=Ot(e);if(this.getDeferredPromise(t.id))throw new A("A deferred promise already exists in the cache for the specified id","id",t.id);const r=Tt(t.id);return this.deferredResultMessagePromiseCache[r]=t,l().ULS.traceTag(596456220,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise cache: added a new deferred promise with id '${t.id}'.`),t}getLength(){let e=0;for(const t in this.deferredResultMessagePromiseCache)e+=1;return e}delete(e){if(!this.getDeferredPromise(e))return void l().ULS.traceTag(596456221,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise cache: no need to delete an item with id '${e}' since this id is not associated with an existing deferred promise.`);const t=Tt(e);delete this.deferredResultMessagePromiseCache[t],l().ULS.traceTag(596456222,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise cache: deleted id '${e}'.`)}clear(){if(l().ULS.traceTag(596456223,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Deferred promise cache: clearing ${this.getLength()} items from the cache`),this.deferredResultMessagePromiseCache)for(const e in this.deferredResultMessagePromiseCache){const t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){l().ULS.traceTag(596456224,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`Deferred promise cache: clear failed to reject promise id '${e}' with this exception: ${t.message}. Ignoring.`)}}this.deferredResultMessagePromiseCache={}}constructor(){this.deferredResultMessagePromiseCache={}}}function Jt(e){if(!e)throw new I(p,"validator");const t={deserialize:t=>function(e,t){if(!e)throw new I(p,"incomingMessage");if(!t)throw new I(p,"validator");if(0===e.length)throw new A("An empty message is invalid","incomingMessage");const r=e.trim();if(0===r.length)throw new A("A message cannot contain only spaces","incomingMessage");let o;try{o=JSON.parse(r)}catch(t){throw new A("Deserialization failed","incomingMessage",`Contains ${e.length.toString()} characters`,t)}if(!o)throw new A("Deserialization returned nothing","incomingMessage");return t(o),o}(t,e)};return t}function zt(e){if(!e)throw new I(p,"validator");const t={serialize:t=>function(e,t){if(!e)throw new I(p,"outgoingMessage");if(!t)throw new I(p,"validator");return t(e),function(e){let t;try{t=JSON.stringify(e)}catch(t){throw new A("Serialization failed","outgoingMessage",`${Object.keys(e).length} properties`,t)}return l().ULS.traceTag(596452375,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`The length of the serialized message is ${t.length}`),t}(e)}(t,e)};return t}const Vt="initmessageid",Bt="unknownmessageid",Gt="CreatorOrigin";function Kt(e){if(!e)throw new I(p,"remoteWindow");if(!("window"in e)||!e.window)throw new I(p,"remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new I(p,"remoteWindow.windowOrigin");const t=gt(e.windowOrigin);return{window:e.window,windowOrigin:t}}class qt{get disposableImplementationExtension(){return this._disposableImplementationExtension}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(H([()=>{this.sender&&this.sender.dispose()},()=>{this.receiver&&this.receiver.dispose()}]),this.disposableImplementationExtension.dispose())}postMessage(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new I(p,"outgoingMessage");if(!this.sender){const e="WindowRPCBase::postMessage - this.sender should be defined";throw l().ULS.shipAssertTag(596121484,s.nh.msoulscat_ES_EWAJS,!1,e),new x(e)}this.sender.postMessage(e)}constructor(e,t,r,o){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=kt(o)}}function Zt(){return Xt}const Xt={addEventListener:(e,t)=>window.addEventListener(e,t),removeEventListener:(e,t)=>window.removeEventListener(e,t)};function Yt(e,t,r){return new tr(e,t,r)}function Qt(e,t,r){return new tr(e,t,r)}const er="message";class tr{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Zt().removeEventListener(er,this.windowMessageHandler),this.disposableImplementationExtension.dispose())}shouldFilterMessageEvent(e){try{if(!e.origin||!e.source)return l().ULS.traceTag(596452370,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return l().ULS.traceTag(596452371,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return l().ULS.traceTag(596452372,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return l().ULS.traceTag(596452373,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1}onMessageReceived(e){if(this.shouldFilterMessageEvent(e))return;let t;try{t=this.deserializer.deserialize(e.data)}catch(e){l().ULS.traceTag(596452374,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Window RPC Receiver: unable to deserialize incoming message. ${s.Wp.getStringifiedError(e)}`);try{this.handler.handleDeserializationError(e)}catch(e){l().ULS.traceTag(596452184,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`Window RPC Receiver: unable to handle deserialization error. ${s.Wp.getStringifiedError(e)}`)}return}if(t)try{this.handler.handleMessage(t).catch((e=>{l().ULS.traceTag(595985880,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`Window RPC Receiver: unable to process incoming message. ${s.Wp.getStringifiedError(e)}`)}))}catch(e){l().ULS.traceTag(596452186,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`Window RPC Receiver: unable to process incoming message. ${s.Wp.getStringifiedError(e)}`)}else l().ULS.traceTag(596452185,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"Window RPC Receiver: the incoming message is empty")}constructor(e,t,r){if(this.deserializer=e,this.handler=t,this.windowMessageHandler=e=>this.onMessageReceived(e),!e)throw new I(p,"deserializer");if(!t)throw new I(p,"handler");if(!r)throw new I(p,"windowRPC");this.disposableImplementationExtension=kt("WindowRPCReceiverInternal"),this.remoteWindow=Kt(r.remoteWindow),Zt().addEventListener(er,this.windowMessageHandler)}}function rr(e,t){return new nr(e,t)}function or(e,t){return new nr(e,t)}class nr{postMessage(e){if(!e)throw new I(p,"outgoingMessage");if(!this.remoteWindow.window)throw new x("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new x("The remote window does not support postMessage");const t=this.serializer.serialize(e);re().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t,r=!1){if(this.serializer=e,this.delayedQueueEnabled=r,!e)throw new I(p,"serializer");if(!t)throw new I(p,"windowRPC");this.disposableImplementationExtension=kt("WindowRPCSenderInternal"),this.remoteWindow=Kt(t.remoteWindow)}}const ar="OfficeOnlineCCP_",ir=ar+"Metadata_",sr=ar+"Data_",cr="_LocalStorageChangedFlag";function lr(){try{const e="XLO_CCP",t="1";return localStorage.setItem(e,t),localStorage.getItem(e)===t}catch{return!1}}function dr(e){return sr+e}function pr(e){return ir+e}function ur(e){return pr(e)+cr}class mr{constructor(){this.copyStatus=gr.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0,this.isFullSheetCopy=!1}}class fr{profilingMessage(e){const t=s.TZ.timeStamp()-this.startTime;return`onPasteProfiling: ${e}, pasteId: ${this.id}, timeMS: ${t.toFixed()}`}constructor(){this.startTime=s.TZ.timeStamp()}}var gr;function hr(){return{}}function yr(e){let t;return e&&e.lastCopy&&(t={...e.lastCopy}),{lastCopy:t}}function Sr(e){try{l().ULS.traceTag(595716237,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Attempting to create clipboard storage type '${Re.LocalStorage}'`);const t=new Cr(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(gr||(gr={}));class Cr{get(e){this.disposableImplementationExtension.throwIfDisposed("get"),l().ULS.traceTag(595716238,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`localStorageClipboardStorage.get: commandParameters.id='${e?e.id:p}'`);const t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(Ie());try{const e=JSON.parse(t);if(!e||0===Ae(e))return Promise.resolve(Ie());const r=Le(e);return Promise.resolve(r)}catch(e){return Promise.resolve(Ie())}}set(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),l().ULS.traceTag(595716239,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`localStorageClipboardStorage.set: item count=${xe(e)}'; commandParameters.id='${t?t.id:p}'`),0===xe(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));const r=`${this.localStorageKey+cr}`,o=_t();return l().ULS.traceTag(595654546,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`localStorageClipboardStorage.set: set local storage value. eventFalgKey = ${r}. eventFlagValue = ${o}`),localStorage.setItem(r,o),Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[pe,me,"data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new U(y.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new U(y.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=Re.LocalStorage,this.disposableImplementationExtension=kt("LocalStorageClipboardStorage")}}function br(e){return l().ULS.traceTag(595716236,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`Attempting to create clipboard strategy type '${h.LocalStorage}' with localStorageKey: '${e}'`),(new wr).initialize(Sr(e))}class wr extends Wt{constructor(e){super(h.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class Er{onStorageChanged(e){l().ULS.shipAssertTag(595716249,s.nh.msoulscat_ES_EWAJS,null!=e,"e should not be null"),l().ULS.traceTag(595716288,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ${e.key}. localStorageKeyToWatch = ${this.localStorageKeyToWatch}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),l().ULS.traceTag(595716289,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((()=>{this.raiseMetadataChangedEvent()}),(()=>{l().ULS.traceTag(595716295,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))}raiseMetadataChangedEvent(){return l().ULS.traceTag(595715525,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.clipboardStrategy.get({userHash:0}).then((e=>{this.listener(e),l().ULS.traceTag(595716232,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ${this.lastLocalStorageValue}`)}),(e=>{l().ULS.traceTag(595716233,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))}isLocalStorageValueChanged(){const e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return l().ULS.traceTag(595715526,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ${this.lastLocalStorageValue}. currentLocalStorageValue = ${e}`),this.lastLocalStorageValue=e,t}waitForLocalStorageValueToChange(e){if(l().ULS.traceTag(595715527,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged())return l().ULS.traceTag(595715528,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ${this.lastLocalStorageValue}`),Promise.resolve();const t=Ot(),r=new Date,o=setInterval((()=>{const n=(new Date).getTime()-r.getTime();l().ULS.traceTag(595715529,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()?(clearInterval(o),l().ULS.traceTag(595716234,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.resolve()):n>e&&(clearInterval(o),l().ULS.traceTag(595716235,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.reject())}),200);return t.promise}constructor(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}}var _r=r(8615);const Pr="\t",Tr="\n",vr="\r",Ir=new RegExp(`(${Tr}${vr})|(${vr}${Tr})|(${vr})`,"g"),Ar=new RegExp(`(${Pr})`,"g"),xr=10240,Lr=new RegExp("<","g"),Mr="&lt;",Fr=new RegExp(">","g"),kr="&gt;",Wr="div",$r="pre",Or="table",Dr="tr",Rr="td",Nr="\x3c!--StartFragment--\x3e",Ur="\x3c!--EndFragment--\x3e",jr=Nr.length,Hr=Ur.length,Jr=`Version:0.9${Tr}StartHTML:0000000100${Tr}EndHTML:{EndHTML0}${Tr}StartFragment:0000000134${Tr}EndFragment:{EndFragm}${Tr}<html>${Tr}<body>${Tr}${Nr}${Tr}`,zr=`${Ur}${Tr}</body>${Tr}</html>`,Vr="0000000000",Br=7,Gr="data-ccp-timestamp",Kr=0;function qr(e){return e?e.replace(Ir,Tr):e}function Zr(e){return e?e.length<=xr?e:e.substr(0,xr):p}function Xr(e){var t;const r=function(e){return e?e.replace(Ir,`</${Rr}></${Dr}><${Dr}><${Rr}>`):e}((t=io(e))?t.replace(Ar,`</${Rr}><${Rr}>`):t);return`<${Or}><${Dr}><${Rr}>${r}</${Rr}></${Dr}></${Or}>`}function Yr(e,t,r){if(r!==Kr&&!r)throw new I(p,"timestamp");if(isNaN(r))throw new A(p,"timestamp",r.toString());const o=function(e,t,r){return`<${e} ${Gr}='${r}'>${t}</${e}>`}(e,Xr(t),r);return ro(o)}function Qr(e){const t=[],r=e.getElementsByTagName("tr");if(r.length>0){const e=eo(r[0]);t.push(e);for(let e=1;e<r.length;e+=1){t.push(vr),t.push(Tr);const o=eo(r[e]);t.push(o)}}return t.join("")}function eo(e){const t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(let e=1;e<r.length;e+=1)t.push(Pr),t.push(r[e].innerText)}return t.join("")}function to(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(Gr)}function ro(e){if(!Y()||ee())return e;const t=Vr.length,r=Jr.length+e.length+zr.length;let o=(r-zr.length).toString();if(o.length<t&&(o=Vr.substr(0,t-o.length)+o),o.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is ${o.length} but it should be ${t}`;throw l().ULS.shipAssertTag(596128536,s.nh.msoulscat_ES_EWAJS,!1,e),new U(y.UnexpectedClipboardTextHtmlContentLength,e)}let n=(r-Br).toString();if(n.length<t&&(n=Vr.substr(0,t-n.length)+n),n.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is ${n.length} but it should be ${t}`;throw l().ULS.shipAssertTag(596128537,s.nh.msoulscat_ES_EWAJS,!1,e),new U(y.UnexpectedClipboardTextHtmlContentLength,e)}const a=Jr.replace("{EndHTML0}",n).replace("{EndFragm}",o)+e+zr;return l().ULS.shipAssertTag(596128538,s.nh.msoulscat_ES_EWAJS,a.length===r,`addClipboardWrapperForEdge: The resulting text/html payload length of ${a.length} differs from the expected length of ${r}`),a}function oo(e){if(!e)return p;if(!e.trim())return e;const t=e.indexOf(Nr),r=e.indexOf(Ur);if(t<0||r<0||t>r)return e;const o=t+jr,n=r-o,a=e.indexOf(Nr,o),i=e.indexOf(Ur,r+Hr);return a>=0||i>=0?e:e.substr(o,n)}function no(e){const t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new I(p,"attributeName");const r=new RegExp(`${t}=['"](\\d+)['"]`,"i").exec(e);return!r||r.length<2?void 0:r[1]}(e,Gr);if(!t||!t.trim())return;const r=Number(t);return!r&&r!==Kr||isNaN(r)?void 0:r}function ao(e){if(!e||!e.trim())return;const t=new DOMParser,r=_r.domPurifyPolicyHtml.createHTML(e),o=t.parseFromString(r,"text/html"),n=function(e){const t=e.getElementsByTagName("meta");for(let e=0;e<t.length;e+=1){const r=t[e];if("ProgId"===r.getAttribute("name")){const e=r.getAttribute("content");if(null!==e){if(e.length>64)return void l().ULS.shipAssertTag(595683460,s.nh.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(e.startsWith("Word"))return"Word Desktop";if(e.startsWith("Excel"))return"Excel Desktop";if(e.startsWith("PowerPoint"))return"PowerPoint Desktop";if(e.startsWith("OneNote"))return"OneNote Desktop";l().ULS.traceTag(595683457,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}}(o);if(void 0!==n)return n;const a=function(e){if(null===e||null===e.body||null===e.body.children||0===e.body.children.length)return;const t=e.body.children[0];if(null!=t&&null!=t.classList)for(let e=0;e<t.classList.length;e+=1){const r=t.classList[e];if(r.startsWith("SCXO"))return"OneNote Online";if(r.startsWith("SCXP"))return"PowerPoint Online";if(r.startsWith("SCXW"))return"Word Online"}}(o);return void 0!==a?a:function(e){if(null===e)return!1;const t=e.getElementsByTagName("b");if(0===t.length)return!1;const r=t[0];return!(null==r||null==r.id||null==r.id.startsWith||!r.id.startsWith("docs-internal-guid-"))}(o)?"Google Docs":void 0}function io(e){return e?e.replace(Lr,Mr).replace(Fr,kr):p}function so(e,t,r){let o="";return r&&(o=Object.keys(r).reduce(((e,t)=>t?`${e} ${t}='${r[t]}'`:e),"")),`<${t}${o}>${e}</${t}>`}var co=r(4645);function lo(e,t,r){return new po(e,t,r)}class po{get clipboardStrategy(){if(this.clipboardPlatformEnvironment)return this.clipboardPlatformEnvironment.getClipboardStrategy();throw new x("clipboardPlatformEnvironment is missing")}onCopy(e){if(!e)return Promise.reject(new D(S.MissingArgumentError,"Missing commandParameters argument",new I(p,"commandParameters")));let t,r;this.initialClipboardStrategyType=e.dataClipboardStrategyType,t=new mr;try{t.id=Pt(),l().ULS.traceTag(595937123,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onCopy: copy ${t.id} started.`),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e;const o=this.getCopyFlowHandler(t);t.sourceItem=this.getSourceItem(o,t),this.clearInProgressCopyIfNeeded(t),this.inProgressCopyContext=t,r=this.serialize(o,t),l().ULS.traceTag(595937152,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,`CopyPasteFlowManager.onCopy: updating metadata for copy id ${t.id} after serialize.`),this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)&&r&&r.synchronousResult&&r.synchronousResult.setItem(_e,this.metadataManager.serializeMetadata({lastCopy:{...t,copyStatus:t.isFromCache?gr.Completed:gr.SynchronousPhaseCompleted}})),this.metadataManager.updateMetadata({lastCopy:t})}catch(r){return t?l().ULS.traceTag(595734742,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onCopy: catching error for copy id ${t.id} during serialize.`):l().ULS.traceTag(595734743,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteFlowManager.onCopy: catching error and no copy context during serialize. CopyCommandId: ${e?.id}`:"CopyPasteFlowManager.onCopy: catching error and no copy context during serialize."),this.copyCompleteCleanup(t,e),Promise.reject(r)}try{return this.writeClipboardItems(e,t,r).then((()=>this.rejectIfCopyCancelled(t))).then((()=>(this.isTelemetryLogsForAsyncClpWriteIssueEnabled&&l().ULS.traceTag(504715104,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,`CopyPasteFlowManager.onCopy: Write to clipboard completed for both sync and async phase. CopyId: ${t?.id}.`),this.copyCompleteCleanup(t,e),t)),(r=>{l().ULS.traceTag(595734747,s.nh.msoulscat_ES_EWAJS,s.kp.Info,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteFlowManager.onCopy: Error in writeClipboardItems. CopyId: ${t?.id}. Error: ${s.Wp.getStringifiedError(r)}`:`CopyPasteFlowManager.onCopy: got error for copy id ${t.id}.`);let o=r;return this.copyCompleteCleanup(t,e),o||(l().ULS.shipAssertTag(595854806,s.nh.msoulscat_ES_EWAJS,!1,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`copyPasteFlowManager.onCopy: promise rejected without error. CopyId: ${t?.id}.`:"copyPasteFlowManager.onCopy: promise rejected without error"),o=new D(S.UnknownCopyErrorType,"copyPasteFlowManager.onCopy failed without specified error")),o.copyContext=t,Promise.reject(o)}))}catch(r){return this.copyCompleteCleanup(t,e),l().ULS.traceTag(596456160,s.nh.msoulscat_ES_EWAJS,s.kp.Error,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to store content in the clipboard. CopyId: ${t?.id}. Exception: ${s.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`:`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to store content in the clipboard. Exception: ${s.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),Promise.reject(new D(S.SaveToTheClipboardFailed,`Failed to store content in the clipboard (with an exception): ${r.message}`,r))}}onPaste(e){const t=new fr;try{if(!e)return Promise.reject(new R(C.MissingArgumentError,"Missing commandParameters argument",new I(p,"commandParameters")));this.initialClipboardStrategyType=e.dataClipboardStrategyType,e.isTimestampStoredInSystemClipboard=!0,t.id=_t(),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e,t.clipboardItems=Ie(),t.isClipboardInaccessible=!1,l().ULS.traceTag(595685636,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("start"));const r=this.metadataManager.getCachedMetadata();t.copyContextSnapshot=r.lastCopy,this.applicationHost.initializePasteContext(t),t.copyContextSnapshot?l().ULS.traceTag(595937154,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onPaste: paste started for copy id ${t.copyContextSnapshot.id}`):l().ULS.traceTag(595730637,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteFlowManager.onPaste: paste started and copy context is null");let o,n=!1;return e.skipClipboardAccess?(l().ULS.traceTag(595685637,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("skipClipboardAccess")),o=Promise.resolve()):o=this.readFromClipboard(t,e).then((r=>{if(l().ULS.traceTag(595685638,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("readFromClipboard_then")),e.isAsyncClipboardAPI&&this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)){let e={lastCopy:void 0};if(!this.isEmptyClipboard(r)){const o=r.getItem(_e);o&&(e=this.metadataManager.deserializeMetadata(o),(!t?.copyContextSnapshot||t.copyContextSnapshot.id!==e?.lastCopy?.id||t?.copyContextSnapshot?.id===e?.lastCopy?.id&&t?.copyContextSnapshot?.copyStatus!==gr.Completed&&e?.lastCopy?.copyStatus===gr.Completed)&&(t.copyContextSnapshot=e?.lastCopy,this.metadataManager.updateMetadata(e)))}e?.lastCopy||(t.copyContextSnapshot=void 0,this.metadataManager.updateMetadata({lastCopy:void 0}),r.setItem(ye,f))}return t.clipboardItems=r,Promise.resolve()}),(e=>e&&e.reason&&e.reason===C.ClipboardIsInaccessible?(t.isClipboardInaccessible=!0,Promise.resolve()):Promise.reject(e))),o.then((()=>e.isAsyncClipboardAPI&&this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)?t:this.readClipboardItemsAgainIfMetadataNotSync(t,e))).then((()=>(l().ULS.traceTag(595685639,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("getPasteFlowHandler")),this.getPasteFlowHandler(t)))).then((e=>(n||e.beforePaste&&e.beforePaste(t),e))).then((r=>{if(l().ULS.traceTag(595685640,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("getPasteFlowHandler_then")),t.clipboardItems?.getItem(ye)!==f&&!t.isSameSession&&(!e.isAsyncClipboardAPI||!this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType))&&t.copyContextSnapshot&&t.copyContextSnapshot.copyStatus!==gr.Completed&&r.shouldWaitForCopyToComplete(t)){l().ULS.traceTag(595937155,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onPaste: pasteFlowHandler ask to waiting for copy (${t.copyContextSnapshot.id}) to complete. current status ${t.copyContextSnapshot.copyStatus}. copy session id is ${t.copyContextSnapshot.sessionId}`),l().ULS.traceTag(595683427,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("onDeferredPasteStarted")),r.onDeferredPasteStarted(t);const o=this.continueWhenCopyComplete(e,t).then((e=>(l().ULS.traceTag(595685642,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("onDeferredPasteCompleted")),r.onDeferredPasteCompleted(t),t.copyContextSnapshot=this.metadataManager.getCachedMetadata().lastCopy,t.clipboardItems=e,r)),(e=>(r.onDeferredPasteCompleted(t),l().ULS.traceTag(595882504,s.nh.msoulscat_ES_EWAJS,s.kp.Error,`CopyPasteFlowManager.onPaste: got error while wait for deferred paste to complete. error: [${e}]`),Promise.reject(e))));return l().ULS.traceTag(595685643,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("continueWhenCopyComplete")),this.testHook("continueWhenCopyComplete"),o}return l().ULS.traceTag(595940941,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onPaste: not wait for copy(${t.copyContextSnapshot&&t.copyContextSnapshot.id}) to complete. is copyContextSnapshot defined: ${void 0!==t.copyContextSnapshot}. copyStatus: ${t.copyContextSnapshot&&t.copyContextSnapshot.copyStatus}`),r})).then((e=>this.deserialize(e,t))).then((()=>{l().ULS.traceTag(595685644,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("deserialize_then")),t.clipboardItems&&t.clipboardItems.getItem(ye)===f&&(l().ULS.traceTag(595685645,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("onSystemClipboardChangedExternally")),this.onSystemClipboardChangedExternally())})).then((()=>{const e=t.clipboardItems;if(void 0===e)return;const r=e.getItem(me);if(void 0!==r){const e=ao(r);void 0!==e&&(t.externalAppSource=e)}})).then((()=>t)).catch((e=>{let r=e;return r||(l().ULS.shipAssertTag(595858762,s.nh.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onPaste: promise rejected without error"),r=new R(C.UnknownPasteError,"copyPasteFlowManager.onPaste failed without specified error")),r.pasteContext=t,Promise.reject(r)}))}catch(e){return l().ULS.shipAssertTag(596456161,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Exception: ${s.Wp.getStringifiedError(e)}`),Promise.reject(new R(C.FailedToReadFromClipboard,`Failed to read data from the clipboard (with an exception): ${e.message}`,e,t))}}onCancelCopy(e){try{if(this.inProgressCopyContext?(this.inProgressCopyContext.markForCancellation=!0,l().ULS.traceTag(595734748,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onCancelCopy: canceling copy for copy id ${this.inProgressCopyContext.id}.`)):l().ULS.traceTag(595734749,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteFlowManager.onCancelCopy: no inProgressCopyContext."),!e)return Promise.resolve();this.metadataManager.clear();const t=Ie(),r={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:Ne.Copy};return this.clipboardStrategy.set(t,r).catch((e=>(l().ULS.traceTag(596456162,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new N(b.FailedToClearClipboard,`Failed to clear the clipboard: ${e.message}`,e)))))}catch(e){return l().ULS.traceTag(596456163,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard. Exception: ${s.Wp.getStringifiedError(e)}`),Promise.reject(new N(b.FailedToClearClipboard,`Failed to clear the clipboard (with an exception): ${e.message}`,e))}}isAsyncClipboardEnhancementsEnabled(e){return this.isAsyncClipboardEnhancementsFGEnabled&&e===h.AsyncSystemClipboard}async onSystemClipboardChangedExternally(){this.onCancelCopy(!1),this.metadataManager.updateMetadata({lastCopy:void 0});const e={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:Ne.Copy};await this.clipboardStrategy.onSystemClipboardChangedExternally(e)}readClipboardItemsAgainIfMetadataNotSync(e,t){let r=!1;return this.metadataManager.getMetadataSyncPromise().then((t=>{t&&t.lastCopy?(e.copyContextSnapshot&&(r=t.lastCopy.id!==e.copyContextSnapshot.id||t.lastCopy.copyStatus!==e.copyContextSnapshot.copyStatus),e.copyContextSnapshot=t.lastCopy,l().ULS.traceTag(595937158,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata is sync. copy id = ${e.copyContextSnapshot.id}. copy status = ${e.copyContextSnapshot.copyStatus}. isMetadataChanged = ${r}`)):l().ULS.traceTag(595937025,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata or metadata.lastCopy are not defined. This should be possible only when the last copy was external (i.e. there is no previous copy operation in xlo). do nothing")})).then((()=>r?this.readRichClipboardOnly(e,t,e.clipboardItems):Promise.resolve(e.clipboardItems))).then((t=>(e.clipboardItems=t,e)))}getCopyFlowHandler(e){let t;try{t=this.applicationHost.getCopyFlowHandler(e)}catch(e){throw l().ULS.shipAssertTag(596456192,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler failed with an exception: ${s.Wp.getStringifiedError(e)}`),new D(S.FetchCopyFlowHandlerFailed,`applicationHost.getCopyFlowHandler failed with an exception: ${e.message}`,e)}if(!t){const e="CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw l().ULS.shipAssertTag(596456193,s.nh.msoulscat_ES_EWAJS,!1,e),new D(S.CopyFlowHandlerNotFound,e)}return t}getSourceItem(e,t){try{return e.getSourceItem(t)}catch(e){throw l().ULS.shipAssertTag(596456194,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.getSourceItem failed with an exception: ${s.Wp.getStringifiedError(e)}`),new D(S.FetchSourceItemFailed,`applicationHost.getSourceItem failed with an exception: ${e.message}`,e)}}serialize(e,t){try{e.beforeSerialize(t)}catch(e){throw l().ULS.shipAssertTag(596456195,s.nh.msoulscat_ES_EWAJS,!1,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.beforeSerialize failed with an exception. CopyId: ${t?.id}. Error: ${s.Wp.getStringifiedError(e)}`:`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.beforeSerialize failed with an exception: ${s.Wp.getStringifiedError(e)}`),new D(S.BeforeSerializeFailed,`copyFlowHandler.beforeSerialize failed with an exception: ${e.message}`,e)}let r;this.isTelemetryLogsForAsyncClpWriteIssueEnabled&&l().ULS.traceTag(504715103,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,`CopyPasteFlowManager.serialize: copyFlowHandler.beforeSerialize completed. CopyId: ${t?.id}.`);try{r=e.serialize(t)}catch(e){throw l().ULS.shipAssertTag(596456196,s.nh.msoulscat_ES_EWAJS,!1,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteFlowManager.serialize: copyFlowHandler.serialize failed with an exception. CopyId: ${t?.id}. Error: ${s.Wp.getStringifiedError(e)}`:`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.serialize failed with an exception: ${s.Wp.getStringifiedError(e)}`),new D(S.SerializeFailed,`copyFlowHandler.serialize failed with an exception: ${e.message}`,e)}if(!r)throw l().ULS.shipAssertTag(596456197,s.nh.msoulscat_ES_EWAJS,!1,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteFlowManager.serialize: copyFlowHandler.serialize should return a non null result. CopyId: ${t?.id}.`:"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.serialize should return a non null result"),new D(S.SerializeResultNotValid,"copyFlowHandler.serialize should return a non null result");return this.isTelemetryLogsForAsyncClpWriteIssueEnabled&&l().ULS.traceTag(504715102,s.nh.msoulscat_ES_EWAJS,s.kp.Verbose,`CopyPasteFlowManager.serialize completed. CopyId: ${t?.id}.`),r}setClipboardSync(e,t,r){try{r?l().ULS.traceTag(595734750,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.setClipboardSync: start setClipboardSync for copy id ${r.id}.`):l().ULS.traceTag(595734751,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,"CopyPasteFlowManager.setClipboardSync: no copy context.");let o=e;return o||(o=Ie()),this.clipboardStrategy.set(o,t).catch((e=>{if(l().ULS.traceTag(596456198,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. isKeyboardEvent: ${t.isKeyboardEvent}, Error: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),e&&void 0!==e.reason){const t=e;if(t.reason===y.ClipboardIsInaccessible)return Promise.reject(new D(S.ClipboardIsInaccessible,t.message,t));if(t.reason===y.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation)return Promise.reject(new D(S.SuccessiveCutCopyOverridingPendingCutCopy,`A successive Cut/Copy user event occurred before the last Cut/Copy browser event fired: ${t.message}`,t));if(t.reason===y.RejectingBlockedSyncCutCopyPromise)return Promise.reject(new D(S.BlockedSynchronousCutCopy,`In the user Cut/Copy operation, the async part occurred before its predecessor sync Cut/Copy browser event fired: ${t.message}`,t))}return Promise.reject(new D(S.SaveToTheClipboardFailed,`Failed to synchronously store content in the clipboard: ${e.message}`,e))})).then((()=>{r.succeededPopulatingSystemClipboardSync=t.isTimestampStoredInSystemClipboard}))}catch(e){return l().ULS.shipAssertTag(596456199,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. Exception: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new D(S.SaveToTheClipboardFailed,`Failed to synchronously store content in the clipboard (with an exception): ${e.message}`,e))}}setClipboardAsync(e,t,r){return l().ULS.traceTag(595734752,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.setClipboardAsync: start setClipboardAsync for copy id ${r.id}.`),e?e.then((e=>{try{if(l().ULS.traceTag(505794970,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.setClipboardAsync: clipboardItemsPromise resolved for copy id ${r?.id}.`),this.isEmptyClipboard(e))return Promise.resolve();this.isAsyncClipboardEnhancementsEnabled(t.dataClipboardStrategyType)&&e.setItem(_e,this.metadataManager.serializeMetadata({lastCopy:{...r,copyStatus:gr.Completed}}));const o=t.stopwatch;t.stopwatch=void 0;const n={...t};return n.isTimestampStoredInSystemClipboard=!1,t.isAsyncSystemClipboardEnabled&&this.isAsyncClipboardEnhancementsEnabled(t.dataClipboardStrategyType)&&(n.stopwatch=o),t.stopwatch=o,t.isKeyboardEvent&&(n.isKeyboardEvent=!1,n.silentClipboardAccessFailures=!0),this.clipboardStrategy.set(e,n).catch((e=>(l().ULS.traceTag(596456200,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously store content in the clipboard. CopyId: ${r?.id}. Error: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`:`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously store content in the clipboard: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),e&&void 0!==e.reason&&e.reason===y.ClipboardIsInaccessible?Promise.resolve():Promise.reject(new D(S.SaveToTheClipboardFailed,`Failed to asynchronously store content in the clipboard: ${e&&e.message}`,e))))).then((()=>{l().ULS.traceTag(505794969,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.setClipboardAsync: setClipboardAsync completed for copy id ${r.id}.`),r.succeededPopulatingSystemClipboardAsync=n.isTimestampStoredInSystemClipboard}))}catch(e){return l().ULS.shipAssertTag(596456201,s.nh.msoulscat_ES_EWAJS,!1,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously store content in the clipboard. CopyId: ${r?.id}. Exception: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`:`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously store content in the clipboard. Exception: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new D(S.SaveToTheClipboardFailed,`Failed to asynchronously store content in the clipboard (with an exception): ${e.message}`,e))}}),(e=>(r.isAsyncSerializeFailed=!0,l().ULS.traceTag(596456202,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously serialize the content - Marking copyContext.isAsyncSerializeFailed as true. CopyId: ${r?.id}. Error: ${s.Wp.getStringifiedError(e)}. Call stack: ${e&&e.stack?e.stack:"NA"}`:`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously serialize the content - Marking copyContext.isAsyncSerializeFailed as true. Error: ${s.Wp.getStringifiedError(e)}. Call stack: ${e&&e.stack?e.stack:"NA"}`),Promise.reject(new D(S.AsyncSerializeFailed,`Failed to asynchronously serialize the content. Error: ${e?e.message:"..."}`,e))))):(l().ULS.traceTag(595734753,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.setClipboardAsync: no clipboardItemsPromise. resolving promise for copy id ${r.id}.`),Promise.resolve())}isEmptyClipboard(e){return e?0===xe(e)&&(l().ULS.traceTag(596456204,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result does not contain items."),!0):(l().ULS.traceTag(596456203,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result is undefined."),!0)}writeClipboardItems(e,t,r){return this.isAsyncClipboardEnhancementsEnabled(e?.dataClipboardStrategyType)?this.writeClipboardItemsInSyncPhase(e,t,r).then((()=>this.rejectIfCopyCancelled(t).then((()=>this.setClipboardAsync(r.asynchronousResult,e,t))))):Promise.all([this.writeClipboardItemsInSyncPhase(e,t,r),this.rejectIfCopyCancelled(t).then((()=>this.setClipboardAsync(r.asynchronousResult,e,t)))])}writeClipboardItemsInSyncPhase(e,t,r){return this.setClipboardSync(r.synchronousResult,e,t).then((()=>this.rejectIfCopyCancelled(t))).then((()=>{t.copyStatus=gr.SynchronousPhaseCompleted,l().ULS.traceTag(595937153,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onCopy: updating metadata for copy id ${t.id} after status changed to SynchronousPhaseCompleted.`),this.metadataManager.updateMetadata({lastCopy:t})})).catch((r=>{if(t?l().ULS.traceTag(595734744,s.nh.msoulscat_ES_EWAJS,s.kp.Info,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: Error in setClipboardSync. CopyId: ${t?.id}. Error: ${s.Wp.getStringifiedError(r)}`:`CopyPasteFlowManager.onCopy: catch error for copy id ${t.id}.`):l().ULS.traceTag(595734745,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: no copy context. CopyCommandId: ${e?.id}`:"CopyPasteFlowManager.onCopy: no copy context."),r&&r.reason){const e=r.reason;if(e===S.SuccessiveCutCopyOverridingPendingCutCopy||e===S.BlockedSynchronousCutCopy||e===S.CopyOperationCancelled||this.initialClipboardStrategyType===h.AsyncSystemClipboard&&e===S.ClipboardIsInaccessible)return l().ULS.traceTag(595734746,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: synchronous copy failed to populate the clipboard. CopyId: ${t?.id}. Rejecting the promise: ${s.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`:`CopyPasteInfra.copyPasteFlowManager.onCopy: synchronous copy failed to populate the clipboard. Rejecting the promise: ${s.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),Promise.reject(r)}return l().ULS.traceTag(596456159,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: synchronous copy failed to populate the clipboard. Ignoring this failure since the active selection will allow for the required functionality. CopyId: ${t?.id}. Error: ${s.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`:`CopyPasteInfra.copyPasteFlowManager.onCopy: synchronous copy failed to populate the clipboard. Ignoring this failure since the active selection will allow for the required functionality: ${s.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),this.metadataManager.updateMetadata({lastCopy:t}),Promise.resolve()}))}readFromClipboard(e,t){l().ULS.traceTag(595685646,s.nh.msoulscat_ES_EWAJS,s.kp.Info,e.profilingMessage("readFromClipboard")),e.copyContextSnapshot&&(t.isTimestampStoredInSystemClipboard=e.copyContextSnapshot.isTimestampStoredInSystemClipboard);const r=this.clipboardStrategy.get(t);return l().ULS.traceTag(595685647,s.nh.msoulscat_ES_EWAJS,s.kp.Info,e.profilingMessage("readFromClipboard_ret")),r?r.then((t=>(l().ULS.traceTag(595685648,s.nh.msoulscat_ES_EWAJS,s.kp.Info,e.profilingMessage("readFromClipboard_then")),t?Promise.resolve(t):(l().ULS.traceTag(596456206,s.nh.msoulscat_ES_EWAJS,s.kp.Error,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Intercepted a missing clipboard item collection"),Promise.reject(new R(C.FailedToReadFromClipboard,"Failed to read data from the clipboard. Intercepted a missing clipboard item collection",new R(C.ClipboardIsEmpty,p)))))),(e=>{if(l().ULS.traceTag(596456207,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard: ${s.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),t.isPasteCommandFromRecoveryUI&&t.pasteRecoveryCachedClipboardItems)return l().ULS.traceTag(577249542,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteInfra.copyPasteFlowManager.onPaste: Returning 'pasteRecoveryCachedClipboardItems'"),Promise.resolve(t.pasteRecoveryCachedClipboardItems);const r=e;return w(e,y.ClipboardIsInaccessible)?Promise.reject(new R(C.ClipboardIsInaccessible,r.message,r)):w(e,y.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(new R(C.SuccessivePasteOverridingPendingPaste,`A successive Paste user event occurred before the last Paste browser event fired: ${r.message}`,r)):w(e,y.AsyncClipboardReadFailure)?Promise.reject(new R(C.FailedToReadFromAsyncClipboard,r.message,r)):Promise.reject(new R(C.FailedToReadFromClipboard,`Failed to read data from the clipboard: ${e.message}`,e))})):(l().ULS.shipAssertTag(596456205,s.nh.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. clipboardStrategy.get() did not return an object"),Promise.reject(new R(C.FailedToReadFromClipboard,"Failed to read data from the clipboard. clipboardStrategy.get() did not return an object",new R(C.ReadFromClipboardReturnNullOrUndefined,p))))}getPasteFlowHandler(e){let t;try{t=this.applicationHost.getPasteFlowHandler(e)}catch(e){throw l().ULS.shipAssertTag(596456208,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler failed. Exception: ${s.Wp.getStringifiedError(e)}`),new R(C.FetchPasteFlowHandlerFailed,`applicationHost.getPasteFlowHandler failed with an exception: ${e.message}`,e)}if(!t){const e="CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw l().ULS.shipAssertTag(596456209,s.nh.msoulscat_ES_EWAJS,!1,e),new R(C.PasteFlowHandlerNotFound,e)}return t}deserialize(e,t){return l().ULS.traceTag(595683456,s.nh.msoulscat_ES_EWAJS,s.kp.Info,t.profilingMessage("deserialize")),e.deserialize(t).catch((e=>{const t=s.Wp.getStringifiedError(e);return l().ULS.traceTag(596456210,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onPaste: Deserialization failed: ${t}.`),Promise.reject(new R(C.DeserializeOperationFailed,`Deserialization failed: ${t}`,e))}))}copyCompleteCleanup(e,t){e?(l().ULS.traceTag(595734754,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: start copy complete for copy id ${e.id}.`),t&&(e.isTimestampStoredInSystemClipboard=t.isTimestampStoredInSystemClipboard),e&&this.inProgressCopyContext&&e.id===this.inProgressCopyContext.id?(this.inProgressCopyContext=void 0,e.copyStatus=gr.Completed,l().ULS.traceTag(595937159,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: updating metadata for copy id ${e.id} after copy completed.`),this.metadataManager.updateMetadata({lastCopy:e})):l().ULS.traceTag(595734755,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: not setting copy status to complete state for copy id ${e.id}.`)):l().ULS.traceTag(595734784,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,this.isTelemetryLogsForAsyncClpWriteIssueEnabled?`CopyPasteFlowManager.copyCompleteCleanup: no copy context. CopyCommandId: ${t?.id}`:"CopyPasteFlowManager.copyCompleteCleanup: no copy context.")}readRichClipboardOnly(e,t,r){return t.skipSystemClipboardAccess=!0,this.readFromClipboard(e,t).then((e=>(l().ULS.traceTag(595937160,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteFlowManager.readRichClipboardOnly: get clipboard items."),e)),(e=>(l().ULS.traceTag(595940942,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,`CopyPasteFlowManager.readRichClipboardOnly: reading form rich clipboard failed with error: ${s.Wp.getStringifiedError(e)}. use clipboard items from the first read as fallback.`),Promise.resolve(r))))}continueWhenCopyComplete(e,t){if(!t||!t.copyContextSnapshot)return Promise.resolve(void 0);if(t.copyContextSnapshot.copyStatus===gr.Completed)return Promise.resolve(void 0);if(this.deferredPasteData&&this.deferredPasteData.copyContextId!==t.copyContextSnapshot.id&&(l().ULS.shipAssertTag(595937161,s.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.continueWhenCopyComplete: deferred paste for another copy(${this.deferredPasteData.copyContextId} !== ${t.copyContextSnapshot.id}) exist, this is not expected as we should clean deferred paste data when new copy started(both same and cross session)`),this.rejectDeferredPasteData(C.DeferredPasteRejectedBecauseOtherCopyCompleted)),!this.deferredPasteData){const r=this.metadataManager.getCachedMetadata();if(r&&r.lastCopy&&r.lastCopy.copyStatus===gr.Completed&&r.lastCopy.id===t.copyContextSnapshot.id)return l().ULS.traceTag(595937162,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.continueWhenCopyComplete: copy ${r.lastCopy.id} already completed, not need for waiting any longer, reading the rich clipboard items`),this.readRichClipboardOnly(t,e,t.clipboardItems);const o=Ot(),n=o.promise.then((()=>this.readRichClipboardOnly(t,e,t.clipboardItems)));this.deferredPasteData={copyContextId:t.copyContextSnapshot.id,copyCompleteDeferredPromise:o,readClipboardPromise:n,numberOfDeferredPaste:0,createdDate:new Date}}return this.deferredPasteData.numberOfDeferredPaste+=1,l().ULS.traceTag(595937163,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.continueWhenCopyComplete: new deferred paste created for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}`),this.deferredPasteData.readClipboardPromise}rejectDeferredPasteData(e){if(this.deferredPasteData){l().ULS.traceTag(595937164,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.rejectDeferredPasteData: reject deferred pastes for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}. totalTime = ${(new Date).getTime()-this.deferredPasteData.createdDate.getTime()}ms`);const t=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,t.reject(new R(e,"CopyPasteFlowManager.rejectDeferredPasteData: reject deferred paste"))}}resolveDeferredPasteData(){if(this.deferredPasteData){l().ULS.traceTag(595937165,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.resolveDeferredPasteData: resolve deferred pastes for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}. totalTime = ${(new Date).getTime()-this.deferredPasteData.createdDate.getTime()}ms`);const e=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,e.resolve()}}rejectIfCopyCancelled(e){return e?l().ULS.traceTag(595734785,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: start rejectIfCopyCancelled for copy id ${e.id}.`):l().ULS.traceTag(595734786,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,"CopyPasteFlowManager.rejectIfCopyCancelled: no copy context."),e&&e.markForCancellation?(l().ULS.traceTag(595734787,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: reject for copy id ${e.id}.`),Promise.reject(new D(S.CopyOperationCancelled,`CopyPasteFlowManager.rejectIfCopyCancelled: Rejecting since copyContext with id ${e.id} is marked for cancellation`))):(e&&l().ULS.traceTag(595734788,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: resolve for copy id ${e.id}.`),Promise.resolve())}clearInProgressCopyIfNeeded(e){e&&e.markForCancellation||!this.inProgressCopyContext||e&&this.inProgressCopyContext.id===e.id||(l().ULS.traceTag(595937166,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.clearInProgressCopyIfNeeded: cancel previous in-progress copy (id = ${this.inProgressCopyContext.id}) as new copy started (${e.id})`),this.inProgressCopyContext.markForCancellation=!0,this.inProgressCopyContext=void 0)}onMetadataChanged(e){e&&e.lastCopy?(l().ULS.traceTag(595937167,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onMetadataChanged: the status of copy id ${e.lastCopy.id} from session ${e.lastCopy.sessionId} changed to ${e.lastCopy.copyStatus}`),this.clearInProgressCopyIfNeeded(e.lastCopy),this.deferredPasteData&&e.lastCopy.id!==this.deferredPasteData.copyContextId&&(l().ULS.traceTag(595734789,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onMetadataChanged: reject deferred paste because copy id ${e.lastCopy.id} is not equal to ${this.deferredPasteData.copyContextId}`),this.rejectDeferredPasteData(C.DeferredPasteRejectedBecauseOtherCopyStarted)),e.lastCopy.copyStatus===gr.Completed&&this.onCopyCompletedSuccessfully(e.lastCopy)):(l().ULS.traceTag(595734790,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteFlowManager.onMetadataChanged: no metadata or no metadata.lastCopy"),this.deferredPasteData&&(l().ULS.traceTag(595724049,s.nh.msoulscat_ES_EWAJS,s.kp.Info,"CopyPasteFlowManager.onMetadataChanged: reject deferred paste because metadata update without copy context"),this.rejectDeferredPasteData(C.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext)))}onCopyCompletedSuccessfully(e){e?l().ULS.traceTag(595734791,s.nh.msoulscat_ES_EWAJS,s.kp.Info,`CopyPasteFlowManager.onCopyCompletedSuccessfully: start onCopyCompletedSuccessfully for copy id ${e.id}.`):l().ULS.traceTag(595734792,s.nh.msoulscat_ES_EWAJS,s.kp.Warning,"CopyPasteFlowManager.onCopyCompletedSuccessfully: no copy context."),this.deferredPasteData&&e&&e.copyStatus===gr.Completed&&e.id===this.deferredPasteData.copyContextId&&this.resolveDeferredPasteData()}testHook(e){}constructor(e,t,r){if(this.clipboardPlatformEnvironment=e,this.applicationHost=t,this.inProgressCopyContext=void 0,this.deferredPasteData=void 0,this.isAsyncClipboardEnhancementsFGEnabled=!1,!r)throw new I(p,"logger");d(r),l().ULS.shipAssertTag(596456157,s.nh.msoulscat_ES_EWAJS,!!e,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'clipboardPlatformEnvironment' argument"),l().ULS.shipAssertTag(596456158,s.nh.msoulscat_ES_EWAJS,!!t,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'applicationHost' argument"),this.metadataManager=e.getMetadataManager(),this.metadataManager.addMetadataChangeListener("CopyPasteFlowManagerOnMetadataChangedListener",this.onMetadataChanged.bind(this)),l().ULS.shipAssertTag(596456156,s.nh.msoulscat_ES_EWAJS,!!this.metadataManager,"CopyPasteInfra.copyPasteFlowManager.ctor: metadataManager is not valid"),this.isAsyncClipboardEnhancementsFGEnabled=((e,t=!1)=>n?n.getBooleanFeatureGate(e,t):t)("Microsoft.Office.Excel.AsyncClipboardEnhancements",!1),this.isTelemetryLogsForAsyncClpWriteIssueEnabled=(0,co.isChangeGateEnabled)("ChangeGate.OfficeVSO:10504055_EnableTelemetryLogsForAsyncClpWriteIssue")}}var uo=r(8107);function mo(e){i.setFeatureGateManager(e)}}(),copyPasteInfra=o}();
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/copyPasteInfra.min.js.map/79784164342a678357fbfcfd3fb5cf39/copyPasteInfra.min.js.map